Original code,Plausible Program,Number of Bugs Present,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; <StartBug> if ( planeSize == 0 || planeSize > originalSize ) <EndBug> <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> <StartBug> rle += originalSize ; <EndBug> } <StartBug> } <EndBug>",7,220,-8.991310815097634,-0.04086959461408016
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,244,-2.6801410968466817,-0.010984184823142139
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> if (context == NULL || context->Planes == NULL) { return; } <EndBug> rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else copyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , planeSize ) ; //limit size of copy to planeSize <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,269,-36.86793853896517,-0.13705553360210102
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , planeSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,244,-4.591918619795533,-0.018819338605719396
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartFixed>
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) {
    UINT16 i ; 
    BYTE * rle ; 
    UINT32 planeSize ; 
    UINT32 originalSize ; 
    rle = context -> Planes ; 
    for ( i = 0 ; i < 4 ; i ++ ) { 
        originalSize = context -> OrgByteCount [ i ] ; 
        planeSize = context -> PlaneByteCount [ i ] ; 
        if ( planeSize == 0 ) {
            FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; 
        }
        else if ( planeSize < originalSize ) {
            nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; 
            FillMemory ( context -> priv -> PlaneBuffers [ i ] + planeSize , originalSize - planeSize , 0xFF ) ; 
        } 
        else {
            CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; 
        }
        rle += planeSize ; 
    } 
} <EndFixed>",7,287,-33.160385950134724,-0.11554141446039974
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> else if ( planeSize < originalSize ) <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; <EndBug> <StartBug> else if ( planeSize > originalSize ) <EndBug> <StartBug> FillMemory(context->priv->PlaneBuffers[i] + originalSize, planeSize - originalSize, 0xFF) ; <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,325,-15.005972291663783,-0.04617222243588856
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartFix> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndFix> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; <StartFix> if ( planeSize < originalSize ) <EndFix> { <StartFix> if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndFix> <StartFix> else nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndFix> } <StartFix> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <EndFix> rle += planeSize ; } }",7,230,-23.22271870735017,-0.10096834220587031
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> if ( context -> Planes == NULL ) return; <EndBug> rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ){ <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> } <StartBug> else if (planeSize >= originalSize) <EndBug> <StartBug> CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <EndBug> rle += planeSize ; <StartBug> } <EndBug> }",7,272,-19.03205896157953,-0.0699708050058071
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) { <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> <StartBug> rle += planeSize ; <EndBug> } <StartBug> else if ( planeSize >= originalSize ) { <EndBug> <StartBug> CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <EndBug> <StartBug> rle += planeSize ; <EndBug> } } <StartBug> } <EndBug>",7,286,-13.597989727714067,-0.04754541862837086
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else <StartBug> if (planeSize > originalSize)
			planeSize = originalSize;
         CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , planeSize ) ; <EndBug> <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,272,-23.822092132037845,-0.08758122107366854
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else <StartBug> if ( originalSize > 0 ) <EndBug> <StartBug> CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <EndBug> <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,267,-9.176112790602831,-0.034367463635216595
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> else if ( planeSize < originalSize ) <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; <EndBug> <StartBug> else if ( planeSize >= originalSize ) <EndBug> <StartBug> CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <EndBug> <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,260,-6.203667950319229,-0.02386026134738165
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:"," 
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; <StartBug> if ( planeSize >= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,216,-10.272305699152382,-0.04755697082940918
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; 
<StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> 
<StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; <EndBug> else <StartBug> if ( planeSize == originalSize ) {
	CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; 
} else {
	CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , planeSize ) ; 
	FillMemory ( context -> priv -> PlaneBuffers [ i ] + planeSize , originalSize - planeSize , 0xFF ) ;
} <EndBug> 
<StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,330,-32.65585334267964,-0.09895713134145345
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) { <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; <EndBug> <StartBug> FillMemory ( context -> priv -> PlaneBuffers[i] + planeSize, originalSize - planeSize, 0xFF ) ; <EndBug> <StartBug> } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <EndBug> <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,290,-13.245543707623156,-0.0456742886469764
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; <StartBug> if ( planeSize >= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , planeSize ) ; <EndBug> <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,252,-12.556931715378932,-0.049829094108646554
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,244,-2.58065450206518,-0.010576452877316312
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,244,-2.5769445596973806,-0.010561248195481068
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,244,-2.58065450206518,-0.010576452877316312
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ){ <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <StartBug> } else if (planeSize > originalSize) { <EndBug> <StartBug> FillMemory(context->priv->PlaneBuffers[i] + originalSize, planeSize - originalSize, 0xFF); <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> <StartBug> } else { <EndBug> <StartBug> CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <EndBug> <StartBug> } <EndBug> <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,358,-30.657194098161263,-0.08563462038592531
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else <StartBug> if (planeSize > originalSize) planeSize = originalSize; <EndBug> CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , planeSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,266,-9.607095587295236,-0.036116900704117424
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; <StartBug> if ( planeSize > originalSize ) planeSize = originalSize ; <EndBug> if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> else nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,220,-13.400784019154132,-0.060912654632518784
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; <StartBug> if ( planeSize == 0 || planeSize > originalSize) <EndBug> <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> else <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,220,-8.459932677791429,-0.038454239444506495
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; <StartBug> if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> else if ( planeSize <= originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <StartBug> else { // added
    FillMemory(context->priv->PlaneBuffers[i], originalSize, 0xFF); // added 
  } // added <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,271,-33.80888911533086,-0.12475604839605482
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; <StartBug> if ( planeSize > originalSize ) <EndBug> <StartBug> planeSize = originalSize ; <EndBug> <StartBug> if ( planeSize == 0 ) <EndBug> <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,274,-12.584679150491212,-0.04592948595069785
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) { <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> } <StartBug> else if ( planeSize >= originalSize ) <EndBug> <StartBug> CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <EndBug> <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,270,-7.21836614413488,-0.026734689422721777
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","

static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { 
  UINT16 i ; 
  BYTE * rle ; 
  UINT32 planeSize ; 
  UINT32 originalSize ; 
  rle = context -> Planes ; 
  for ( i = 0 ; i < 4 ; i ++ ) { 
    originalSize = context -> OrgByteCount [ i ] ; 
    planeSize = context -> PlaneByteCount [ i ] ; 
    if ( planeSize == 0 ) {
        FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; 
    }
    else if ( planeSize <= originalSize ) {
        nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; 
    }
    else {
        CopyMemory ( context -> priv -> PlaneBuffers[ i ] , rle , originalSize ) ; 
    }
    rle += planeSize ; 
  } 
}",7,248,-26.214856098677764,-0.10570506491402325
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> if (context == NULL) { return; } <EndBug> rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; <StartBug> if (planeSize > originalSize) { return; } <EndBug> if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> else if ( planeSize < originalSize ) <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",7,250,-16.105978175071233,-0.06442391270028493
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,244,-2.58065450206518,-0.010576452877316312
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> else if ( planeSize < originalSize ) <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; <EndBug> <StartBug> else if ( planeSize >= originalSize ) <EndBug> <StartBug> CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <EndBug> <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,260,-6.34661155725723,-0.024410044450989345
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> else if ( planeSize < originalSize ) <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> <StartBug> else if (planeSize >= originalSize) <EndBug> <StartBug> CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <EndBug>  <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,261,-14.345856268609438,-0.054964966546396314
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> if (context != NULL && context->Planes != NULL) <EndBug> { <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> else <StartBug> if (planeSize <= originalSize) <EndBug> { <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> } else { <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> } <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug> <StartBug> } <EndBug>",7,288,-20.075787517700306,-0.0697075955475705
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( originalSize != 0 ) { if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug>  } else { <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> } <StartBug> } <EndBug>",7,286,-23.05367422377026,-0.08060725253066524
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,244,-2.535407803650671,-0.010391015588732259
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,244,-2.5354679178247306,-0.010391261958298077
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) { <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> } else if (planeSize >= originalSize) { <StartBug> CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <EndBug> } <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,264,-8.854121359656576,-0.03353833848354763
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { 
	UINT16 i ; 
	BYTE * rle ; 
	UINT32 planeSize ; 
	UINT32 originalSize ; 
	rle = context -> Planes ; 
	for ( i = 0 ; i < 4 ; i ++ ) { 
		originalSize = context -> OrgByteCount [ i ] ; 
		planeSize = context -> PlaneByteCount [ i ] ; 
		if ( planeSize == 0 ) 
			FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; 
		else if ( planeSize < originalSize ) 
			nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; 
		else 
			CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; 
		rle += planeSize ; 
	} 
}",7,250,-12.398880429358542,-0.049595521717434164
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; 
rle = context -> Planes ; 
for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; 
else if ( planeSize < originalSize) { 
if (originalSize > 0 ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; 
} else {
if(planeSize > 0 ) CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ;
}
rle += planeSize ; 
} 
}",7,223,-32.149423230972225,-0.14416781717924765
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) { <EndBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] + planeSize, originalSize - planeSize, 0xFF ); <EndBug> } <StartBug> else if (planeSize > originalSize) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,325,-16.194714627869566,-0.04982989116267559
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize >= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,244,-6.255003372839283,-0.025635259724751162
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:"," 
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , planeSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,245,-6.088099135691872,-0.02484938422731376
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) { <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; <EndBug> <StartBug> FillMemory(context->priv->PlaneBuffers[i] + planeSize, originalSize - planeSize, 0xFF); <EndBug> } <StartBug> else if ( planeSize >= originalSize ) { <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> } <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,314,-12.936323116333119,-0.04119848126220738
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <EndBug> rle = context -> Planes ; 
for ( i = 0 ; i < 4 ; i ++ ) {
  originalSize = context -> OrgByteCount [ i ] ;
  planeSize = context -> PlaneByteCount [ i ] ; 
  if ( planeSize == 0 ) {
    FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ;
  } else {
    if ( planeSize < originalSize ) {
      nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; 
    } else {
      CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ;
    }
    rle += planeSize ;
  }
}
<EndBug>",7,237,-27.789393438545233,-0.11725482463521195
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,244,-2.535407803650671,-0.010391015588732259
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,244,-2.5354679178247306,-0.010391261958298077
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; rle += planeSize ; } else { if ( planeSize > originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; rle += planeSize ; } else { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } } } }",7,244,-10.476818231971162,-0.04293777963922608
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { 
UINT16 i ; 
BYTE * rle ; 
UINT32 planeSize ; 
UINT32 originalSize ; 

rle = context -> Planes ; 
for ( i = 0 ; i < 4 ; i ++ ) { 
    originalSize = context -> OrgByteCount [ i ] ; 
    planeSize = context -> PlaneByteCount [ i ] ; 
    if ( planeSize == 0 ) {
        FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; 
    } else if ( planeSize < originalSize ) {
        if (originalSize - planeSize > 0) {
            FillMemory(context->priv->PlaneBuffers[i] + planeSize, originalSize - planeSize, 0xFF);
        }
        nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; 
    } else {
        CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; 
    }
    rle += planeSize ; 
} 
}",7,283,-19.40342576569879,-0.06856334192826427
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize <= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,244,-2.535407803650671,-0.010391015588732259
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> else if ( planeSize < originalSize ) <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; <EndBug> <StartBug> else if ( planeSize >= originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,266,-7.223773140212178,-0.02715704188049691
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) <StartBug> FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) <EndBug> <StartBug> nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; <EndBug> else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>
Fixed code:","
<StartBug> static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) <EndBug> { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; <StartBug> rle = context -> Planes ; <EndBug> for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; <StartBug> if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; <EndBug> <StartBug> else if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; } <EndBug> <StartBug> rle += planeSize ; <EndBug> } <StartBug> } <EndBug>",7,240,-13.607316474460966,-0.05669715197692069
