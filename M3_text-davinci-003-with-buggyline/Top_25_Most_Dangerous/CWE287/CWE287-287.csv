Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; //Check for Authentication if (ap_auth_type(r) == NULL || strcmp(ap_auth_type(r), ""openidc"") != 0) { return; } if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",222,-22.9411240645132,-0.1033383966869964
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { //Check the client/user identity is authenticated using the ap_get_basic_auth_pw function. If not authenticated, return 403 Forbidden. const char *user = ap_get_user(r); if (!user || (strcmp(user,"""") == 0)) { ap_log_rerror(APLOG_MARK, APLOG_ERR, 0, r, ""Access denied to valid user""); return HTTP_FORBIDDEN; } oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",280,-82.89426083656744,-0.29605093155916945
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { if ( strcmp(r->user, """" ) == 0 ) { ap_log_rerror(APLOG_MARK, APLOG_ERR, 0, r, ""Improper Authentication: Missing user credentials""); return HTTP_UNAUTHORIZED; } oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",240,-31.053946585016806,-0.1293914441042367
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { 
	// Add Authentication check 
	const char *auth_header = apr_table_get(r->headers_in, ""Authorization"");
	if (auth_header && strstr(auth_header, ""Bearer"")) { 
		oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; 
	} 
} } }",244,-39.650264883627294,-0.16250108558863646
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) &&  cfg -> authenticated ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",188,-14.316062006761344,-0.0761492659934114
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { //Check for authentication before scrubbing headers if (r->user != NULL && strcmp(r->user, """") != 0) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",212,-14.979613592232502,-0.07065855468034199
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:","
<StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; // Check whether the user is authenticated if (ap_auth_type(r) == NULL) return; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",205,-20.15078740231681,-0.09829652391374052
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { if (oidc_authenticate_client(r) == OK) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",199,-13.528098141016509,-0.06798039266842466
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:","
<StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { if (cfg->user_authn_header != NULL && strlen(cfg->user_authn_header) > 0) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",213,-20.0574681875406,-0.09416651731239718
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { //Authenticate request before scrubbing headers if (oidc_authenticate_request(r)) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } else { //Do not scrub headers and return error return HTTP_UNAUTHORIZED; } } }",225,-28.867834884621544,-0.12830148837609576
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> {  oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) && (strcmp(cfg->claim_prefix,cfg->authentication_header)!=0)) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",203,-22.399702856025897,-0.11034336382278767
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; /* check for valid authentication */ if (oidc_check_authn(r) == OK) { if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",205,-22.001619232732185,-0.10732497186698627
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) && (strcmp(cfg->authentication_type, ""Basic"") != 0) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",200,-14.56862936369924,-0.0728431468184962
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r, const char* key )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , key ) ; } } }",187,-12.8482853124852,-0.06870740808815615
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { //Verify authentication before scrubbing the request headers if (ap_get_basic_auth_pw(r, &user, &pw) != 0) { return; } oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",221,-24.685442084656692,-0.11169883296224747
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { //Check the username and password before scrubbing the headers.  const char * username = ap_auth_name(r); const char* password = ap_auth_type(r); if(strcmp(username, ""username"") == 0 && strcmp(password, ""password"") == 0) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",247,-36.34876087886242,-0.14716097521806648
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { // Added authentication check before scrubbing headers if (cfg->check_authentication == true) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } else { // Return error status if authentication check fails ap_log_rerror(APLOG_MARK, APLOG_ERR, 0, r, ""Improper authentication""); return HTTP_UNAUTHORIZED; } } } }",252,-38.60753640120393,-0.15320450952858702
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ;  if ( oidc_check_authentication(r)!=OK ){ return; } if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",203,-24.419104403154922,-0.12029115469534445
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r , char * username , char * password )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( oidc_authenticate_user(r,username,password) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",172,-25.20917167137649,-0.1465649515777703
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { //Authentication check. if(r->ap_auth_type != NULL && strcmp(r->ap_auth_type, ""OpenIDC"") == 0) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",220,-24.0968824493671,-0.10953128386075955
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { if (r->user != NULL){ oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } }else{ ap_log_rerror(APLOG_MARK, APLOG_ERR, 0, r, ""Authentication failed""); return; } } }",224,-22.873259280863493,-0.10211276464671203
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { // check for authentication oidc_cfg_dir_authn_header returns 1 if authentication is successful if(oidc_cfg_dir_authn_header(r) == 1){ oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",224,-26.082052391244073,-0.11643773388948246
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; //add the below line 
if (ap_auth_type(r) != NULL && strcmp(ap_auth_type(r), ""openidc"") == 0) { 
if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",225,-31.094010772388994,-0.13819560343284
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { // check for authentication header if ( oidc_cfg_dir_authn_header(r) != NULL ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; } if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",209,-15.994004169604112,-0.0765263357397326
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , oidc_cfg_dir_authn_header ( r ) ) ; } } }",196,-6.710054180438941,-0.034234970308361944
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:","
<StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; 
//Verify the authentication header is valid
if ( oidc_util_request_has_valid_authentication_header ( r ) ) { 
if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",220,-29.843063928599225,-0.13565029058454192
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { if ( oidc_is_authenticated(r) ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",198,-9.969905914411752,-0.05035306017379673
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header(r)) ; //Check if a valid authentication has been made if ( !ap_auth_type(r) || strcmp(ap_auth_type(r), ""openidc"") != 0 ) { return; } if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",225,-37.42950938541857,-0.16635337504630476
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:","<StartBug>
static void oidc_scrub_headers ( request_rec * r ) { 
    oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; 
    if ( cfg -> scrub_request_headers != 0 ) { 
        const char * username; 
        if (ap_get_basic_auth_pw(r, &username) == APR_SUCCESS) { 
            oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; 
            if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { 
                oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; 
            } 
        } 
    } 
}
<EndBug>",248,-25.311388686421218,-0.10206205115492427
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0) { //Check that authentication was successful if (cfg->authenticated == 1) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",199,-25.442044422375403,-0.1278494694591729
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r , const char *user, const char *password)<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { //Check that the user has been authenticated if (user != NULL && password != NULL) {  oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } else { // Return a 401 unauthorized error code r->status = 401; } } }",229,-52.11061967679791,-0.22755729116505638
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { /* Add authentication check here */ if (ap_auth_type(r) == NULL) { return; } oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",205,-19.073122042265634,-0.09303961971836895
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { if (ap_get_basic_auth_pw(r) == NULL) { return; } else { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",207,-11.414254546596538,-0.05514132631206057
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { // Add authentication header check if (r->headers_in[""authorization""] == NULL) { return; } oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",205,-26.195182030795696,-0.127781375759979
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { char * username = oidc_get_current_username(r); if (username == NULL) { return; } oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",208,-13.434957384278004,-0.06459114127056732
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { //Check if authentication is present if(strstr(cfg->claim_prefix, OIDC_DEFAULT_HEADER_PREFIX) != NULL && is_authenticated) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",223,-33.50393042521792,-0.15024184047182926
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug> static void oidc_scrub_headers ( request_rec * r ) { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { // only do scrubbing if user is authenticated if ( ap_get_basic_auth_pw ( r ) != NULL ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } } <EndBug>",211,-23.98630437709013,-0.11367916766393425
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r ) { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; const char* auth_header = oidc_cfg_dir_authn_header(r); if ( cfg -> scrub_request_headers != 0 && auth_header != NULL && strlen(auth_header) > 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , auth_header ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } <EndBug>",208,-16.7405515042844,-0.080483420693675
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) && ( cfg -> authentication_type == OIDC_AUTH_TYPE_OIDC)) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",203,-17.24968968271024,-0.08497384080152828
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) && ( cfg -> authentication_required == TRUE ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",193,-12.65346779323314,-0.06556200929136342
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { if ( oidc_authentication_required(r, cfg) ){ oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",201,-12.846247978502797,-0.06391168148508854
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { // Check the authentication status and only proceed if authentic oidc_check_auth_status(r); oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",204,-31.352463406990804,-0.15368854611270003
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r , const char * username_hint , const char * password ) {
    oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ;
    if ( cfg -> scrub_request_headers != 0 ) {
        oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ;
        if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) {
            oidc_scrub_request_headers ( r , cfg -> claim_prefix , username_hint , password ) ;
        }
    }
}<EndBug>",215,-27.339873460970587,-0.12716220214404925
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:","
<StartBug>
static void oidc_scrub_headers ( request_rec * r ) {
  oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; 
  const char *auth_header = oidc_cfg_dir_authn_header ( r ) ;
  if ( cfg -> scrub_request_headers != 0 && auth_header ) {
    oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , auth_header ) ; 
    if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) {
      oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; 
    }
  }
}
<EndBug>",220,-22.479187734656385,-0.10217812606661993
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { if(r->user != NULL) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",192,-9.95630870508744,-0.051855774505663754
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:","
<StartBug>static void oidc_scrub_headers (request_rec *r)<EndBug> { 
    oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; 
    if ( cfg -> scrub_request_headers != 0 ) { 
        oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; 
        if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { 
            oidc_scrub_request_headers ( r , cfg -> claim_prefix , oidc_cfg_dir_authn_header ( r ) ) ; 
        } 
    }
}",219,-26.887048810414576,-0.12277191237632226
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; // Check if the user is authenticated first if (r->user != NULL) { if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",200,-13.460908210690599,-0.067304541053453
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; // ensure that authentication headers are only being scrubbed if authentication is present if (cfg->authentication_enabled == true && cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }",205,-38.068047225216844,-0.18569779134252118
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) {//Check if Authentication has been provided if (ap_get_basic_auth_pw(r, NULL) != NULL) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",211,-28.00669823062899,-0.13273316696980564
"The Original Code is vulnerable to CWE-287: Improper Authentication. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } }
Fixed code:"," <StartBug>static void oidc_scrub_headers ( request_rec * r )<EndBug> { oidc_cfg * cfg = ap_get_module_config ( r -> server -> module_config , & auth_openidc_module ) ; if ( cfg -> scrub_request_headers != 0 ) { if(oidc_authentication_successful(r)) { oidc_scrub_request_headers ( r , OIDC_DEFAULT_HEADER_PREFIX , oidc_cfg_dir_authn_header ( r ) ) ; if ( ( strstr ( cfg -> claim_prefix , OIDC_DEFAULT_HEADER_PREFIX ) != cfg -> claim_prefix ) ) { oidc_scrub_request_headers ( r , cfg -> claim_prefix , NULL ) ; } } } }",196,-12.647297967719187,-0.06452703044754687
