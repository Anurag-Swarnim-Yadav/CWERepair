Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",330,-5.418955668490329,-0.01642107778330403
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",330,-5.300502803984132,-0.016062129709042826
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> if(in == ';' || in == '\'' || in == '""' || in == '&' || in == '=' || in == '<' || in == '>' || in == '`' ) { free(ns); return NULL; } res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",395,-28.494739141170015,-0.07213858010422788
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug>int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> // Check if the hex value is a valid character for SQL commands.
if (in < 0x20 || in > 0x7F || in == 0x22 || in == 0x27 || in == 0x5C) {
    free(ns);
    return NULL;
}

res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",403,-47.710362173365475,-0.11838799546740812
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_network_to_host ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",340,-9.291934091550626,-0.027329217916325373
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; <StartBug>char * origns = ns ; <EndBug>if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug>if ( res ) { <StartBug>while(ns > origns) { free(ns); ns--; } <EndBug>free ( origns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return origns ; <EndBug>}",383,-39.314434445055646,-0.10264865390353954
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",330,-5.418955668490329,-0.01642107778330403
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_from_network ( handle, &in, 1 );
 if (res) {
     free(ns);
     <StartBug>return NULL;<EndBug>
 }<EndBug>
 string += 2 ; alloc -= 2 ;
 }
 ns[strindex++] = in ;
 string++ ;
 }
 ns[strindex]",320,-36.44791448757203,-0.11389973277366258
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen )<EndBug> { <StartBug>int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_from_network ( handle , &in, 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } if ( ! isalnum ( in ) && ! isblank ( in ) && ( '_' != in ) ) { free ( ns ) ; <StartBug>return NULL; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",381,-35.30225426072399,-0.09265683532998423
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug>int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ; <EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_from_network ( handle , & in , 1 ); if (res) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",329,-18.87513856812672,-0.05737124184840948
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_from_network(handle, &in, 1); if (res) { free(ns); return NULL; }<EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",328,-7.504840435402329,-0.022880611083543684
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_from_network(handle, &in, 1); // Add escaping for special chars in query string 
if (in == ';' || in == '$' || in == '&' || in == '%' || in == '#' || in == '(' || in == ')' || in == '|' || in == '<' || in == '>' || in == '*' || in == '+' || in == '\""' || in == '\'')
	in = ' ';<EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",439,-64.9966134563289,-0.1480560670986991
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; 

<StartBug>res = Curl_convert_from_network ( handle , & in , 1 ) ;
if(in >= 0x20 && in <= 0x7f) {
    res = Curl_convert_from_network ( handle , & in , 1 ) ;
} else {
    free ( ns ) ; 
    return NULL ; 
}<EndBug>

string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",380,-32.17061976587432,-0.08465952569966927
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = curl_easy_unescape(handle, string, length, &hex);<EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",336,-14.580761046217924,-0.04339512216136287
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } else if (in == '\'' || in == '""' || in == ';' || in == '-' || in == '#' ) { free(ns); return NULL; }  ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",379,-18.828947888140075,-0.049680601287968536
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug>int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; <StartBug>hex = strtoul ( hexstr , & ptr , 16 ) ; <EndBug> in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_from_network ( handle , & in , 1 ) ; sanitizedInput = sanitizeInput(in); res = Curl_convert_from_network ( handle , & sanitizedInput , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}

// Note: You will need to define the sanitizeInput() function.",397,-42.734696443131824,-0.10764407164516833
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ; <EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",330,-9.267901906973256,-0.028084551233252292
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_from_network(handle, &in, 1); 
if (res || !Curl_isascii(in)) { 
free ( ns ) ; 
return NULL ; 
}<EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",348,-19.468216457312273,-0.055943150739403084
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if(in == ';' || in == '-' || in == '+' || in == '(' || in == ')' || in == '*' || in == '/' || in == '""' || in == '\'' || in == '<' || in == '>' || in == '?' || in == ' ' || in == '=') { free(ns); return NULL; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",403,-40.31269624853961,-0.10003150433880796
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug>int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } else if ('\'' == in) { // Check for single quotes to prevent SQL Injection <StartBug>in = '\0';<EndBug> } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",372,-30.723505229035634,-0.08259006781998826
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; }<EndBug> string += 2 ; alloc -= 2 ; } <StartBug>if ( in == '\'' || in == ';' || in == '&' || in == '""' ) { free(ns); return NULL; }<EndBug> ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",372,-24.074020471347623,-0.06471510879394522
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",330,-5.383252451479832,-0.01631288621660555
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; <StartBug>char hexstr [ 3 ] ; <EndBug> if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , NULL , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } <StartBug>//escape single quote
if (in == '\'') {
	in = '\'';
	in = in << 4;
	in += '\'';
}
//escape double quote
if (in == '\""') {
	in = '\""';
	in = in << 4;
	in += '\""';
}<EndBug> ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",425,-42.17284443063664,-0.09923022218973326
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> hexstr[3] = {0}; //add this line to fix the vulnerability 
res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",357,-21.15635583542943,-0.059261500939578236
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",330,-5.423028146411131,-0.016433418625488274
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ] = mysql_real_escape_string(in); strindex ++ ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",341,-11.510384000610024,-0.03375479179064523
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:","
<StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>hexstr[0] = '\0'; hexstr[1] = '\0'; hexstr[2] = '\0'; res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",369,-12.791947794872856,-0.03466652518935733
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; escape_string(hexstr, sizeof(hexstr)); <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",350,-15.907529409853229,-0.04545008402815208
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_from_network(handle, &in, 1); if (res) { free(ns); return NULL; }<EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",328,-7.49836199346053,-0.02286085973616015
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } <StartBug>if (!Curl_is_non_ascii(in)) {<EndBug> ns [ strindex ++ ] = in ; <StartBug>}<EndBug> string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",363,-17.812476561852225,-0.049070183365984094
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_escaped_hex_to_unescaped_hex(hexstr, &in); <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",345,-24.93557916794102,-0.07227704106649571
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",330,-5.383252451479832,-0.01631288621660555
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , (const char*)& in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",342,-11.94392439790563,-0.03492375554943167
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_from_network(handle, &in, 1);
char *escapedString = curl_easy_escape(handle, &in, 0);
if (res) {
  free(ns);
  return NULL;
}
string += 2;
alloc -= 2;
ns[strindex++] = *escapedString;
<EndBug> } else { ns[strindex++] = in; } string++; } ns[strindex] = 0; if (olen) * olen = strindex; <StartBug>return ns ; <EndBug>}",370,-35.05873276787258,-0.09475333180506101
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> if ( hex < 0xFF ) { res = Curl_convert_from_network ( handle , & in , 1 ) ; } else { in = '\0' ; } <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",358,-19.247170871875813,-0.05376304712814473
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> int numChars = 0; unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> numChars = snprintf(ns + strindex, alloc, ""%c"", in); <EndBug> if ( numChars <= 0 ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } else { numChars = snprintf(ns + strindex, alloc, ""%c"", in); if ( numChars <= 0 ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } } strindex += numChars; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",394,-26.72202373961907,-0.06782239527822098
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; hexstr[2] = '\0'; //additional line <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } <StartBug> else if ('\'' == in || ';' == in || '--' == in || '""' == in || '#' == in || '=' == in || '/**/' == in) //additional line { in = ' '; } <EndBug> ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",406,-53.0957480248208,-0.13077770449463252
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>res = Curl_convert_from_network ( handle , & in , 1 ) ;

if (res == CURLE_OK) {
  res = Curl_convert_to_network(handle, &in, 1);
  if (res == CURLE_OK) {
    string += 2;
    alloc -= 2;
  }
  else {
    free(ns);
    return NULL;
  }
}
 else {
   free(ns);
   return NULL;
  }<EndBug> ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",406,-32.6306401805195,-0.08037103492738792
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>hexstr[3] = '\0'; res = Curl_convert_from_network(handle, &in,1);<EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",347,-19.34809506526212,-0.055758199035337526
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> hexstr[0] = '\\';  //Prevent SQL injection
	hexstr[1] = string[1];
	hexstr[2] = string[2]; 
	hex = strtoul(hexstr, &ptr, 16);
	in = curlx_ultouc(hex); <EndBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",407,-32.04146584827954,-0.07872596031518315
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 5 ] ; char * ptr ; hexstr [ 0 ] = '0' ; hexstr [ 1 ] = 'x' ; hexstr [ 2 ] = string [ 1 ] ; hexstr [ 3 ] = string [ 2 ] ; hexstr [ 4 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",358,-5.989635257723827,-0.016730824742245326
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } <StartBug>if ( ! curl_is_ascii ( in ) ) { free ( ns ) ; return NULL ; }<EndBug> ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",362,-18.162440616824895,-0.05017248789178148
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:","<StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; // Added an additional check to ensure that the conversion to a long was successful before proceeding if (res != CURLE_OK || hex >= 256) { free(ns); return NULL; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",356,-53.81514446081103,-0.15116613612587368
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 4 ] ; char * ptr ; hexstr [ 0 ] = '0' ; hexstr [ 1 ] = 'x' ; hexstr [ 2 ] = string [ 1 ] ; hexstr [ 3 ] = string [ 2 ] ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; <StartBug>return ns ; <EndBug>}",349,-11.12996891714202,-0.031891028415879714
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> in = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( ! in ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",339,-10.482977753165228,-0.030923238209926925
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * input , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( input ) ) + 1 ; <EndBug> char * output = malloc ( alloc ) ; unsigned long hex ; CURLcode res ; int bytes = 0 ; if ( ! output ) <StartBug>return NULL ; <EndBug>while ( * input && ( -- alloc > 0 ) ) { if ( ( '%' == * input ) && ISXDIGIT ( input [ 1 ] ) && ISXDIGIT ( input [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = input [ 1 ] ; hexstr [ 1 ] = input [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; output [ bytes ++ ] = hex ; input += 2 ; alloc -= 2 ; } else { output [ bytes ++ ] = * input ; } input ++ ; } output [ bytes ] = 0 ; if ( olen )  * olen = bytes ; <StartBug>res = Curl_convert_from_network ( handle , output , bytes ) ; if ( res ){ free ( output ) ; return NULL ; } else { return output ; } <EndBug>}",309,-42.3822663787837,-0.1371594381190411
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; int i ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug>for ( i = 0 ; i < sizeof ( in ) ; i ++ ) { if ( ! isalnum ( in [ i ] ) && strchr ( ""~`!@#$%^&*()-_+={[}]|\\:;\""'<,>.?/ "" , in [ i ] ) == NULL ) { free ( ns ) ; return NULL ; } } <EndBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",425,-36.82228815105351,-0.08664067800247885
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",330,-5.4196522191790795,-0.016423188542966906
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," 
<StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; <StartBug>hex = curlx_ultouc ( hex ) ;<EndBug> res = Curl_convert_from_network ( handle , & hex , 1 ) ; if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",340,-14.868856476265442,-0.043731930812545415
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> if ( res ) { free ( ns ) ; <StartBug>return NULL ; <EndBug> } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}
Fixed code:"," <StartBug>char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) <EndBug>{ <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug>int strindex = 0 ;<EndBug> unsigned long hex ; CURLcode res ; if ( ! ns ) <StartBug>return NULL ; <EndBug>while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen )  * olen = strindex ; <StartBug>return ns ; <EndBug>}",330,-5.405463430413831,-0.016380192213375246
