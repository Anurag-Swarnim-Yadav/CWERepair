Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ; if ( str_len < 1 ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; }<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; }<EndBug> <StartBug>if ( str_len - ( p - str - 1 ) < 3 ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } * portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>if ( str_len - ( colon - str ) < 2 ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } * portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",496,-26.032154240281752,-0.05248418193605192
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 1 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",333,-6.527942487667441,-0.01960343089389622
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:","  static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } * portno = atoi ( p + 2 ) ; <StartBug>if (strlen(p + 2) == 0) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; }<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { * portno = atoi ( colon + 1 ) ; <StartBug>if (strlen(colon + 1) == 0) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; }<EndBug> host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; }",429,-18.914238836673977,-0.04408913481742186
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( p == NULL ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; }<EndBug> <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",322,-9.083474677638248,-0.028209548688317543
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>if (!*(p+2) || *(p+2) == 0) { if (get_err) { *err = strpprintf(0, ""Failed to parse IPv6 address \\""%s\\"""", str); } return NULL; } * portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>if (!*(colon+1) || *(colon+1) == 0) { if (get_err) { *err = strpprintf(0, ""Failed to parse address \\""%s\\"""", str); } return NULL; } * portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",451,-23.083665850284426,-0.05118329456825815
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:","
static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } * portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>colon = memchr ( str , ':', str_len-1); if (colon == NULL) { if (get_err) { *err = strpprintf(0, ""Failed to parse address \\""%s\\"""", str); } return NULL; } *portno = atoi(colon + 1);<EndBug> host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",391,-32.62417718880753,-0.08343779332175838
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 1 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; }<EndBug> <StartBug>if ( p + 1 && * ( p + 1 ) == ':' ) { * portno = atoi ( p + 2 ) ; host = estrndup ( str + 1 , p - str - 1 ) ; } else { * portno = 0 ; host = estrndup ( str + 1 , str_len - 2 ) ; }<EndBug> return host ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ;<EndBug> } else { <StartBug>* portno = 0 ; host = estrndup ( str , str_len ) ;<EndBug> } return host ; <EndBug>}",375,-29.868110589366538,-0.07964829490497743
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>if (str_len > (p - str) + 2) { * portno = atoi ( p + 2 ) ; }<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>if (str_len > (colon - str)) { * portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; }<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",365,-17.085454883123486,-0.04680946543321503
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 1 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",333,-6.8838586862229025,-0.02067224830697568
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 char * p ; if ( * ( str ) == '[' && str_len > 1 ) { p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } * portno = atoi ( p + 2 ) ; <StartBug>host = estrndup ( str + 1 , p - str - 1 ) ;<EndBug> return host ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { * portno = atoi ( colon + 1 ) ; <StartBug>host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; }",319,-11.933137262897201,-0.03740795380218558
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>if (p - str > str_len) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } * portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>if (colon - str > str_len) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } * portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",436,-12.545347833615942,-0.028773733563339315
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = strnchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = strnchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",333,-8.542572904979197,-0.025653372087024617
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 char * p ; if ( * ( str ) == '[' && str_len > 1 ) { p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>if(p[2] != '\0' && isdigit(p[2])){<EndBug> * portno = atoi ( p + 2 ) ; <StartBug>}<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>if(colon[1] != '\0' && isdigit(colon[1])){<EndBug> * portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; <StartBug>}<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; }",377,-14.845653801105609,-0.03937839204537297
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 char * p ; if ( * ( str ) == '[' && str_len > 1 ) { p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>if(atoi(p+2)>0) * portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>if(atoi(colon+1)>0)* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; }",339,-18.015438183688794,-0.05314288549760706
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ; int parsed_port = 0;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>parsed_port = atoi ( p + 2 ) ;<EndBug> * portno = parsed_port; return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>int parsed_port = atoi ( colon + 1 ) ; * portno = parsed_port;<EndBug> host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",361,-17.43504049924358,-0.04829651107823706
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>if (!zend_parse_int(p + 2, portno, 0)) { if (get_err) { *err = strpprintf(0, ""Failed to parse port number \\""%s\\"""", p + 2); } return NULL; }<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>if (!zend_parse_int(colon + 1, portno, 0)) { if (get_err) { *err = strpprintf(0, ""Failed to parse port number \\""%s\\"""", colon + 1); } return NULL; }<EndBug> host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",430,-20.585762704518814,-0.04787386675469492
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 char * p ; if ( * ( str ) == '[' && str_len > 1 ) { p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>int port_num = 0; if(p+2!=NULL && strlen(p+2)<=5){ port_num = atoi ( p + 2 ) ; } else{ if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 port \\""%s\\"""" , str ) ; } return NULL ; } * portno = port_num;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>int port_num = 0; if(colon+1!=NULL && strlen(colon+1)<=5){ port_num = atoi ( colon + 1 ) ; } else{ if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse port \\""%s\\"""" , str ) ; } return NULL ; } * portno = port_num;<EndBug> host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; }",471,-43.2494324565199,-0.09182469735991486
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> if(portno >= 0 && portno <= 65535 ) { return estrndup ( str + 1 , p - str - 1 ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ;<EndBug> if(portno >= 0 && portno <= 65535 ) { return host; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ;<EndBug> if(portno >= 0 && portno <= 65535 ) { return host; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } <EndBug>}",578,-32.72767868122649,-0.05662228145540916
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>if ( p + 2 > str + str_len ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; return NULL ; } * portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>if ( colon + 1 > str + str_len ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ; return NULL ; } * portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",423,-14.51293186625129,-0.034309531598702814
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>if (p-str > 1) {* portno = atoi ( p + 2 ) ;} else {* portno = 0;}<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>if (colon-str > 1) {* portno = atoi ( colon + 1 ) ;} else {* portno = 0;} host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",368,-18.961684135594435,-0.051526315585854444
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p ){ if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } if ( * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; }<EndBug> <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; if ( * portno == 0 ){ if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; }<EndBug> host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",425,-18.982349978389006,-0.04466435289032707
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 char * p ; if ( * ( str ) == '[' && str_len > 1 ) { p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } * portno = atoi ( p + 2 ) ; return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { * portno = atoi ( colon + 1 ) ; <StartBug>host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} <StartBug>return NULL ;<EndBug> } <StartBug>return host ;<EndBug> }",323,-16.578254083480637,-0.05132586403554377
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ; p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( p && * ( p + 1 ) == ':' ) { <EndBug> * portno = atoi ( p + 2 ) ; return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { * portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; }",249,-11.452963781366911,-0.04599583847938519
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char *p, *end;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>end = str + str_len;<EndBug> <StartBug>* portno = (int) strtol ( p + 2 , &end, 10 ) ;<EndBug> if(end == p + 2) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>return estrndup ( str + 1 , p - str - 1 ) ;<EndBug> } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = (int) strtol ( colon + 1 , &end, 10 ) ;<EndBug> <StartBug>if(end == colon + 1)<EndBug> { <StartBug>if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } <StartBug>host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",496,-39.84649071426353,-0.08033566676262809
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ; int port_len = 0;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>port_len = (str_len - (p - str) - 2);<EndBug> if ( port_len > 0 ) { <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> } return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>port_len = (str_len - (colon - str) - 1);<EndBug> if ( port_len > 0 ) { <StartBug>* portno = atoi ( colon + 1 ) ;<EndBug> } host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",413,-24.513015414275785,-0.059353548218585434
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } * portno = atoi ( p + 2 ) ; <StartBug>if (!portno) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; <EndBug> } return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { * portno = atoi ( colon + 1 ) ; <StartBug>if (!portno) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ; } return NULL ; <EndBug> } host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; }",413,-18.58171193949418,-0.0449920385944169
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," 
static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ; int port_p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>port_p = atoi ( p + 2 ) ;* portno = port_p ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>int port_p = atoi ( colon + 1 ) ; * portno = port_p ; host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",359,-24.20906151937829,-0.06743471175314288
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:","  static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ; if ( str_len > 1 ){<EndBug> if ( * ( str ) == '[' ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( p ) { if ( * ( p + 1 ) == ':' ) { * portno = atoi ( p + 2 ) ; return estrndup ( str + 1 , p - str - 1 ) ; } } } } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",292,-24.818990813291105,-0.08499654388113392
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:","
static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ; int port_len = 0 ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>port_len = str_len - ( p - str ) - 1 ; if ( port_len > 0 ) { * portno = atoi ( p + 2 ) ;}<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>int port_len = str_len - ( colon - str ) - 1 ; if ( port_len > 0 ) { * portno = atoi ( colon + 1 ) ;} host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",396,-20.085881436238363,-0.050721922818783745
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> <StartBug>if (*portno == 0) { if (get_err) { *err = strpprintf(0, ""Failed to parse IPv6 address \\""%s\\"""", str); } return NULL; }<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; if (*portno == 0) { if (get_err) { *err = strpprintf(0, ""Failed to parse IPv6 address \\""%s\\"""", str); } return NULL; } host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",433,-20.53986845453805,-0.047436185807247226
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 char * p ; if ( * ( str ) == '[' && str_len > 1 ) { p = memchr ( str + 1 , ']' , str_len - 2 ) ; <StartBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; }<EndBug> * portno = atoi ( p + 2 ) ; return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } <StartBug>if ( colon ) { * portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; }<EndBug> return host ; }",315,-20.21211605719899,-0.06416544780063171
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>if(p - str > 0){<EndBug> * portno = atoi ( p + 2 ) ; <StartBug>}<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>if(colon - str > 0){<EndBug> * portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; <StartBug>}<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",370,-14.740520312127838,-0.039839244086831996
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' || ( p - str ) == 0 ) {<EndBug> if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>if (( colon - str ) == 0 ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; }<EndBug> * portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",391,-21.326074471248518,-0.05454238995204225
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 char * p ; if ( * ( str ) == '[' && str_len > 1 ) { p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } * portno = atoi ( p + 2 ) ; <StartBug>if(*(p + 2) == '\0'){ *portno = -1; }<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { * portno = atoi ( colon + 1 ) ; <StartBug>if(*(colon + 1) == '\0'){ *portno = -1; }<EndBug> host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; }",358,-19.773243358692685,-0.05523252334830359
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 char * p ; if ( * ( str ) == '[' && str_len > 1 ) { p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } * portno = atoi ( p + 1 ) ; <StartBug>if (*portno < 0 || *portno > 65535) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; }<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { * portno = atoi ( colon + 1 ) ; <StartBug>if (*portno < 0 || *portno > 65535) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; }<EndBug> host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; }",425,-17.639376288945197,-0.04150441479751811
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ; if ( * ( str ) == '[' && str_len > 1 ) { p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } * portno = atoi ( p + 2 ) ; host = estrndup ( str + 1 , p - str - 1 ) ; } <EndBug># endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { * portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; }",308,-16.261257022655396,-0.05279628903459544
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>if (*(p + 2) != '\0') { * portno = atoi ( p + 2 ) ; }<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>if (*(colon + 1) != '\0') { * portno = atoi ( colon + 1 ) ; }<EndBug> host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",364,-9.151148402769556,-0.02514051759002625
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ; if (str_len == 0) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ; if (p == NULL) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; }<EndBug> <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",371,-13.902022527305807,-0.037471758833708374
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' || * ( p + 2 ) == '\0' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; if ( * ( colon + 1 ) == '\0' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; }<EndBug> host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",400,-12.050391230393595,-0.030125978075983988
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," 
static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ; if(*portno <= 0 || *portno > 65535) { if ( get_err ) { * err = strpprintf ( 0 , ""Port number must be between 1 and 65535"" ) ; } return NULL; }<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; if(*portno <= 0 || *portno > 65535) { if ( get_err ) { * err = strpprintf ( 0 , ""Port number must be between 1 and 65535"" ) ; } return NULL; } host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",433,-24.384459997569675,-0.05631515010986068
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { <StartBug>if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } <EndBug> return NULL ; } * portno = atoi ( p + 2 ) ; return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { * portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; <StartBug>} else { if ( get_err && str_len > 0 ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ; } return NULL ;<EndBug> } return host ; }",329,-28.268792596912817,-0.0859233817535344
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ; int port_test ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>port_test = atoi ( p + 2 ) ; if ( port_test <= 0 || port_test > 65535 ) { if ( get_err ) { * err = strpprintf ( 0 , ""Invalid port number \\""%s\\"""" , port_test ) ; } return NULL ; } else { * portno = port_test ; }<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>int port_test = atoi ( colon + 1 ) ; if ( port_test <= 0 || port_test > 65535 ) { if ( get_err ) { * err = strpprintf ( 0 , ""Invalid port number \\""%s\\"""" , port_test ) ; } return NULL ; } else { * portno = port_test ; }<EndBug> host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",471,-25.809322244379334,-0.054796862514605804
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:","
static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 1 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",334,-8.25959549713513,-0.024729327835733922
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p , * endp ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>endp = (char *)str + str_len - 1; p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' || p >= endp ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; if ( colon < endp) {<EndBug> host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } } return host ; <EndBug>}",367,-36.32142938435522,-0.0989684724369352
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ; if ( * ( str ) == '[' && str_len > 1 ) { p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } if(str_len > (p - str - 1)){ * portno = atoi ( p + 2 ) ; return estrndup ( str + 1 , p - str - 1 ) ; }<EndBug> } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug> if(str_len >= (colon - str)){ * portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; }<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",348,-27.171149218574396,-0.07807801499590343
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ; if ( str_len ) {<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( p ) {<EndBug> if ( * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } } # endif <StartBug>colon = memchr ( str , ':' , str_len - 1 ) ;<EndBug> if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",335,-14.498024502001702,-0.0432776850806021
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>if (str_len > (p - str + 1)) {* portno = atoi ( p + 2 ) ;}<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>if (str_len > (colon - str + 1)) {* portno = atoi ( colon + 1 ) ;} host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",364,-12.387589319115841,-0.034031838788779786
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ; p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( p && * ( p + 1 ) == ':' ) {<EndBug> <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ;<EndBug> } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",269,-9.751152787202605,-0.036249638614136076
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:","
static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' || (p - str - 1) > str_len ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; if(colon - str > str_len) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}",394,-17.377809059234316,-0.044106114363538874
"The Original Code is vulnerable to CWE-918: Server-Side Request Forgery (SSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 <StartBug>char * p ;<EndBug> if ( * ( str ) == '[' && str_len > 1 ) { <StartBug>p = memchr ( str + 1 , ']' , str_len - 2 ) ;<EndBug> if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } <StartBug>* portno = atoi ( p + 2 ) ;<EndBug> return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { <StartBug>* portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; <EndBug>}
Fixed code:"," static inline char * parse_ip_address_ex ( const char * str , size_t str_len , int * portno , int get_err , zend_string * * err ) { char * colon ; char * host = NULL ; # ifdef HAVE_IPV6 char * p ; if ( * ( str ) == '[' && str_len > 1 ) { p = memchr ( str + 1 , ']' , str_len - 2 ) ; if ( ! p || * ( p + 1 ) != ':' ) { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } if (str_len > (size_t)(p - str - 1)) { * portno = atoi ( p + 2 ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse IPv6 address \\""%s\\"""" , str ) ; } return NULL ; } return estrndup ( str + 1 , p - str - 1 ) ; } # endif if ( str_len ) { colon = memchr ( str , ':' , str_len - 1 ) ; } else { colon = NULL ; } if ( colon ) { if (str_len > (size_t)(colon - str)) { * portno = atoi ( colon + 1 ) ; host = estrndup ( str , colon - str ) ; } else { if ( get_err ) { * err = strpprintf ( 0 , ""Failed to parse address \\""%s\\"""" , str ) ;} return NULL ; } return host ; }",377,-16.708897577948736,-0.044320683230633255
