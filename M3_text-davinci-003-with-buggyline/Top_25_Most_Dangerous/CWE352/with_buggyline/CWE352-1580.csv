Original code,Plausible Program,Number of Bugs Present,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" ""Nonce: %s\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ), generateNonce(), _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,227,-14.068013127476735,-0.06197362611223232
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int contentLength = StringBuffer_length(data); 
int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> contentLength , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,221,-7.651774198070728,-0.03462341266095352
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.1\r\n"" ""Content-Type: application/x-www-form-urlencoded\r\n"" <StartBug> ""Content-Length: %d\r\n"" <EndBug> ""X-Requested-With: XMLHttpRequest\r\n"" ""%s"" ""Connection: Close\r\n"" ""Cache-Control: no-cache\r\n"" ""Pragma: no-cache\r\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,258,-14.974458454840093,-0.05804053664666703
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,229,-4.948439844239794,-0.02160890761676766
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> size_t data_len = StringBuffer_length ( data ) ;
int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %zu\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> data_len , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,225,-13.766782047887698,-0.06118569799061199
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int content_length = StringBuffer_length(data); int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> content_length , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,221,-7.2898054650804305,-0.03298554509086168
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ""Connection: close\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,222,-7.6747415007474,-0.034570907661024323
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> char * dataString = StringBuffer_toString ( data ) ; int dataLength = strlen ( dataString ) ; int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , dataLength , <EndBug> _auth ? _auth : """" , dataString ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,227,-11.542655043114003,-0.05084870063045816
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S ,  <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,230,-7.984155170035,-0.034713718130586955
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int content_len=StringBuffer_length ( data ) ; int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , content_len , <EndBug> _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,238,-18.341560954946793,-0.07706538216364199
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv ; StringBuffer_T encodedData = StringBuffer_encodeUrl ( data ) ; rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( encodedData ) , _auth ? _auth : """" , StringBuffer_toString ( encodedData ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,235,-16.431254125397697,-0.06992023032084126
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int content_length = StringBuffer_length(data); 
int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" ""X-CSRF-Token: %s"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request ,content_length, _getCSRFHeader(), <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,248,-24.7801835770554,-0.09992009506877178
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> StringBuffer_T encodedData = StringBuffer_encodeURL(data); <EndBug> int rv = Socket_print ( S , <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , <StartBug> StringBuffer_length ( encodedData ) , <EndBug> request , _auth ? _auth : """" , StringBuffer_toString ( encodedData ) ) ; FREE ( _auth ) ; <StartBug> StringBuffer_free(&encodedData); <EndBug> if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,248,-15.164386520359344,-0.061146719840158646
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int contentLength = StringBuffer_length ( data ) ; int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""X-CSRF-Token: <CSRF_Token_Value>\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , contentLength , <EndBug> _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,241,-18.033764045462693,-0.07482889645420204
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int length = StringBuffer_length ( data ) ; int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , length , <EndBug> _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,218,-5.506055237723402,-0.025257134117997255
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> StringBuffer_T sb = StringBuffer_create ( 100 ) ; StringBuffer_append ( sb, ""POST %s HTTP/1.0\\r\\n"" ) ; StringBuffer_append ( sb, ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ) ; StringBuffer_appendf ( sb, ""Content-Length: %d\\r\\n"" , StringBuffer_length ( data ) ) ; if ( _auth != NULL ) { StringBuffer_append ( sb, _auth ) ; } StringBuffer_append ( sb, ""\\r\\n"" ) ; StringBuffer_append ( sb, ""%s"" , StringBuffer_toString ( data ) ) ; int rv = Socket_print ( S , StringBuffer_toString ( sb ) ) ; StringBuffer_free ( &sb ) ; FREE ( _auth ) ; <EndBug> if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,289,-25.053848179067593,-0.0866915161905453
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int contentLength = StringBuffer_length ( data ) ; int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , contentLength , <EndBug> _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,236,-6.7375231208149,-0.028548826783113983
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int content_length = StringBuffer_length ( data ) ; int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , content_length, <EndBug> _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,222,-6.5935290483047515,-0.02970058129867005
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> StringBuffer_T post_request; post_request = StringBuffer_create(request); StringBuffer_append(post_request,"" HTTP/1.0\r\n""); StringBuffer_append(post_request,""Content-Type: application/x-www-form-urlencoded\r\n""); StringBuffer_append(post_request,""Content-Length: %d\r\n"", StringBuffer_length(data)); if(_auth) StringBuffer_append(post_request,""%s\r\n"",_auth); StringBuffer_append(post_request,""%s"",StringBuffer_toString(data)); int rv = Socket_print(S,StringBuffer_toString(post_request)); StringBuffer_free(&post_request); <EndBug> FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,265,-37.64874056554422,-0.14207071911526123
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," 
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,230,-8.211313517244793,-0.03570136311845562
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,229,-6.1911580661749035,-0.02703562474312185
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; 
int rv = Socket_print ( S , 
""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , 
request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,211,-8.0341223119117,-0.03807640906119289
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int dataLength = StringBuffer_length ( data ) ; int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , dataLength , <EndBug> _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,220,-6.304269344525852,-0.02865576974784478
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""X-CSRF-Token: %s\\r\\n"" ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request, _getCSRFToken(), <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,235,-9.956584054639402,-0.04236844278569958
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int content_length = StringBuffer_length ( data ) ; int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , content_length , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,218,-8.881026710613352,-0.04073865463584106
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug>int contentLength = StringBuffer_length ( data ) ; StringBuffer_T requestString = StringBuffer_create ( 256 ) ; 
StringBuffer_append ( requestString , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ) ; 
StringBuffer_appendFormat ( requestString , ""Content-Length: %d\\r\\n"" , contentLength ) ; 
StringBuffer_append ( requestString , ""%s"" ""\\r\\n"" ) ; 
StringBuffer_append ( requestString , ""%s"" ) ; 
int rv = Socket_print ( S , StringBuffer_toString ( requestString ) , request , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; 
StringBuffer_free ( & requestString ) ;<EndBug>FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,291,-41.226325681939805,-0.14167122227470724
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,229,-5.053644238191099,-0.022068315450616154
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> size_t dataLen = StringBuffer_length ( data ); int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %zu\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> dataLen , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,221,-12.772951658732847,-0.057796161351732336
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int contentLength = StringBuffer_length(data);
int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , contentLength, <EndBug> _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,220,-7.812748234097029,-0.03551249197316831
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int content_length = StringBuffer_length ( data ) ; int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> content_length , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,222,-4.7231262898041,-0.021275343647766218
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int contentLength = StringBuffer_length ( data ) ; int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , contentLength , <EndBug> _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,220,-4.667369336909201,-0.021215315167769096
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int len = StringBuffer_length ( data ); char * encoded_data = Socket_encodeBase64 ( data, len ); int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> strlen ( encoded_data ) , _auth ? _auth : """" , encoded_data ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,235,-23.895165165131967,-0.10168155389417859
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug>""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""Content-Length: %d\\r\\n"" <StartBug> ""X-CSRF-Token: %s\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request, _getCsrfToken(), <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,258,-15.005027313226787,-0.05815902059390227
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; 
int rv = Socket_print ( S ,  
""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" 
""Content-Length: %d\\r\\n"" 
""%s"" ""\\r\\n"" 
""%s"" ,  request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,202,-18.6949627482061,-0.09254932053567376
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> char * encData = _encodeUrl(StringBuffer_toString(data)); int rv  = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , strlen(encData) , <EndBug> _auth ? _auth : """" , encData ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,225,-32.425153382163806,-0.14411179280961692
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","

static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int contentLength = StringBuffer_length(data);
int rv = Socket_print(S, <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> contentLength , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,221,-13.474175265044096,-0.06096911884635337
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,229,-6.160856992684106,-0.02690330564490876
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int contentLength = StringBuffer_length ( data ) ; int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""X-CSRF-Token: %s\\r\\n"" ""%s"" , <StartBug> request , contentLength , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,222,-9.706212832845294,-0.043721679427231055
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int len = StringBuffer_length(data); 
int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , len, <EndBug> _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,219,-10.071074763422295,-0.04598664275535295
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int content_length = StringBuffer_length ( data ) ; int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> content_length , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,222,-4.931856620632101,-0.022215570363207662
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" ""X-CSRF-TOKEN: %s\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _getCSRFToken(), _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,232,-12.625762387330402,-0.05442138960056208
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,221,-8.429145704873838,-0.03814093079128433
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int requestSize = strlen(request);
int dataSize = StringBuffer_length(data); 
int bodySize = dataSize + requestSize;
int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , bodySize <EndBug> , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,242,-24.062149781961946,-0.09943037099984275
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int contentLength = StringBuffer_length(data); char contentLengthStr[20]; sprintf(contentLengthStr, ""%d"", contentLength); int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %s\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> contentLengthStr, _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,240,-12.063116957800608,-0.0502629873241692
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""Connection:close\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,222,-10.309557526256695,-0.0464394483164716
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int len = StringBuffer_length(data); char len_str[50]; snprintf (len_str, sizeof(len_str), ""%d"", len); int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %s\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> len_str, _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,244,-22.170653377333625,-0.0908633335136624
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> StringBuffer_T sb = StringBuffer_create ( 1024 ) ; 
StringBuffer_append ( sb , ""POST %s HTTP/1.0\\r\\n"" ) ; 
StringBuffer_append ( sb , ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ) ; 
StringBuffer_append ( sb , ""Content-Length: %d\\r\\n"" , StringBuffer_length ( data ) ) ; 
StringBuffer_append ( sb , ""%s"" , _auth ? _auth : """" ) ; 
StringBuffer_append ( sb , ""\\r\\n"" ) ; 
StringBuffer_append ( sb , ""%s"" , StringBuffer_toString ( data ) ) ; 
int rv = Socket_print ( S , StringBuffer_toString ( sb ) ) ; 
StringBuffer_free ( & sb ) ; 
FREE ( _auth ) ; 
<EndBug> if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,309,-18.3943257052322,-0.059528562152855014
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int length = StringBuffer_length(data); StringBuffer_prepend(data, ""Content-Length: %d\\r\\n"", length); int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""%s"" <EndBug> ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,225,-13.966176360543107,-0.06207189493574714
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int contentLength = StringBuffer_length ( data ) ; int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug>""Content-Length: %d\\r\\n"" <EndBug>""Content-Length: %d\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , contentLength , <EndBug> contentLength , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,233,-12.724730906667292,-0.05461257899857207
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int contentLength = StringBuffer_length ( data ) ; int rv = Socket_print ( S , <EndBug> ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" <StartBug> ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , <StartBug> request , <EndBug> contentLength , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",3,220,-4.862677823194976,-0.02210308101452262
