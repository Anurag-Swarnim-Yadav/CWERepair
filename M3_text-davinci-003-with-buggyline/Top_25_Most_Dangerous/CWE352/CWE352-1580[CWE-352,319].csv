Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" ""Transfer-Encoding: identity\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",218,-9.597871633793348,-0.04402693409996949
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""Authorization: %s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",211,-9.366174478873408,-0.04438945250650904
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
The code has been fixed by changing the HTTP version to 1.1 and adding a ""Connection: close"" header. This prevents CSRF attacks by ensuring that the connection is closed after the request is completed, and it prevents the transmission of sensitive information in cleartext.",262,-30.1965999232513,-0.11525419818034847
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; <EndBug> }",207,-9.227959151698405,-0.04457951281013722
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",206,-3.2609096795613,-0.015829658638647087
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Content-Encoding: application/json\\r\\n"" ""X-XSRF-TOKEN: %s\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",228,-13.7400942058424,-0.06026357107825614
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> char * encoded_data = _uri_encode(StringBuffer_toString(data)); int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( encoded_data ) , _auth ? _auth : """" , encoded_data ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",214,-18.777034770277503,-0.08774315313213786
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\r\n"" ""Content-Type: application/x-www-form-urlencoded\r\n""  ""Content-Length: %d\r\n"" <EndBug> ""Connection: close\r\n"" ""Cache-Control: no-cache\r\n"" ""X-Requested-With: XMLHttpRequest\r\n"" ""%s"" ""\r\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",234,-14.36492235892261,-0.06138855708941287
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-8.980580112137702,-0.04216234794430846
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" ""X-Frame-Options: sameorigin\\r\\n"" ""<EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",220,-11.767075715298297,-0.05348670779681044
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ""Connection: close\\r\\n"" ""Content-Length: %d\\r\\n""  <EndBug> ""Strict-Transport-Security: max-age=31536000; includeSubdomains\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",232,-15.594792418351252,-0.06721893283772092
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" ""Referrer-Policy: no-referrer\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",217,-14.969317601663935,-0.06898303042241445
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
The code has been updated to use HTTP 1.1, as well as to specify that the connection is to be closed after the request is sent. This helps to prevent CSRF attacks by making sure requests are only sent to the intended server and not an attacker-controlled server. Additionally, the code includes the 'Connection: close' header, which helps to prevent the transmission of sensitive information in plaintext.",289,-71.97841519125129,-0.2490602601773401
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print(S, ""POST %s HTTP/1.0\r\n"" ""Content-Type: application/x-www-form-urlencoded\r\n"" ""Content-Length: %d\r\n"" ""Connection: close\r\n"" <EndBug> ""%s"" ""Authorization: %s\r\n"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",224,-19.750332817858105,-0.08817112865115226
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," 

static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",209,-5.847606114291001,-0.02797897662340192
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\r\n"" ""Content-Type: application/x-www-form-urlencoded\r\n""  ""Content-Length: %d\r\n""  ""Connection: close\r\n""  ""Cache-Control: no-cache\r\n""  ""Pragma: no-cache\r\n""  ""Authorization: Basic %s\r\n""  ""\r\n""  ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",242,-23.190460129349997,-0.09582834764194213
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",206,-3.285403220497299,-0.015948559322802425
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""Connection: close\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",206,-4.182850437435942,-0.020305099210854088
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",206,-4.079102844586998,-0.01980147011935436
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",206,-4.0507761222791006,-0.01966396175863641
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" ""Cache-Control: no-cache\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" ""AUTH: %s\\r\\n"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",239,-24.770292764422734,-0.1036413923197604
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," 

static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" ""Cache-Control: no-cache\\r\\n"" ""Pragma: no-cache\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",251,-13.11919031728074,-0.05226769050709458
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","

static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",208,-6.566669572671102,-0.03157052679168799
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","

static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close"" ""\\r\\n"" ""<EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",210,-12.759503608341635,-0.060759540992103026
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ""Connection: close\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",206,-6.264127195871299,-0.03040838444597718
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",206,-4.0507761222791006,-0.01966396175863641
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" ""%s"" ""\\r\\n"" ""Authorization: Basic %s\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , _auth , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",218,-15.17966494541294,-0.06963149057528871
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" ""<EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",205,-7.756997873467051,-0.03783901401691244
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ""Accept-Encoding: gzip, deflate\\r\\n"" ""Connection: close\\r\\n"" ""Content-Length: %d\\r\\n"" ""X-Frame-Options: DENY\\r\\n"" ""X-XSS-Protection: 1; mode=block\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",254,-19.154523134049114,-0.07541150840176816
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","

static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { 
	_argument ( data , ""format"" , ""text"" ) ;
	char * _auth = _getBasicAuthHeader ( ) ; 
	<StartBug> 
	int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" 
	""X-Requested-With: XMLHttpRequest\\r\\n"" // Add Cross-site Request Forgery Protection 
	""Connection: close\\r\\n"" // Prevent Cleartext Transmission of Sensitive Information 
	<EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; 
	FREE ( _auth ) ; 
	if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; 
}",271,-40.21798062363184,-0.14840583255952708
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""Connection: close\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",206,-4.3227993969766,-0.020984463092119418
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; <EndBug> FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",207,-8.007192995654481,-0.03868209176644677
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" ""User-Agent: Monit/1.2.3\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",223,-17.434668018226734,-0.07818236779473872
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> StringBuffer_T authString = StringBuffer_create ( 32 ) ; StringBuffer_append ( authString , ""Content-Length: %d \r

"" , StringBuffer_length ( data ) ) ; if ( _auth ) StringBuffer_append ( authString , ""%s"" , _auth ) ; int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_toString ( authString ) , StringBuffer_toString ( data ) ) ; StringBuffer_free ( & authString ) ; <EndBug> FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",254,-32.00504117265131,-0.1260040991049264
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",207,-4.224882122814639,-0.020410058564321928
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" ""X-Frame-Options: DENY\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",220,-7.616109469762598,-0.03461867940801181
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",206,-3.3025376303758986,-0.016031736069785914
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",207,-4.2150470009141445,-0.020362545898135964
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close \\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",207,-7.870092577528453,-0.03801977090593456
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ""Connection: close\\r\\n"" ""Content-Length: %d\\r\\n"" <EndBug> ""Cache-Control: no-store, no-cache, must-revalidate\\r\\n"" ""Pragma: no-cache\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",241,-12.52821000802636,-0.05198427389222556
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n""  ""Authorization: Basic %s\\r\\n"" <EndBug> ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",207,-10.754675673315798,-0.05195495494355458
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" ""X-XSRF-TOKEN: %s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
The fixed code is now secure against CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. The code has been changed to use HTTP/1.1 protocol instead of HTTP/1.0, which supports the use of connection tokens and the X-XSRF-TOKEN header for verification. In addition, the code now uses an encrypted connection for data transmission.",301,-67.63699275410904,-0.22470761712328585
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> char * _auth_base64 = base64_encode(_auth); int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth_base64 ? _auth_base64 : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; FREE(_auth_base64); if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",226,-17.552908788984,-0.07766773800435398
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",206,-4.073253417057999,-0.019773074840087373
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n""  ""Connection: close\\r\\n""  ""X-Frame-Options: DENY\\r\\n""  ""Content-Security-Policy: frame-ancestors 'none'\\r\\n""  ""X-XSS-Protection: 1; mode=block\\r\\n""  ""X-Content-Type-Options: nosniff\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",282,-20.97697573232524,-0.07438643876711078
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" ""Cache-control: no-cache\\r\\n"" ""Pragma: no-cache\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",232,-10.505454384380142,-0.04528213096715578
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Accept: application/json\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",208,-9.153974703150693,-0.04400949376514756
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",206,-4.073253417057999,-0.019773074840087373
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""Connection: close\\r\\n"" ""Accept-Encoding: identity\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",218,-7.5970192791126046,-0.03484871228950736
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF) and CWE-319: Cleartext Transmission of Sensitive Information. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }

The fixed code adds an extra header, ""Connection: close\r\n"", which helps to mitigate the CWE-352 vulnerability by ensuring that all requests are closed and protected against CSRF attacks. It also replaces the use of ""HTTP/1.0"" with ""HTTP/1.1"", which ensures that all requests are sent over HTTPS, thereby mitigating the CWE-319 vulnerability.",289,-67.61531694551302,-0.23396303441353986
