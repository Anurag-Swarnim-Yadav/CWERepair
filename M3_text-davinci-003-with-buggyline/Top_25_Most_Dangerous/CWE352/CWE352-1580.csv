Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> char * _token = _getTokenHeader ( ) ; int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , _token ? _token : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; FREE ( _token ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",225,-15.839107568150403,-0.07039603363622401
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n""  ""Origin: %s\\r\\n""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , ORIGIN_URL, _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; <EndBug> FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",209,-23.868957154023406,-0.11420553662212156
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-3.2248479439015,-0.015140131192025822
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-3.2261215968154993,-0.015146110783171358
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," 
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; <EndBug> FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",215,-7.644362729567997,-0.03555517548636278
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-CSRF-Token: %s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _getCSRFToken(), _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",208,-9.354220535121202,-0.04497221411115963
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-3.2248479439015,-0.015140131192025822
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With:XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",214,-6.591035164413401,-0.030799229740249536
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-3.2248479439015,-0.015140131192025822
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-8.30746210342084,-0.039002169499628356
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.1\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-5.369340646522505,-0.025208172049401432
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; <EndBug> FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",214,-5.116095372271428,-0.023906987720894526
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",214,-4.439180025413647,-0.02074383189445629
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-CSRF-Token: %s\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; <EndBug> FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",203,-7.1133674514253995,-0.035041218972538916
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) {  _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> StringBuffer_append(data,""&csrf=<csrf-token-value>""); int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",219,-25.58523431809599,-0.11682755396390862
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," 
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n""  ""X-CSRF-Token: %s""  ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",205,-13.215371395224503,-0.06446522631816831
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","

static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> char * encodedData = _urlEncode(StringBuffer_toString(data)); int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , strlen(encodedData) , _auth ? _auth : """" , encodedData ) ; FREE ( _auth ) ; FREE(encodedData); if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",217,-12.499161008294587,-0.0575998203147216
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> const char * content_num = StringBuffer_length ( data ) != 0 ? ""Content-Length: %d\\r\\n"" : """"; int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" content_num  ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",216,-34.26301152118003,-0.15862505333879645
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n""  ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n""  ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",215,-9.219576551231793,-0.042881751401078104
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-3.4064193642201994,-0.01599257917474272
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-3.4243701844975014,-0.01607685532627935
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-3.4064193642201994,-0.01599257917474272
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",210,-5.943897113875291,-0.02830427197083472
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> char * token = _generateCSRFToken(); _argument(data, ""token"", token); int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; FREE(token); if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",223,-13.590000530678001,-0.06094170641559642
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" ""<EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-5.653843388771297,-0.026543865674982615
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; <EndBug> FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-4.396531568317243,-0.020640993278484707
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> char * csrf_token; csrf_token = _getCSRFToken(); int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""csrf_token: %s\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , csrf_token, StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",231,-20.385006280953302,-0.08824678043702729
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-CSRF-TOKEN: %s"" <EndBug> ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _getCSRFToken(), _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",214,-12.744611730302848,-0.059554260421975924
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug>int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-CSRF-Token: %s\\r\\n"" ""%s"" , request , StringBuffer_length ( data ), _auth ? _auth : """" , StringBuffer_toString ( data ) ) ;<EndBug> FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",202,-16.779227798455107,-0.08306548415076785
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
 static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> StringBuffer_prepend(data, _auth); int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",209,-15.927266004523233,-0.07620701437570924
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> StringBuffer_T sb = StringBuffer_create ( 256 ) ; StringBuffer_append ( sb, ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" , request , StringBuffer_length ( data ) ) ; if ( _auth ) { StringBuffer_append ( sb, _auth ) ; } StringBuffer_append ( sb, ""\\r\\n"" ""%s"" , StringBuffer_toString ( data ) ) ; int rv = Socket_print ( S , StringBuffer_toString ( sb ) ) ; StringBuffer_free ( &sb ) ; FREE ( _auth ) ; <EndBug> if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",258,-20.31421152723609,-0.07873725398153524
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\r\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",214,-7.2985407486959515,-0.034105330601382954
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> StringBuffer_T xsrf_header = StringBuffer_create ( 50 ) ; StringBuffer_append ( xsrf_header , ""X-CSRF-Token: "" ) ; StringBuffer_append ( xsrf_header , _auth ) ; int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""%s"" <EndBug> ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , StringBuffer_toString ( xsrf_header ) , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; StringBuffer_free ( & xsrf_header ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",270,-26.79862367052569,-0.09925416174268774
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> StringBuffer_T nonce = StringBuffer_create ( 100 ) ; int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-CSRF-Token: %s"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , StringBuffer_toString ( nonce ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; StringBuffer_free ( & nonce ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",243,-21.980231454004468,-0.09045362738273444
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) {
 _argument ( data , ""format"" , ""text"" ) ; 
 char * _auth = _getBasicAuthHeader ( ) ; 
 <StartBug>
 int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n""
 ""Content-Type: application/x-www-form-urlencoded\\r\\n""  
 ""Content-Length: %d\\r\\n""
 ""X-Requested-With: XMLHttpRequest\\r\\n"" 
 <EndBug>
 ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; 
 FREE ( _auth ) ; 
 if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ;
 }",231,-23.953736445395883,-0.10369582876794754
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Connection: close\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",206,-5.3157708360655365,-0.025804712796434644
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-XSRF-TOKEN: %s \\r\\n"" ""<EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",214,-14.035826905413895,-0.06558797619352287
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Origin: \\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",205,-9.045109467303297,-0.044122485206357545
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n"" ""Connection: close\\r\\n"" ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",205,-8.439116884560136,-0.041166423827122614
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-3.403660895705197,-0.015979628618334258
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-CSRF-Token: %s\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; <EndBug> FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",203,-7.369920190096242,-0.03630502556697656
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> char * tokenVal = _getCSRFToken(); _argument(data, ""token"", tokenVal); int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; FREE ( tokenVal ); if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",225,-21.116424064166022,-0.09385077361851565
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; <EndBug> FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",214,-5.104373901917372,-0.02385221449494099
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-CSRF-Token: <GET_CSRF_TOKEN>\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",219,-15.921203139187394,-0.07269955771318445
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> char* csrf_token = ""csrf_token=123456""; int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ), csrf_token ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",222,-19.7892292382259,-0.08914067224426081
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; <EndBug> FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-4.310705849310141,-0.020238055630564043
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""Origin: <Origin URL>\\r\\n"" ""<EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",209,-12.5913033368527,-0.06024547051125694
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",213,-3.403660895705197,-0.015979628618334258
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:"," static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> char * _host = _getHostHeader ( ) ; int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""%s""  ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _host ? _host : """" , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; FREE ( _host ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }",227,-18.1398951222445,-0.0799114322565837
"The Original Code is vulnerable to CWE-352: Cross-Site Request Forgery (CSRF). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" <EndBug> ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; }
Fixed code:","
static void _send ( Socket_T S , const char * request , StringBuffer_T data ) { _argument ( data , ""format"" , ""text"" ) ; char * _auth = _getBasicAuthHeader ( ) ; <StartBug> int rv = Socket_print ( S , ""POST %s HTTP/1.0\\r\\n"" ""Content-Type: application/x-www-form-urlencoded\\r\\n""  ""Content-Length: %d\\r\\n"" ""X-Requested-With: XMLHttpRequest\\r\\n"" ""%s"" ""\\r\\n"" ""%s"" , request , StringBuffer_length ( data ) , _auth ? _auth : """" , StringBuffer_toString ( data ) ) ; FREE ( _auth ) ; if ( rv < 0 ) THROW ( IOException , ""Monit: cannot send command to the monit daemon -- %s"" , STRERROR ) ; <EndBug> }",214,-7.67604345991209,-0.035869361962206026
