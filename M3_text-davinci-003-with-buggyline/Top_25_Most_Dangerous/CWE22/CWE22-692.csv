Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; if (remote_dev == NULL) { return; } pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}",189,-7.437940488367099,-0.0393541824781328
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," 
static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) remote_dev = xop -> dst_dev ; else remote_dev = xop -> src_dev ; 

const char * remote_dev_path = config_item_name (& remote_dev -> dev_group . cg_item ); if (! remote_dev_path ) { pr_err (""Unable to locate remote_dev->dev_group->cg_item "" ""struct config_item path
""); goto out; } 

pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p remote_dev_path: %s\\n"" , remote_dev , & remote_dev -> dev_group . cg_item , remote_dev_path ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; 
out: return; }",251,-59.60229127814449,-0.23745932780137247
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) remote_dev = xop -> dst_dev ; else remote_dev = xop -> src_dev ; if (!remote_dev || !remote_dev->dev_group) { pr_debug(""remote_dev or remote_dev->dev_group is NULL. Returning.\\n""); return; } pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; }",195,-21.31827892658029,-0.10932450731579636
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) remote_dev = xop -> dst_dev ; else remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}",161,-6.843995675437701,-0.04250928990955094
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char path[PATH_MAX]; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> snprintf(path, sizeof(path), ""/sys/kernel/config/target/%s"", xop->dst_dev->transport->name); remote_dev = xop->dst_dev; <EndBug> else <StartBug> snprintf(path, sizeof(path), ""/sys/kernel/config/target/%s"", xop->src_dev->transport->name); remote_dev = xop->src_dev; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}",252,-18.9884736833002,-0.07535108604484206
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char path[PATH_MAX]; int ret; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; ret = realpath(remote_dev->dev_group.cg_item, path); if(ret == -1) { /* Handle error here */ return; } pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %s\\n"" , remote_dev , path ) ; target_undepend_item (path) ; <EndBug>}",199,-29.940750203023793,-0.15045603117097384
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," 
static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char remote_dev_path [ MAX_PATH_LEN ] ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; snprintf ( remote_dev_path , MAX_PATH_LEN , ""%s%s"" , xop - > dst_dev - > dev_group . cg_item . ci_group_path , xop - > dst_dev - > dev_group . cg_item . ci_item_name ) ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; snprintf ( remote_dev_path , MAX_PATH_LEN , ""%s%s"" , xop - > src_dev - > dev_group . cg_item . ci_group_path , xop - > src_dev - > dev_group . cg_item . ci_item_name ) ; <EndBug> pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , remote_dev_path ) ; target_undepend_item ( remote_dev_path ) ; <EndBug>}",328,-31.742430710839887,-0.09677570338670698
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) { remote_dev = xop -> dst_dev ; } else { remote_dev = xop -> src_dev ; if (remote_dev == NULL) { return; } <EndBug> pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; } }",177,-11.968637167019095,-0.06761941902270675
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) { remote_dev = xop -> dst_dev ; } else { remote_dev = xop -> src_dev ; } if ( remote_dev ) { pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; } else { /* Handle error here */ } }",173,-21.7656557576881,-0.12581303906178093
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char path [ PATH_MAX + 1 ] ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; realpath ( remote_dev -> dev_group . cg_item . ci_path , path ) ; if ( strncmp ( path , ""/sys/kernel/config/target"" , strlen ( ""/sys/kernel/config/target"" ) ) != 0 ) return ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}",248,-24.211449761368396,-0.09762681355390482
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char * dev_name = xop -> op_origin == XCOL_SOURCE_RECV_OP ? xop -> dst_dev : xop -> src_dev ; char remote_dev_path [ MAX_PATH ] ; if ( ! getcwd ( remote_dev_path , MAX_PATH ) ) { perror ( ""getcwd() error"" ) ; return ; } strncat ( remote_dev_path , dev_name , MAX_PATH ) ; remote_dev = open ( remote_dev_path ) ; <EndBug> pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}",238,-54.1690785205682,-0.22760117025448823
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) remote_dev = xop -> dst_dev ; else remote_dev = xop -> src_dev ; 

if (strncmp(remote_dev->dev_group.cg_item.ci_name, ""../"", 3) != 0) {
    pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; 
    target_undepend_item ( & remote_dev -> dev_group . cg_item ) ;
}",194,-15.548426142432504,-0.08014652650738405
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) remote_dev = xop -> dst_dev ; else remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; }",153,-4.6938706326659965,-0.030678893023960763
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) { remote_dev = xop -> dst_dev ; } else { remote_dev = xop -> src_dev ; } <EndBug> pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; }",165,-6.0256947746497005,-0.03651936227060425
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { struct se_device * remote_dev ; char * absolute_path ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) remote_dev = xop -> dst_dev ; else remote_dev = xop -> src_dev ; absolute_path = realpath ( & remote_dev -> dev_group . cg_item , NULL ) ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %s\\n"" , remote_dev , absolute_path ) ; target_undepend_item ( absolute_path ) ; free ( absolute_path ) ; }",170,-15.070228789295413,-0.0886484046429142
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:","
static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; if (!remote_dev) return; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}",186,-10.654957848510893,-0.057284719615649966
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) remote_dev = xop -> dst_dev ; else remote_dev = xop -> src_dev ; if (strncmp(remote_dev->dev_group.cg_item.ci_name, ""/var/target/"", 11) != 0) { <EndBug> pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>} }",201,-22.293301123791398,-0.11091194588950944
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char * group_name ;<EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; group_name = remote_dev -> dev_group_name ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; group_name = remote_dev -> dev_group_name ; pr_debug ( ""Calling configfs_undepend_item for remote_dev: %p remote_dev->dev_group_name: %s\\n"" , remote_dev , group_name ) ; target_undepend_item ( group_name ) ; <EndBug>}",191,-24.050689434851645,-0.12591983997304526
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char abs_path [ PATH_MAX + 1 ] ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; realpath ( remote_dev -> dev_group . cg_item . i_link , abs_path ) ; if ( strncmp ( abs_path , XCOPY_DEV_DIR , strlen ( XCOPY_DEV_DIR ) ) == 0 ) { pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; } <EndBug> else <StartBug> remote_dev = xop -> src_dev ; realpath ( remote_dev -> dev_group . cg_item . i_link , abs_path ) ; if ( strncmp ( abs_path , XCOPY_DEV_DIR , strlen ( XCOPY_DEV_DIR ) ) == 0 ) { pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; } <EndBug>}",390,-31.64025372821914,-0.08112885571338241
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:","
static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; if ( xop -> op_origin != XCOL_SOURCE_RECV_OP ) { return; } <EndBug> remote_dev = xop -> dst_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; }",154,-10.0481272068851,-0.06524757926548766
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) { remote_dev = xop -> dst_dev ; } else { remote_dev = xop -> src_dev ; } <EndBug> pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; }",165,-5.852392554477803,-0.03546904578471396
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) remote_dev = xop -> dst_dev ; else remote_dev = xop -> src_dev ; 
if (remote_dev) { pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; }
}",164,-11.496567367020502,-0.07010102053061282
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char * remote_dev_path ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; remote_dev_path = realpath(remote_dev, NULL); <EndBug> else <StartBug> remote_dev = xop -> src_dev ; remote_dev_path = realpath(remote_dev, NULL); pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %s\\n"" , remote_dev , remote_dev_path ) ; target_undepend_item ( remote_dev_path ) ; <EndBug>}",199,-14.095735134717492,-0.07083283987295222
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char full_dir_path[PATH_MAX]; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> strncpy(full_dir_path, xop->dst_dev->dev_group.cg_item.ci_path, PATH_MAX - 1); remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> strncpy(full_dir_path, xop->src_dev->dev_group.cg_item.ci_path, PATH_MAX - 1); remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p full_dir_path: %s\\n"" , remote_dev , & remote_dev -> dev_group . cg_item, full_dir_path) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}",275,-32.70049474215294,-0.11891088997146523
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) remote_dev = xop -> dst_dev ; else remote_dev = xop -> src_dev ; <StartBug> if (strstr(remote_dev->dev_group.cg_item.path, "".."") == NULL) { <EndBug> pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <StartBug> } <EndBug> }",205,-22.124043818815675,-0.10792216496983256
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:","
static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { 
 struct se_device * remote_dev ; 
 if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) 
 remote_dev = xop -> dst_dev ; 
 else 
 remote_dev = xop -> src_dev ; 
 if(strcmp(remote_dev->dev_group.cg_item.ci_name, ""xop"") == 0) { 
 pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; 
 target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; 
 }
}",204,-25.0417141559115,-0.12275350076427205
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:","  static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; if ( xop == NULL ) return; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; if ( remote_dev == NULL ) return; <EndBug> pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}",201,-16.673338653883718,-0.08295193360141154
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:","
static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug>struct se_device * remote_dev ; const char * remote_dev_group_path; </EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; remote_dev_group_path = remote_dev->dev_group.cg_item.ci_group.cg_item.ci_dentry->d_iname; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %s\\n"" , remote_dev , remote_dev_group_path) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}",223,-39.32105966564457,-0.17632762181903394
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:","

static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { 
struct se_device * remote_dev ; 
if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) { 
remote_dev = xop -> dst_dev ; 
if (remote_dev != NULL) { 
pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; 
target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; 
}
} else { 
remote_dev = xop -> src_dev ; 
if (remote_dev != NULL) { 
pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; 
target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; 
}
}
}",283,-18.963684074038188,-0.06700948436055897
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:","
static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; 
if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) { 
    remote_dev = xop -> dst_dev ; 
} else { 
    remote_dev = xop -> src_dev ;
    if (remote_dev) {
        pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; 
        target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; 
    }
} <EndBug>}",195,-22.654286860797196,-0.11617583005537023
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char * abs_remote_path ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; abs_remote_path = realpath ( remote_dev -> dev_group . cg_item . ci_pathname , NULL ) ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %s\\n"" , remote_dev , abs_remote_path ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; free ( abs_remote_path ) ; <EndBug>}",217,-20.607897834791682,-0.09496727112807227
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) remote_dev = xop -> dst_dev ; else remote_dev = xop -> src_dev ; if (!remote_dev) { pr_err (""Invalid remote device specified \\n""); return; } pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; }",174,-22.205222519427295,-0.12761622137601894
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) remote_dev = xop -> dst_dev ; else remote_dev = xop -> src_dev ; if (remote_dev) { pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; } }",161,-5.60362574476064,-0.03480512884944497
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; if (remote_dev) { pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; } <EndBug>}",185,-6.499125636916495,-0.03513040884819727
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char dev_path [ PATH_MAX ] ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; snprintf ( dev_path , PATH_MAX , ""%s/%s"" , remote_dev -> dev_group . cg_subsystem -> su_group.cg_item.ci_path , remote_dev -> dev_group . cg_item . ci_name ) ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p dev_path: %s\\n"" , remote_dev , dev_path ) ; target_undepend_item_path ( dev_path ) ; <EndBug> }",229,-32.50412072738441,-0.14193939182263934
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; const char *path; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; path = dentry_path_raw(remote_dev->dev_dentry, remote_dev->dev_dentry->d_name.name, 0); <EndBug> else <StartBug> remote_dev = xop -> src_dev ; path = dentry_path_raw(remote_dev->dev_dentry, remote_dev->dev_dentry->d_name.name, 0); pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item, path ) ; <EndBug>}",254,-28.621654766188282,-0.11268368018184363
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:","
static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { struct se_device * remote_dev ; 
if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) 
remote_dev = xop -> dst_dev ; 
else 
remote_dev = xop -> src_dev ; 

if (!remote_dev) {
    return;
}

pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; 
}",182,-16.31774609392541,-0.08965794557101875
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartFix> struct se_device * remote_dev ; <EndFix> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartFix> remote_dev = xop -> dst_dev ; <EndFix> else <StartFix> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndFix>}",177,-13.042629830565687,-0.07368717418398693
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," 

static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { 
struct se_device * remote_dev ; 
if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) 
remote_dev = xop -> dst_dev ; 
else 
remote_dev = xop -> src_dev ; 
if (remote_dev != NULL && & remote_dev->dev_group.cg_item != NULL) {
    pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ;
    target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; 
}
}",201,-20.35376902637151,-0.10126253246951
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; const char * dev_group_path ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; dev_group_path = kobject_get_path ( & remote_dev -> dev_group . cg_item . kobj , GFP_KERNEL ) ; if ( ! dev_group_path ) { pr_err ( ""Unable to locate dev_group_path

"" ) ; return ; } pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %s\\n"" , remote_dev , dev_group_path ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; kfree ( dev_group_path ) ; <EndBug>}",258,-17.08967439698301,-0.06623904805032174
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char buf[PATH_MAX]; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> snprintf(buf, sizeof(buf), ""%s"", xop->dst_dev->transport->name); remote_dev = &xop->dst_dev[strlen(buf) - 1]; <EndBug> else <StartBug> snprintf(buf, sizeof(buf), ""%s"", xop->src_dev->transport->name); remote_dev = &xop->src_dev[strlen(buf) - 1]; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}",252,-30.515065075999015,-0.12109152807936117
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:","
static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { 
    struct se_device * remote_dev ; 
    if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) 
        remote_dev = xop -> dst_dev ; 
    else 
        remote_dev = xop -> src_dev ; 
    if(remote_dev == NULL) {
        return;
    }
    pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; 
    target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; 
}",195,-14.636408954605194,-0.07505850745951381
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { struct se_device * remote_dev ; char remote_dev_name [ MAX_REMOTE_DEV_NAME_SIZE ] ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) remote_dev = xop -> dst_dev ; else remote_dev = xop -> src_dev ; snprintf ( remote_dev_name , sizeof ( remote_dev_name ) , ""%s/"" , remote_dev -> dev_group . cg_item . cit_name ) ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item , remote_dev_name ) ; }",218,-30.859907340671995,-0.14155920798473393
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char pathname [ MAX_PATH_LENGTH ] ; getcwd ( pathname , MAX_PATH_LENGTH ) ; strcat ( pathname , ""/usr/src/remote_dev"" ) ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; chdir ( pathname ) ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}",228,-37.14586810663335,-0.16292047415190067
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char *dev_group_path; dev_group_path = kzalloc(PATH_MAX, GFP_KERNEL); if(!dev_group_path) return; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; snprintf(dev_group_path, PATH_MAX, ""/sys/kernel/config/%p/"", &remote_dev->dev_group.cg_item); target_undepend_item (dev_group_path); kfree(dev_group_path); <EndBug>}",251,-35.35712747564658,-0.14086504970377123
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:","
static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) remote_dev = xop -> dst_dev ; else remote_dev = xop -> src_dev ; <EndBug> pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; }",162,-6.653505416574501,-0.041071021089966055
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; char path[PATH_MAX]; snprintf(path, PATH_MAX, ""/configfs/target/core/%s"", remote_dev->dev_group.cg_item.ci_name); pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p path: %s\\n"" , remote_dev , & remote_dev -> dev_group . cg_item , path ) ; target_undepend_item ( path ) ; <EndBug>}",215,-27.279260129312025,-0.12688027967121873
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; if (!remote_dev) { return; } <EndBug> else <StartBug> remote_dev = xop -> src_dev ; if (!remote_dev) { return; } pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}",197,-8.4091831613007,-0.04268620894061269
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:"," static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { struct se_device * remote_dev ; if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) { remote_dev = xop -> dst_dev ; } else { remote_dev = xop -> src_dev ; } if (remote_dev != NULL) { pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; } }",167,-6.639759466857902,-0.03975903872370001
"The Original Code is vulnerable to CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code: static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %p\\n"" , remote_dev , & remote_dev -> dev_group . cg_item ) ; target_undepend_item ( & remote_dev -> dev_group . cg_item ) ; <EndBug>}
Fixed code:","
static void xcopy_pt_undepend_remotedev ( struct xcopy_op * xop ) { <StartBug> struct se_device * remote_dev ; char * remote_dev_path ; <EndBug> if ( xop -> op_origin == XCOL_SOURCE_RECV_OP ) <StartBug> remote_dev = xop -> dst_dev ; <EndBug> else <StartBug> remote_dev = xop -> src_dev ; remote_dev_path = realpath(remote_dev->dev_group.cg_item, NULL); pr_debug ( ""Calling configfs_undepend_item for"" "" remote_dev: %p remote_dev->dev_group: %s\\n"" , remote_dev , remote_dev_path) ; target_undepend_item ( &remote_dev_path); free(remote_dev_path); <EndBug>}",202,-26.690732149735904,-0.13213233737493021
