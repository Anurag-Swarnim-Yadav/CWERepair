Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; FillMemory(context->priv->PlaneBuffers[i] + planeSize, originalSize - planeSize, 0xFF); } else { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; } rle += planeSize ; } }",220,-8.07983943697505,-0.036726542895341135
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) {if(originalSize<=planeSize) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",199,-12.009726118803002,-0.06035038250654775
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; FillMemory ( context -> priv -> PlaneBuffers [ i ] + planeSize , originalSize - planeSize , 0xFF ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",218,-4.616441797429547,-0.021176338520319023
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if ( originalSize < planeSize ){ nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; } } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",230,-9.492929237130259,-0.04127360537882721
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if(originalSize <= MAX_SIZE) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else return; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",202,-11.106530805973785,-0.05498282577214745
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if(originalSize < context->priv->PlaneBuffers_Size) //added line nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",209,-22.1283336521177,-0.10587719450774019
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if (originalSize > planeSize) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; context -> priv -> PlaneBuffers[i] = 0; } else { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } } else { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; }  rle += planeSize ; } }",246,-24.38803293633153,-0.09913834526964037
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if (planeSize < originalSize) { if (originalSize <= context->priv->PlaneBuffers[i]) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else { //error handling } } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } } }",222,-24.7703212470258,-0.11157802363525136
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; else if ( planeSize > originalSize ) CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",196,-7.423209056180599,-0.03787351559275816
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if ( planeSize > originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; } else { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",230,-9.503861985785106,-0.04132113906863089
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , planeSize ) ; rle += planeSize ; } }",188,-3.5049794423173997,-0.018643507671901063
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) {if (originalSize < MAX_BUFFER_SIZE) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else return;} else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",204,-12.698562223535056,-0.06224785403693655
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else if (planeSize > originalSize) { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; } else { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , planeSize ) ; } rle += planeSize ; } }",224,-11.063999210389756,-0.049392853617811414
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) { FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; } else if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else { if ( originalSize > 0 ) { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; } } rle += planeSize ; } }",203,-8.08575067547893,-0.039831284115659754
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if (originalSize > context->priv->PlaneBuffers[i]) originalSize = context->priv->PlaneBuffers[i]; nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",220,-13.922059245334934,-0.06328208747879516
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) FillMemory (context->priv->PlaneBuffers[i]+planeSize, originalSize-planeSize, 0xFF); } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",225,-15.210748510562203,-0.06760332671360979
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:"," 
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { 	if(context->priv->PlaneBuffers[i] >= planeSize) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",210,-26.310578026041355,-0.12528846679067313
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; FillMemory ( context -> priv -> PlaneBuffers [ i ] + planeSize , originalSize - planeSize , 0xFF ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } } }",228,-7.020958202903501,-0.03079367632852413
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else if(planeSize >= originalSize) CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",196,-8.09906622849175,-0.041321766471896684
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if ( planeSize > originalSize ) planeSize = originalSize; nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",204,-5.1277170644896986,-0.0251358679631848
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if ( planeSize > originalSize ) planeSize = originalSize; nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",204,-5.1236658708346035,-0.02511600917075786
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if ( planeSize > originalSize ) planeSize = originalSize; nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",204,-5.1277170644896986,-0.0251358679631848
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if(planeSize > originalSize) { planeSize = originalSize; } nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else { if(planeSize > originalSize) { planeSize = originalSize; } CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; } rle += planeSize ; } }",224,-9.93215608589215,-0.044339982526304236
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize )  { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; FillMemory ( context -> priv -> PlaneBuffers [ i ] + planeSize , originalSize - planeSize , 0xFF ); } else if (planeSize > originalSize) CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",226,-19.514774749919308,-0.08634856084035092
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; if ( planeSize < originalSize ) FillMemory ( context -> priv -> PlaneBuffers [ i ] + planeSize, originalSize - planeSize, 0xFF ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",226,-9.70355611245039,-0.042936088993143315
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; else { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , planeSize ) ; FillMemory ( context -> priv -> PlaneBuffers [ i ] + planeSize , originalSize - planeSize , 0xFF ) ; } rle += planeSize ; } }",218,-7.195370941931352,-0.03300628872445574
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if (planeSize > originalSize) { planeSize = originalSize; } nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",206,-6.269829687556302,-0.03043606644444807
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if ( planeSize > 0 ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",220,-7.6205320567206,-0.034638782076002725
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if (originalSize < planeSize) planeSize=originalSize; nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; } else { if (originalSize < planeSize) planeSize=originalSize; CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , planeSize ) ; } rle += planeSize ; } }",220,-15.406795802533646,-0.07003089001151656
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; memset ( context -> priv -> PlaneBuffers [ i ] + planeSize , 0xFF , originalSize - planeSize ) ; } else { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; } rle += planeSize ; } }",220,-7.911664396522949,-0.03596211089328613
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { 
UINT16 i ; 
BYTE * rle ; 
UINT32 planeSize ; 
UINT32 originalSize ; 
UINT32 maxSize ; 
rle = context -> Planes ; 
for ( i = 0 ; i < 4 ; i ++ ) { 
originalSize = context -> OrgByteCount [ i ] ; 
planeSize = context -> PlaneByteCount [ i ] ; 
maxSize = originalSize > planeSize ? originalSize : planeSize ;
if ( planeSize == 0 ) { 
FillMemory ( context -> priv -> PlaneBuffers [ i ] , maxSize , 0xFF ) ; 
} else { 
nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , maxSize ) ; 
 } 
 rle += planeSize ; 
} 
}",218,-31.40265862231651,-0.14404889276291977
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if(originalSize > PLANE_BUFFER_SIZE) return; nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",205,-13.222965404054703,-0.06450227026368148
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data(NSC_CONTEXT *context) {
UINT16 i;
BYTE *rle;
UINT32 planeSize;
UINT32 originalSize;
rle = context->Planes;
for (i = 0; i < 4; i++) {
originalSize = context->OrgByteCount[i];
planeSize = context->PlaneByteCount[i];
if (planeSize == 0) {
FillMemory(context->priv->PlaneBuffers[i], originalSize, 0xFF);
}
else if (planeSize < originalSize) {
if (originalSize > planeSize) {
nsc_rle_decode(rle, context->priv->PlaneBuffers[i], planeSize);
FillMemory(context->priv->PlaneBuffers[i] + planeSize, 
originalSize - planeSize, 0xFF);
}
else {
nsc_rle_decode(rle, context->priv->PlaneBuffers[i], originalSize);
}
}
else {
CopyMemory(context->priv->PlaneBuffers[i], rle, originalSize);
}
rle += planeSize;
}
}",284,-23.254192498408386,-0.08188095950143798
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if ( originalSize > sizeof(context -> priv -> PlaneBuffers [ i ]) ) return; nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else { if ( planeSize > sizeof(context -> priv -> PlaneBuffers [ i ]) ) return; CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; } rle += planeSize ; } }",232,-15.137469064479122,-0.0652477114848238
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; // Restrict the length of the memory copy operation FillMemory ( context -> priv -> PlaneBuffers [ i ] + planeSize, originalSize - planeSize, 0xFF ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",236,-30.466178839632246,-0.12909397813403495
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; else if ( planeSize > originalSize ) { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; FillMemory(context->priv->PlaneBuffers[i]+originalSize, planeSize - originalSize, 0xFF); } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",247,-14.535812607791996,-0.0588494437562429
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; else { if(planeSize >= originalSize) CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; else { //Error handling code goes here } } rle += planeSize ; } }",207,-23.510533781659397,-0.11357745788241255
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if (planeSize < originalSize) { // Added check to prevent out-of-bounds write nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , planeSize ) ; // Changed size of copy to planeSize } rle += planeSize ; } }",221,-29.90443215727185,-0.1353141726573387
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","

static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) { FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; } else if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else { if ( planeSize == originalSize ) { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; } else { int size = ( originalSize < planeSize ) ? originalSize : planeSize ; CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , size ) ; }  } rle += planeSize ; } }",246,-29.610833256455365,-0.12036924087989986
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; FillMemory ( context -> priv -> PlaneBuffers [ i ] + planeSize , originalSize - planeSize , 0xFF ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",218,-4.614324685507447,-0.021166626997740582
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if ( planeSize > ( originalSize - planeSize ) ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else { // handle error condition. return ; } } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",215,-30.373324113512698,-0.14127127494657069
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if(originalSize > 0) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",197,-8.6622772348758,-0.04397095043084163
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; FillMemory ( context -> priv -> PlaneBuffers [ i ] + planeSize , originalSize - planeSize , 0 ) ; } else { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } } else { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; } rle += planeSize ; } }",258,-13.984962434826599,-0.05420528075514186
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if (originalSize >= planeSize) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } else { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; FillMemory ( context -> priv -> PlaneBuffers [ i ] + planeSize , originalSize - planeSize , 0xFF ) ; } } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",258,-13.642216668545503,-0.05287680879281203
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if ( planeSize <= originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",221,-7.207513142775601,-0.03261318164151856
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if (planeSize < originalSize) { size_t sizeToCopy = min(planeSize, originalSize); nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , sizeToCopy ) ; if (originalSize > planeSize) memset(context->priv->PlaneBuffers[i] + sizeToCopy, 0, originalSize - sizeToCopy); } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",251,-20.074256738800695,-0.07997711848127767
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; memset(&context->priv->PlaneBuffers[i][planeSize], 0xFF, originalSize - planeSize) ; } else { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; } rle += planeSize ; } }",220,-13.491491118679553,-0.06132495963036161
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , planeSize ) ; FillMemory (context->priv->PlaneBuffers[i] + planeSize, originalSize - planeSize, 0xFF) ; } else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }",227,-10.463295813198503,-0.04609381415505948
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; UINT32 minSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; minSize = min(planeSize, originalSize); if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , minSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , minSize ) ; rle += planeSize ; } }",205,-8.492342689170004,-0.04142606189839026
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; else CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; rle += planeSize ; } }
Fixed code:","
static void nsc_rle_decompress_data ( NSC_CONTEXT * context ) { UINT16 i ; BYTE * rle ; UINT32 planeSize ; UINT32 originalSize ; rle = context -> Planes ; for ( i = 0 ; i < 4 ; i ++ ) { originalSize = context -> OrgByteCount [ i ] ; planeSize = context -> PlaneByteCount [ i ] ; if ( planeSize == 0 ) FillMemory ( context -> priv -> PlaneBuffers [ i ] , originalSize , 0xFF ) ; else if ( planeSize < originalSize ) { if (originalSize > 0) { nsc_rle_decode ( rle , context -> priv -> PlaneBuffers [ i ] , originalSize ) ; } } else { if (planeSize > 0) { CopyMemory ( context -> priv -> PlaneBuffers [ i ] , rle , originalSize ) ; } } rle += planeSize ; } }",210,-9.082661971356197,-0.04325077129217237
