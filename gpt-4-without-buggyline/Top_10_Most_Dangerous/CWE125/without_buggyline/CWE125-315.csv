Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { 
	if (length > 5) {
		const uint16_t * ptr = ( const uint16_t * ) dat ; 
		ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; 
		ptr ++ ; 
		ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; 
		ptr ++ ; 
		ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; 
		ND_PRINT ( ( ndo , "" "" ) ) ; 
		print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; 
	}
}",253,-9.606576705208402,-0.0379706589138672
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:"," 
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { 
  const uint16_t * ptr = ( const uint16_t * ) dat ; 
  if (length > 4) {
    ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; 
    ptr ++ ; 
    ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; 
    ptr ++ ; 
    ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ;
    if ( length > 5 ) {
      ND_PRINT ( ( ndo , "" "" ) ) ; 
      print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; 
    }
  }
}",257,-18.315806795566594,-0.071267730722049
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length < 5) 
    return; 
ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",228,-9.30438986335183,-0.040808727470841355
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:"," 
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length > 5) { ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",216,-7.62804960143449,-0.0353150444510856
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length < 5) { return; } ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",225,-3.8091297364472796,-0.016929465495321244
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length >= 5) { ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } } }",223,-3.3832247615616393,-0.015171411486823494
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if(length >= 5){ ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } } }",222,-6.141722822511777,-0.027665418119422417
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length >= 5) { ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } } else { ND_PRINT(ndo, ""Error: Packet length is less than 5 bytes""); } }",246,-15.894707591847638,-0.06461263248718552
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { 
  if (length < 5) {
    return;
  }
  const uint16_t * ptr = ( const uint16_t * ) dat ; 
  ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; 
  ptr ++ ; 
  ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; 
  ptr ++ ; 
  ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; 
  if ( length > 5 ) { 
    ND_PRINT ( ( ndo , "" "" ) ) ; 
    print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; 
  } 
}",263,-7.839725938022897,-0.029808843870809495
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length < 5) { ND_PRINT ( ( ndo , ""Short L2TP packet (%u bytes)!"" , length ) ) ; return ; } ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",250,-19.83953411933315,-0.0793581364773326
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; if (length >= 5) { ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ) ) ) ) ; ptr++; ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",216,-14.48954738346078,-0.0670812378863925
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if ( length >= 5 ) { ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } } }",223,-4.310448486194739,-0.019329365408945018
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length < 5) return; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",223,-4.069804145953543,-0.01825024280696656
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length >= 5) { ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } } else { ND_PRINT ( ( ndo , ""[Invalid Length: %u] "", length )) ; } }",246,-20.808455220397644,-0.08458721634307985
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if ( length > 4 ) { ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } } }",223,-7.335219069869542,-0.03289335905771095
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; if ( length >= 5 ) { ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } } }",223,-7.460713604691777,-0.03345611481924564
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length < 5) { return; } ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",225,-3.8415493700303016,-0.017073552755690228
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length < 5) { return; } ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",225,-3.8415493700303016,-0.017073552755690228
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if ( length > 5 ) { ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",215,-4.821318650905602,-0.022424737911188847
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length < 6) { /* Prevent out-of-bounds read */ return; } ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",235,-14.760029544012639,-0.06280863635750059
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { if ( length < 5 ) { ND_PRINT ( ( ndo , "" [length %u < 5]"" , length ) ) ; return ; } const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",247,-14.4907731165655,-0.058667097637917
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { if (length < 5) { return; } const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",225,-4.6942624801346025,-0.020863388800598234
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { 
  if (length < 5)  
    return;

  const uint16_t * ptr = ( const uint16_t * ) dat ; 
  ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; 
  ptr ++ ; 
  ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; 
  ptr ++ ; 
  ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; 
  if ( length > 5 ) { 
    ND_PRINT ( ( ndo , "" "" ) ) ; 
    print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; 
  } 
}",260,-15.23515251339271,-0.05859674043612581
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if(length < 5) return; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",223,-6.571186942259581,-0.02946720601910126
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length > 5) { ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ;  ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",216,-7.050593194322499,-0.03264163515890046
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; u_int direction = *(const u_char *)ptr; if (direction < MAX_DIRECTION) { ND_PRINT ((ndo, ""%s"", tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , direction))) } if (length > 5) { ND_PRINT((ndo, "" "")); print_string (ndo, (const u_char *) ptr, length - 5); } }",220,-42.52442068193378,-0.1932928212815172
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length < 5) { ND_PRINT ( ( ndo , ""Incorrect message length!\n"") ); return ; } ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",244,-24.373985759783462,-0.09989338426140763
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { 
  if (length < 5) {
    return;
  }

  const uint16_t * ptr = ( const uint16_t * ) dat ; 
  ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; 
  ptr ++ ; 
  ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; 
  ptr ++ ; 
  ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; 
  if ( length > 5 ) { 
    ND_PRINT ( ( ndo , "" "" ) ) ; 
    print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; 
  } 
}",263,-8.83633436198951,-0.033598229513268095
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","

static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { 
  const uint16_t * ptr = ( const uint16_t * ) dat ; 
  if (length >= 5) { 
    ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; 
    ptr ++ ; 
    ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; 
    ptr ++ ; 
    ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; 
    if ( length > 5 ) { 
      ND_PRINT ( ( ndo , "" "" ) ) ; 
      print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; 
    } 
  }
}",261,-9.449116083127317,-0.03620350989703953
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; if (length > 5) { ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",215,-4.896442756647883,-0.022774152356501782
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","

static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length < 5) { ND_PRINT ( ( ndo , ""Bad packet length: %u"" , length) ); return; } ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",247,-18.87854158067272,-0.07643134243187337
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { if ( length < 5 ) { return ; } const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",225,-7.181210208271133,-0.03191648981453837
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","

static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { 
  const uint16_t * ptr = ( const uint16_t * ) dat ; 
  if (length >= 5 && EXTRACT_16BITS(ptr) < length) {
    ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; 
    ptr ++ ; 
    ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; 
    ptr ++ ; 
    ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; 
    if ( length > 5 ) { 
      ND_PRINT ( ( ndo , "" "" ) ) ; 
      print_string ( ndo , ( const u_char * ) ptr , (length > EXTRACT_16BITS(ptr)) ? (EXTRACT_16BITS(ptr) - 5) : (length - 5) ) ; 
    }
  }
}",303,-30.282717524699443,-0.09994296212772093
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; if (length >= 2) { ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; } if (length >= 3) { ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; } if (length > 5) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",231,-10.857032719746291,-0.04700014164392334
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; u_int len = length - 5; if (len > 0) { ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , len ) ; } }",222,-11.958508024510753,-0.05386715326356195
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { 
  const uint16_t * ptr = ( const uint16_t * ) dat ; 
  if (length >= 5) {
    ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ;
    ptr ++ ;
    ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ;
    ptr ++ ;
    ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; 
    if ( length > 5 ) { 
      ND_PRINT ( ( ndo , "" "" ) ) ; 
      print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; 
    } 
  }
}",255,-12.741222604566502,-0.049965578841437264
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if ( length >= 5) { ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } } else { ND_PRINT ( ( ndo , ""[length %u too short] "" , length ) ) ; } }",248,-14.281487482959607,-0.05758664307645003
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; if ( length > 5 ) { ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",215,-6.255496368564284,-0.02909533194681062
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length < 6) { return; } ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",225,-6.938375109145702,-0.030837222707314232
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; if (length >= 5) { ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } } else { ND_PRINT ( ( ndo , ""[Error: Invalid Length] "" ) ) ; } }",245,-17.467977999955277,-0.07129786938757256
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length < 5) { return; } ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",225,-3.80348930433904,-0.01690439690817351
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { 
   const uint16_t * ptr = ( const uint16_t * ) dat ; 
   if(length>4){
      ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; 
      ptr ++ ; 
      if(length>5){
         ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; 
         ptr ++ ; 
         if ( length > 5 ) {
            ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; 
            ND_PRINT ( ( ndo , "" "" ) ) ; 
            if(length>6){
               print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; 
            }
         }
      }
   }
}",278,-30.997883353760365,-0.11150317753151211
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { if(length <5) { return; } const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",225,-12.667781610411398,-0.05630125160182843
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { 
  const uint16_t * ptr = ( const uint16_t * ) dat ; 
  if (length >= 5) {
    ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; 
    ptr ++ ; 
    ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; 
    ptr ++ ; 
    ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; 
    if ( length > 5 ) { 
      ND_PRINT ( ( ndo , "" "" ) ) ; 
      print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; 
    } 
  }
}",259,-7.1007808310953,-0.027416142205001156
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { 
  const uint16_t * ptr = ( const uint16_t * ) dat ; 
  if (length >= 5) { 
    ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; 
    ptr ++ ; 
    ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; 
    ptr ++ ; 
    ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; 
    if ( length > 5 ) { 
      ND_PRINT ( ( ndo , "" "" ) ) ; 
      print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; 
    } 
  } 
}",261,-9.95400711202194,-0.03813795828360897
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if ( length > 5 ) { ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",215,-4.660325299618443,-0.021675931626132294
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; if (length >= 5) { ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } } }",223,-3.3320201796863,-0.014941794527741257
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; if (length > 5) { ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }",215,-4.8137372119612385,-0.022389475404470876
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { if (length <= 5) { return; } const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; }",217,-7.606949288647137,-0.035055065846300165
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; if ( length > 5 ) { ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ; } }
Fixed code:","
static void l2tp_ppp_discon_cc_print ( netdissect_options * ndo , const u_char * dat , u_int length ) { const uint16_t * ptr = ( const uint16_t * ) dat ; ND_PRINT ( ( ndo , ""%04x, "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; ND_PRINT ( ( ndo , ""%04x "" , EXTRACT_16BITS ( ptr ) ) ) ; ptr ++ ; if ( length > 5 ) {  ND_PRINT ( ( ndo , ""%s"" , tok2str ( l2tp_cc_direction2str , ""Direction-#%u"" , * ( ( const u_char * ) ptr ++ ) ) ) ) ; ND_PRINT ( ( ndo , "" "" ) ) ; print_string ( ndo , ( const u_char * ) ptr , length - 5 ) ;} else { ND_PRINT( (ndo, ""Direction-#%u"", *((const u_char *) ptr++))); } }",247,-27.88707477777157,-0.11290313675211162
