Original code,Plausible Program,Number of Bugs Present,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if ( out < ( in - 1 ) ) { * out ++ = value ; left -- ; } <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if ( len <= left ) { FillMemory ( out , len , value ) ; out += len ; left -= len ; }<EndBug> } else { <StartBug> if ( out < ( in - 1 ) ) { * out ++ = value ; left -- ; } <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,258,-23.02303279792806,-0.0892365612322793
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; left -- ; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len = min(len + 2, left); <StartBug> FillMemory ( out , len , value ) ; out += len ; left -= len ; <EndBug> } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; len = min(len, left); <StartBug> FillMemory ( out , len , value ) ; out += len ; left -= len ; <EndBug> } } else { <StartBug> * out ++ = value ; left -- ; <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,266,-9.005338002240094,-0.03385465414375975
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out + 1 < in) { * out ++ = value ; <EndBug> left -- ; } } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (out + len < in) { FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> if (out + 1 < in) { * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,254,-17.479085596993645,-0.06881529762595923
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:"," 
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; left -- ; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (len > left) { len = left; } FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; left -- ; <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,239,-7.369566641686404,-0.03083500686898077
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (value < left) { * out ++ = value ; }  <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (len <= left) { FillMemory ( out , len , value ) ;  out += len ; left -= len ; } <EndBug> } else { <StartBug> if (value < left) { * out ++ = value ; }  <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,253,-19.610494372753003,-0.07751183546542689
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","

<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out - originalSize >= 0) {* out ++ = value ;} <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if ((out + len) - originalSize <= 0) { FillMemory ( out , len , value ) ;} <EndBug> out += len ; left -= len ; } else { <StartBug> if (out - originalSize >= 0) {* out ++ = value ;} <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,261,-18.69858519996008,-0.07164208888873594
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:"," 
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> memcpy(out, &value, min(left, sizeof(BYTE))); out++; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> memcpy(out, &value, min(len, left)); out+= len; <EndBug> left -= len ; } else { <StartBug> memcpy(out, &value, min(left, sizeof(BYTE))); out++; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,262,-22.43282046381471,-0.08562145215196454
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out < (out + left)) 
* out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if ((out + len) < (out + left)) 
FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> if (out < (out + left)) 
* out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,262,-15.34852200248279,-0.05858214504764424
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out + left <= originalSize) { * out ++ = value ; } <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (out + len <= originalSize) { FillMemory ( out , len , value ) ; } <EndBug> out += len ; left -= len ; } else { <StartBug> if (out + left <= originalSize) { * out ++ = value ; } <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,259,-7.018675025794398,-0.027099131373723544
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (left < len) { len = left; } FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,238,-8.966403114578599,-0.037673962666296634
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; if(out - originalSize + 1 > left) return; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if(out - originalSize + len > left) return; FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; if(out - originalSize + 1 > left) return; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,265,-14.968948694119906,-0.056486598845735495
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; left -- ; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (left >= len) { FillMemory ( out , len , value ) ; out += len ; left -= len ; } else { return; } <EndBug> } else { <StartBug> * out ++ = value ; left -- ; <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,239,-8.321237015449558,-0.03481689127803162
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; left -- ; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } if ( len > left ) { len = left ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; left -- ; <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,238,-10.062366114753994,-0.04227884922165544
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; left -- ; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; if (len > left){ len = left; } <StartBug> FillMemory ( out , len , value ) ; out += len ; left -= len ; <EndBug> } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; if (len > left){ len = left; } <StartBug> FillMemory ( out , len , value ) ; out += len ; left -= len ; <EndBug> } } else { <StartBug> * out ++ = value ; left -- ; <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,274,-9.542677478485492,-0.0348272900674653
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in && left > 4 ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if ( len <= left ) { FillMemory ( out , len , value ) ; } <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,238,-15.432302733633302,-0.06484160812450968
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:"," 
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; left --; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len = (len < left) ? len + 2 : left; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; len = (len < left) ? len : left; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; left --; <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,249,-12.656659379444509,-0.0508299573471667
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; left -- ; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len = min ( len + 2 , left ) ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; len = min ( len , left ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; left -- ; <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,242,-7.7324905964141415,-0.03195244048105017
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out + 1 <= out + originalSize) { * out ++ = value ; } <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (out + len <= out + originalSize) { FillMemory ( out , len , value ) ; } <EndBug> out += len ; left -= len ; } else { <StartBug> if (out + 1 <= out + originalSize) { * out ++ = value ; } <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,265,-7.8998371889093395,-0.02981070637324279
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (value <= left){ * out ++ = value ; } <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (len <= left){ FillMemory ( out , len , value ) ; out += len ; left -= len ; } <EndBug> } else { <StartBug> if (value <= left){ * out ++ = value ; } <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,247,-12.701209371602744,-0.051421900289889654
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:"," 
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out - left < out) { // Check for out-of-bounds *out++ = value; } <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (out + len < out) { // Check for out-of-bounds FillMemory ( out , len , value ) ; } <EndBug> out += len ; left -= len ; } else { <StartBug> if (out - left < out) { // Check for out-of-bounds *out++ = value; } <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,284,-22.537277904187714,-0.07935661233868914
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; left -- ; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; if ( len > left ) { <StartBug> len = left ; <EndBug> } <StartBug> FillMemory ( out , len , value ) ; out += len ; left -= len ; <EndBug> } else { <StartBug> * out ++ = value ; left -- ; <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,245,-10.247767580663638,-0.04182762277821893
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:"," 
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; left -- ; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (len > left) // Added line to prevent out-of-bounds write { len = left; // Added line to prevent out-of-bounds write } FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; left -- ; <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,263,-21.814491787231088,-0.08294483569289388
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out - in >= 0) { * out ++ = value ; } <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (out - in >= 0) { FillMemory ( out , len , value ) ; } <EndBug> out += len ; left -= len ; } else { <StartBug> if (out - in >= 0) { * out ++ = value ; } <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,256,-12.541372802014738,-0.04898973750787007
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out + 1 < (out + originalSize)) { * out ++ = value ; } <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (out + len < (out + originalSize)) { FillMemory ( out , len , value ) ; } <EndBug> out += len ; left -= len ; } else { <StartBug> if (out + 1 < (out + originalSize)) { * out ++ = value ; } <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,268,-8.788592980730035,-0.03279325739078372
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; if(left > 0) { left -- ; } <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; if(left > len+2) { len += 2 ; } else { len = left; } } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; if(left > len) { } else { len = left; } } <StartBug> FillMemory ( out , len , value ) ; if(left > len) { out += len ; left -= len ; } else { out += left; left = 0; } <EndBug> } else { <StartBug> * out ++ = value ; if(left > 0) { left -- ; } <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,293,-24.41617622124492,-0.08333165945817379
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out - originalSize > left) { //Check if it will go out of bounds return; } * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if ( out - originalSize + len > left) { //Check if it will go out of bounds return; } FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> if (out - originalSize > left) { //Check if it will go out of bounds return; } * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,294,-35.088105699146965,-0.11934729829641824
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if ( out + 1 < in ) { * out ++ = value ; } <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if ( out + len < in ) { FillMemory ( out , len , value ) ; } <EndBug> out += len ; left -= len ; } else { <StartBug> if ( out + 1 < in ) { * out ++ = value ; } <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,256,-9.565922120891234,-0.03736688328473138
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out + 1 < out + originalSize) { * out ++ = value ; } <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (out + len < out + originalSize) { FillMemory ( out , len , value ) ; } <EndBug> out += len ; left -= len ; } else { <StartBug> if (out + 1 < out + originalSize) { * out ++ = value ; } <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,265,-8.636169041808886,-0.03258931713890146
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out + 1 < out + originalSize){  * out ++ = value ; } <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (out + len < out + originalSize){ FillMemory ( out , len , value ) ; } <EndBug> out += len ; left -= len ; } else { <StartBug> if (out + 1 < out + originalSize){ * out ++ = value ; } <EndBug> left -- ; } } <StartBug> if (out + 4 < out + originalSize){ * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; } <EndBug> }",4,283,-18.771117462462662,-0.06632903696983272
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; left -- ; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len = (len > left) ? left : len; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; len = (len > left) ? left : len; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,250,-11.792886445800846,-0.047171545783203386
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len = min(len + 2, left); } else { in ++ ; len = * ( ( UINT32 * ) in ) ; len = min(len, left); in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,240,-9.023224330123735,-0.03759676804218223
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; left--; if ( left == 4 ) { <StartBug> * out ++ = value ; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (left < len) break; // prevent out of bounds write FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,237,-28.976985935431742,-0.12226576344064026
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> left--; if (left >= 0) *out++ = value; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (left >= len) { FillMemory ( out , len , value ) ; out += len ; left -= len ; } <EndBug> else { break; } } else { <StartBug> left--; if (left >= 0) *out++ = value; <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,251,-19.611892342702088,-0.07813502925379318
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { * out ++ = value ; left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; if (len > left) { len = left; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { * out ++ = value ; left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,221,-8.424296204605708,-0.038118987351157055
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; left -- ; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if ( left < len ) { len = left; } FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; left -- ; <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,238,-8.256484956813404,-0.034691113263921866
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; left -- ; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; if ( len > left ) { len = left ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; if ( len > left ) { len = left ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } } else { <StartBug> * out ++ = value ; left -- ; <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,276,-9.3771755685084,-0.03397527379894348
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if(out < (out + left)){ * out ++ = value ; } <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if(out < (out + left)){ FillMemory ( out , len , value ) ; } <EndBug> out += len ; left -= len ; } else { <StartBug> if(out < (out + left)){ * out ++ = value ; } <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,259,-10.1198615620854,-0.039072824564036296
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out - left < 0 || out + left > originalSize) { return; } * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (out - len < 0 || out + len > originalSize) { return; } FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> if (out - 1 < 0 || out + 1 > originalSize) { return; } * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,283,-16.7136991821625,-0.05905900771082156
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> out [ 0 ] = value ; out += 1 ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> memset ( out , ( int ) value , ( size_t ) len ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> out [ 0 ] = value ; out += 1 ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,244,-14.916447127160236,-0.06113298002934523
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { * out ++ = value ; left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; UINT32 tmp = * ( ( UINT32 * ) in ) ; if ((tmp + 4) < left) len = tmp ; else len = left - 4; in += 4 ; } FillMemory ( out , len , value ) ; out += len ; left -= len ; } else { * out ++ = value ; left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,225,-32.54595237928309,-0.14464867724125816
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 0 ) { value = * in ++ ; if ( left == 1 ) { <StartBug> * out++ = value; <EndBug> left--; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (len > left) {len = left;} FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,237,-18.7423116664558,-0.07908148382470802
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out < out + originalSize - 1) { * out ++ = value ; } <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (out + len < out + originalSize) { FillMemory ( out , len , value ) ; } <EndBug> out += len ; left -= len ; } else { <StartBug> if (out < out + originalSize - 1) { * out ++ = value ; } <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,265,-13.22823164681,-0.04991785527098113
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; left --; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if(len > left){ len = left; } FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; left--; <EndBug> } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,237,-11.157390495412807,-0.04707759702705826
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (left < 0xFF) { * out ++ = value ; left -- ; } else { /* Discard the value and move on */ } <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (len > left) { len = left ; } FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,260,-33.0787796344139,-0.12722607551697654
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; 
if ( left == 5 ) { * out ++ = value ; left -- ; 
} else if ( value == * in ) { in ++ ; 
if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; 
} else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } 
if(left<len){ len=left; } 
FillMemory ( out , len , value ) ; 
out += len ; left -= len ; 
} else { * out ++ = value ; left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,229,-30.390244784083794,-0.13270849250691613
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug>  if (out + left <= originalSize) { * out ++ = value ; } <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (out + len <= originalSize) { FillMemory ( out , len , value ) ; } <EndBug> out += len ; left -= len ; } else { <StartBug> if (out + left <= originalSize) { * out ++ = value ; } <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,260,-13.077829949471795,-0.05029934595950691
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:"," 
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out - originalSize >= 0) * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (out + len - originalSize <= 0) FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> if (out - originalSize >= 0) * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,256,-11.441617242681005,-0.044693817354222676
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out - originalSize < 0) return; * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> if (out - originalSize + len > originalSize) return; FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> if (out - originalSize < 0) return; * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,262,-11.444843105393538,-0.04368260727249442
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> if (out + 1 < out + left) { * out ++ = value ; } <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> while (len > 0 && out + 1 < out + left) { * out ++ = value ; len-- ; } <EndBug> out += len ; left -= len ; } else { <StartBug> if (out + 1 < out + left) { * out ++ = value ; } <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,265,-19.520171749006582,-0.07366102546794936
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; <EndBug> left -- ; } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }
Fixed code:","
<StartBug> static void nsc_rle_decode ( BYTE * in , BYTE * out , UINT32 originalSize ) <EndBug> { UINT32 len ; UINT32 left ; BYTE value ; left = originalSize ; while ( left > 4 ) { value = * in ++ ; if ( left == 5 ) { <StartBug> * out ++ = value ; left -- ; <EndBug> } else if ( value == * in ) { in ++ ; if ( * in < 0xFF ) { len = ( UINT32 ) * in ++ ; if ( len > left ) { len = left - 2; } len += 2 ; } else { in ++ ; len = * ( ( UINT32 * ) in ) ; if ( len > left ) { len = left - 4; } in += 4 ; } <StartBug> FillMemory ( out , len , value ) ; <EndBug> out += len ; left -= len ; } else { <StartBug> * out ++ = value ; <EndBug> left -- ; } } * ( ( UINT32 * ) out ) = * ( ( UINT32 * ) in ) ; }",4,254,-13.67876191250661,-0.05385339335632524
