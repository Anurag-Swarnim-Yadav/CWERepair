Unnamed: 0,cwe_id,source,target,project_and_commit_id,cve_id,original_address,time,raw_predictions,correctly_predicted
856,CWE-79,"static int oidc_handle_session_management_iframe_rp ( request_rec * r , oidc_cfg * c , oidc_session_t * session , const char * client_id , const char * check_session_iframe ) { oidc_debug ( r , ""enter"" ) ; const char * java_script = ""    <script type=\\""text/javascript\\"">\\n"" ""      var targetOrigin  = \'%s\';\\n"" ""      var message = \'%s\' + \' \' + \'%s\';\\n"" ""\t   var timerID;\\n"" ""\\n"" ""      function checkSession() {\\n"" ""        console.debug(\'checkSession: posting \' + message + \' to \' + targetOrigin);\\n"" ""        var win = window.parent.document.getElementById(\'%s\').contentWindow;\\n"" ""        win.postMessage( message, targetOrigin);\\n"" ""      }\\n"" ""\\n"" ""      function setTimer() {\\n"" ""        checkSession();\\n"" <StartBug> ""        timerID = setInterval(\'checkSession()\', %s);\\n"" <EndBug> ""      }\\n"" ""\\n"" ""      function receiveMessage(e) {\\n"" ""        console.debug(\'receiveMessage: \' + e.data + \' from \' + e.origin);\\n"" ""        if (e.origin !== targetOrigin ) {\\n"" ""          console.debug(\'receiveMessage: cross-site scripting attack?\');\\n"" ""          return;\\n"" ""        }\\n"" ""        if (e.data != \'unchanged\') {\\n"" ""          clearInterval(timerID);\\n"" ""          if (e.data == \'changed\') {\\n"" ""\t\t     window.location.href = \'%s?session=check\';\\n"" ""          } else {\\n"" ""\t\t     window.location.href = \'%s?session=logout\';\\n"" ""          }\\n"" ""        }\\n"" ""      }\\n"" ""\\n"" ""      window.addEventListener(\'message\', receiveMessage, false);\\n"" ""\\n"" ""    </script>\\n"" ; char * origin = apr_pstrdup ( r -> pool , check_session_iframe ) ; apr_uri_t uri ; apr_uri_parse ( r -> pool , check_session_iframe , & uri ) ; char * p = strstr ( origin , uri . path ) ; * p = '\\0' ; const char * op_iframe_id = ""openidc-op"" ; const char * session_state = oidc_session_get_session_state ( r , session ) ; if ( session_state == NULL ) { oidc_warn ( r , ""no session_state found in the session; the OP does probably not support session management!?"" ) ; return DONE ; } char * s_poll_interval = NULL ; oidc_util_get_request_parameter ( r , ""poll"" , & s_poll_interval ) ; <StartBug> if ( s_poll_interval == NULL ) <EndBug> s_poll_interval = ""3000"" ; const char * redirect_uri = oidc_get_redirect_uri ( r , c ) ; java_script = apr_psprintf ( r -> pool , java_script , origin , client_id , <StartBug> session_state , op_iframe_id , s_poll_interval , redirect_uri , <EndBug> redirect_uri ) ; return oidc_util_html_send ( r , NULL , java_script , ""setTimer"" , NULL , DONE ) ; }
","<S2SV_ModStart> ""\\n"" ""      function setTimer() {\\n"" ""        checkSession();\\n"" ""        timerID = setInterval(\'checkSession()\', %d);\\n"" <S2SV_ModEnd> ""      }\\n"" ""\\n"" ""      function receiveMessage(e) {\\n"" <S2SV_ModStart> s_poll_interval ) ; int poll_interval = s_poll_interval ? strtol ( s_poll_interval , NULL , 10 ) : 0 ; if ( ( poll_interval <= 0 ) || ( poll_interval > 3600 * 24 ) ) poll_interval = 3000 <S2SV_ModEnd> ; const char <S2SV_ModStart> , op_iframe_id , poll_interval <S2SV_ModEnd> , redirect_uri ,
",zmartzone@mod_auth_openidc/132a4111bf3791e76437619a66336dce2ce4c79b,CVE-2019-1010247,https://github.com/zmartzone/mod_auth_openidc/commit/132a4111bf3791e76437619a66336dce2ce4c79b,2019-07-19T15:15Z,"<S2SV_ModStart> "" var targetOrigin = \'%s\';\\n"" <S2SV_ModEnd> "" var win = window.parent.document.getElementById(\'%s\').contentWindow;\\n"" "" console.debug(\'checkSession\': posting \'+ message + \' from \'%s\');\\n"" "" var win = window.parent.document.getElementById(\'%s\').contentWindow;\\n"" "" var win = window.parent.document.getElementById(\'%s\').contentWindow;\\n"" "" console.debug(\'checkSession\': posting \'+ message + \' from \'%s\');\\n"" "" var win = window.parent.document.getElementById(\'%s\').contentWindow;\\n"" "" console.debug(\'checkSession\': posting \'+ message + \' from \'",0
