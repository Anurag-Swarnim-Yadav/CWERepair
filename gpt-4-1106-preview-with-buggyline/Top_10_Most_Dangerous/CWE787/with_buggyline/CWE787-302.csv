Original code,Plausible Program,Number of Bugs Present,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if (len > sizeof(int)) { return False; } while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",1,181,-9.600288853732524,-0.05304026991012444
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; if(len > sizeof(*length)) { * length = 0 ; } else { * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",1,194,-16.564869645549624,-0.08538592600798775
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tagval > 0xff && tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if ( len >= sizeof(int) ) { logger ( Core , Error , ""ber_parse_header(), length out of bounds"" ) ; return False ; } next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",1,218,-24.059482863502645,-0.11036460029129654
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; if (len < 0){ logger ( Core , Error , ""ber_parse_header(), length cannot be negative"" , tagval , tag ) ; return False ; } * length = 0 ; while ( len-- && (*length) >= 0) { next_be ( s , * length ) ; *length = (*length) + 1; }  } else * length = len ; return s_check ( s ) ; }",1,229,-43.90148208397553,-0.19170952875098485
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { next_be ( s , * length ) ; if (len == 0){ break; } } } else * length = len ; return s_check ( s ) ; }",1,187,-14.14892296861613,-0.07566268967174401
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if (len > 0) { while ( len -- ) next_be ( s , * length ) ; } else {*length = 0;}} else * length = len ; return s_check ( s ) ; }",1,182,-16.734671882001926,-0.09194874660440619
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if (len > 0) { // Added check to prevent out of bounds write while ( len -- ) next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",1,193,-13.077071977641332,-0.06775684962508462
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if ( len > 0 ) { if (len > sizeof(int)) { logger(Core, Error, ""ber_parse_header(), length is too big""); return False; } <StartBug>while ( len -- ) next_be ( s , * length ) ;<EndBug> } else * length = len ; return s_check ( s ) ; }",1,214,-25.038675759098624,-0.11700315775279731
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { <StartBug> int count = 0; len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if (count > 4) { logger(Core, Error, ""ber_parse_header(), maximum length exceeded""); return false; } next_be ( s , * length ) ; count++; } <EndBug> } else * length = len ; return s_check ( s ) ; }",1,213,-28.711257979555427,-0.13479463840166866
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; <StartBug>if ( len > 0x7f && len <= 0xff ) { * length = 0 ; while ( len -- ) { if (len >= 0) { next_be ( s , * length ) ; } else { logger ( Core , Error , ""ber_parse_header(), Out of bounds write."" ) ; return False ; } } } <EndBug>else { * length = len ; } return s_check ( s ) ; }",1,212,-42.427434803065616,-0.20012940944842272
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; <StartBug>if (len > 4) { return False; }<EndBug> * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",1,187,-7.924029540189634,-0.04237448951973066
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) {<StartBug>  if (len > 4) {  return False;  } <EndBug> len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { next_be ( s , * length ) ; } } <StartBug> else if (len == 0) { *length = 0; } else if (len > 4) { return False; } <EndBug> else * length = len ; return s_check ( s ) ; }",1,226,-43.79371131481004,-0.19377748369384973
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; <StartBug> if (len < 0 || len > 0x7F){ return False; } <EndBug> if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",1,193,-14.084475264101837,-0.07297655577254837
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- && s_check(s) ) { next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",1,185,-11.901843641271533,-0.0643342899528191
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { <StartBug>if (len > 4) {return False;}<EndBug> len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",1,186,-10.463351867075732,-0.056254579930514685
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- && len >= 0) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",1,180,-7.734751899459533,-0.042970843885886296
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; // <StartBug> if ( len > 4 ) { logger ( Core , Error , ""ber_parse_header(), length too long: %d"" , len ) ; return False ; } <EndBug> * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",1,220,-21.27064291047653,-0.09668474050216604
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; if ( tag > tagval) { return false; } } else { in_uint8 ( s , tag ) ; if ( tag > tagval) { return false; } } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; if (*length > 0xff) { return false; } } else * length = len ; return s_check ( s ) ; }",1,171,-23.37145007840674,-0.13667514665734934
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; <StartBug> if ( len > 0xFF ) { *length = len & 0xFF; } else { *length = len; } <EndBug> return s_check ( s ) ; }",1,148,-25.38649974902923,-0.17153040370965697
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { <StartBug> if (len > 0) { next_be ( s , * length ) ; } <EndBug> } } else * length = len ; return s_check ( s ) ; }",1,186,-9.675696019193028,-0.05201987107093026
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if (len > 0) {next_be ( s , * length ) ;} else {break;}} } else * length = len ; return s_check ( s ) ; }",1,190,-11.236560047684028,-0.05913978972465278
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:"," 
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { <StartBug> if(len <= 0x80){ logger( Core , Error , ""ber_parse_header(), invalid length of %d"" , len ) ; return False ; } len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { <StartBug> if (len > 0) { next_be ( s , * length ) ; } <EndBug> } <EndBug> } else * length = len ; return s_check ( s ) ; }",1,230,-44.65362007790299,-0.19414617425175215
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; <StartBug> if (len > 0) {</StartBug> if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) <StartBug> if (len > 0) {</StartBug> next_be ( s , * length ) ; <EndBug> }</EndBug> } else * length = len ; <EndBug> }</EndBug> return s_check ( s ) ; }",1,216,-15.192823220398429,-0.07033714453888161
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; if (len > 4) { return False; } * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; } 
The vulnerability has been fixed by adding an if statement that returns false if the len is greater than 4. This prevents the out-of-bounds write from occuring.",1,224,-32.96940410376584,-0.14718483974895463
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len - 1 ) { next_be ( s , * length ) ; len--; } } else * length = len ; return s_check ( s ) ; }",1,182,-12.075664923898232,-0.06634980727416612
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; <StartBug> if (len > 4) { return False; } <EndBug> * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",1,187,-6.753942839218327,-0.03611734138619426
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } <StartBug> in_uint16_be ( s , len ) ; if ( ( len & 0x8000 ) == 0x8000 ) { len &= ~ 0x8000 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; <EndBug> return s_check ( s ) ; }",1,184,-14.839018318358626,-0.08064683868673166
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; <StartBug>if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; // Added check to make sure that tagval is not greater than 0xff } else { in_uint8 ( s , tag ) ; }<EndBug> if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) <StartBug>if (len > 0){ next_be ( s , * length ); }<EndBug> } else * length = len ; return s_check ( s ) ; }",1,205,-38.91929162856574,-0.18985020306617434
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; <StartBug>if ( len & 0x80 ) { if (len>127) return False; len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else if (len>0) * length = len ;<EndBug> return s_check ( s ) ; }",1,191,-22.27466488767553,-0.11662128213442687
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- && len < 4 ) <StartBug> next_be ( s , * length ) ; <EndBug> } else * length = len ; return s_check ( s ) ; }",1,188,-14.219123605991733,-0.07563363620208369
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { <StartBug> len &= ~ 0x80 ; int tmp_length = 0 ; while ( len -- ) { if (len > 0) { next_be ( s , tmp_length ) ; * length += tmp_length ; } } <EndBug> } else * length = len ; return s_check ( s ) ; }",1,196,-20.69291761030252,-0.10557611025664551
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; int maxlen; 
if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; <StartBug> maxlen = s_remaining(s); 
if (len > maxlen) { logger ( Core , Error , ""ber_parse_header(), length %d exceeds remaining bytes %d"" , len , maxlen) ; return False; } <EndBug> if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",1,235,-36.1962476596917,-0.15402658578592213
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header(STREAM s , int tagval, int * length) {
    int tag, len;
    if (tagval > 0xff) {
      in_uint16_be(s, tag);
    }
    else {
      in_uint8(s, tag);
    }
    if (tag != tagval) {
      logger(Core, Error, ""ber_parse_header(), expected tag %d, got %d"", tagval, tag);
      return False;
    }
    in_uint8(s, len);
    if (len & 0x80) {
      len &= ~0x80;
      *length = 0;
      while (len--) {
        if (len > 0) {
          next_be(s, *length);
        }
        else {
          return False;
        }
      }
    }
    else {
      *length = len;
    }
    return s_check(s);
}",1,236,-33.60682834305132,-0.1424018150129293
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; int tmp_length = 0 ; while ( len -- ) {  if (len > 0) { next_be ( s , tmp_length ) ; } else { *length = tmp_length; } }  } else * length = len ; return s_check ( s ) ; }",1,201,-22.73404375893503,-0.11310469531808473
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len , last_len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; last_len = 0; while ( len -- ) { if(len > last_len){ next_be ( s , * length ) ; last_len++; } else { break; } } } else * length = len ; return s_check ( s ) ; }",1,206,-25.554505360864734,-0.12405099689740162
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; 
 if (len > sizeof(int)){
	return False;
 }
 * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",1,195,-19.559127541007122,-0.10030321815901089
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , <StartBug> ""ber_parse_header(), expected tag %"" PRId32 "", got %d"" <EndBug>, tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { <StartBug> if (len > 0 && len > *length) { <EndBug> next_be ( s , * length ) ; } } } else * length = len ; return s_check ( s ) ; }",1,201,-35.34565032546581,-0.17584900659435726
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if (len > 0) { next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",1,179,-9.01626831939453,-0.05037021407482978
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; <StartBug> if (len > 4) { return False; } <EndBug> * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",1,187,-6.8182853959578305,-0.03646141922972102
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; 
if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if (len > 0) { int i; for (i = 0; i < len; i++) next_be(s, *length); } } else * length = len ; return s_check ( s ) ; }",1,195,-20.61065222909643,-0.10569565245690478
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval || len < 0 ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if (len < 0) return False; next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",1,191,-13.342604656713235,-0.06985656888331536
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","

RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; <StartBug> if(len > 4) { 	logger(Core, Error, ""ber_parse_header(), length greater than 4 bytes""); 	return False; } <EndBug> * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",1,212,-22.508385059820295,-0.10617162764066176
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; if (len > 0) { * length = 0 ; while ( len -- ) { next_be ( s , * length ) ; } } else { * length = 0; }  } else * length = len ; return s_check ( s ) ; }",1,195,-13.03248355275964,-0.06683324898851098
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","

RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; <StartBug>if (len > 4){ return False; }<EndBug> * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",1,187,-11.818098320680392,-0.06319838674160637
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if ( len > 0 ) { next_be ( s , * length ) ; } else { break; } } } else * length = len ; return s_check ( s ) ; }",1,191,-9.33386545487513,-0.048868405522906444
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:"," 
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if (len > 0) { // ADDED LINE while ( len -- ) { // MODIFIED LINE next_be ( s , * length ) ; // MODIFIED LINE } // ADDED LINE } // ADDED LINE } else * length = len ; return s_check ( s ) ; }",1,207,-19.903449330034306,-0.09615192913060051
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; <StartBug> if (len > sizeof (int)) { return False; // prevent out-of-bounds write }<EndBug> while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",1,198,-25.669142681002228,-0.1296421347525365
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- && len > 0) { next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",1,182,-9.21176704729443,-0.0506141046554639
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; <StartBug>if (len > 0) {return False; }<EndBug> } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if (len > 0) {next_be ( s , * length ) ;} } } else { * length = len ; } return s_check ( s ) ; }",1,196,-27.362123501237438,-0.13960267092468082
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL <StartBug> ber_parse_header ( STREAM s , int tagval , int * length ) <EndBug> { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- && len < sizeof(int) ) { next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",1,185,-11.012770875345728,-0.05952849121808502
