Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { 
 if ( request == NULL || blockSize == 0 ) return ERROR_INVALID_PARAMETER ; 
 osAcquireMutex ( & request -> context -> mutex ) ; 
 
 if ( blockSize <= COAP_BLOCK_SIZE_16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; 
 else if ( blockSize <= COAP_BLOCK_SIZE_32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; 
 else if ( blockSize <= COAP_BLOCK_SIZE_64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; 
 else if ( blockSize <= COAP_BLOCK_SIZE_128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; 
 else if ( blockSize <= COAP_BLOCK_SIZE_256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; 
 else if ( blockSize <= COAP_BLOCK_SIZE_512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; 
 else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; 
 
 if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; 
 osReleaseMutex ( & request -> context -> mutex ) ; 
 return NO_ERROR ; 
}",375,-18.507060245890862,-0.049352160655708965
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","

error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { 
    if ( request == NULL ) return ERROR_INVALID_PARAMETER ; 
    osAcquireMutex ( & request -> context -> mutex ) ; 
    // Added lines to validate the input
    if ( blockSize != 16 && blockSize != 32 && blockSize != 64 && blockSize != 128 && blockSize != 256 && blockSize != 512 ) {
        osReleaseMutex ( & request -> context -> mutex ) ;
        return ERROR_INVALID_PARAMETER;
    }
    // End of added lines
    if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; 
    else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; 
    else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; 
    else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; 
    else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; 
    else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; 
    else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; 
    if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; 
    osReleaseMutex ( & request -> context -> mutex ) ; 
    return NO_ERROR ; 
}",415,-35.246764305777084,-0.08493196218259538
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; if ( blockSize < 16 || blockSize > COAP_BLOCK_SIZE_1024 ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",324,-11.38589462166634,-0.03514165006687142
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { 
if ( request == NULL || blockSize < 16 || blockSize > 1024) return ERROR_INVALID_PARAMETER ; 
osAcquireMutex ( & request -> context -> mutex ) ; 

if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; 
else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; 
else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; 
else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; 
else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; 
else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; 
else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; 

if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; 

osReleaseMutex ( & request -> context -> mutex ) ; 
return NO_ERROR ; 
}",331,-12.477238289832973,-0.03769558395719932
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL || blockSize < 16 || blockSize > 1024 ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",302,-4.614657431817363,-0.015280322621911799
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL || blockSize == 0 ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else if ( blockSize == 1024 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; else return ERROR_INVALID_PARAMETER ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",317,-5.660844878486508,-0.017857554821724003
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:"," 

error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { 
    if ( request == NULL || blockSize > 512 ) return ERROR_INVALID_PARAMETER ; 
    osAcquireMutex ( & request -> context -> mutex ) ; 
    if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; 
    else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; 
    else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; 
    else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; 
    else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; 
    else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; 
    else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; 
    if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; 
    osReleaseMutex ( & request -> context -> mutex ) ; 
    return NO_ERROR ; 
}",337,-11.558763581035315,-0.0342990017241404
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize >= 16 && blockSize <= 512 && blockSize % 16 == 0 ) { request -> rxBlockSzx = blockSize; } else { request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; } if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",171,-10.423054826023382,-0.06095353699428878
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 || blockSize == 32 || blockSize == 64 || blockSize == 128 || blockSize == 256 || blockSize == 512 ) { request -> rxBlockSzx = blockSize ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; } else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",182,-9.42648489829144,-0.051793873067535384
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 || blockSize == 32 || blockSize == 64 || blockSize == 128 || blockSize == 256 || blockSize == 512 || blockSize == 1024 ) { request -> rxBlockSzx = blockSize ; } else { request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; } if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",189,-8.656557132910093,-0.045801889592116896
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize(CoapClientRequest *request, uint_t blockSize) {
    
    if (request == NULL || blockSize == 0) {
        return ERROR_INVALID_PARAMETER;
    }

    osAcquireMutex(&request->context->mutex);
    if (blockSize >= 16 && blockSize <= 1024 && blockSize % 16 == 0) {
        request->rxBlockSzx = blockSize;
    }
    else {
        request->rxBlockSzx = COAP_BLOCK_SIZE_1024;
    }
    if (request->rxBlockSzx > coapClientGetMaxBlockSize()) {
        request->rxBlockSzx = coapClientGetMaxBlockSize();
    }
    osReleaseMutex(&request->context->mutex);
    return NO_ERROR;
}",201,-26.361606589281198,-0.13115227158846368
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize >= 16 && blockSize <= 512 && blockSize % 16 == 0 ) { request -> rxBlockSzx = blockSize ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; } else { request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; } osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",171,-7.1415917032742815,-0.04176369417119463
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; if ( blockSize < 16 || blockSize > 512 ) { return ERROR_INVALID_PARAMETER; } osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",318,-9.581843121141127,-0.030131582141953227
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) {
 if ( request == NULL || (blockSize != 16 && blockSize != 32 && blockSize != 64 && blockSize != 128 && blockSize != 256 && blockSize != 512 && blockSize != 1024)) {
     return ERROR_INVALID_PARAMETER;
 }
 osAcquireMutex ( & request -> context -> mutex ) ; 
 if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ;
 if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; 
 osReleaseMutex ( & request -> context -> mutex ) ; 
 return NO_ERROR ; 
}",344,-20.012268992547337,-0.05817520055973063
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize >= 16 && blockSize <= 512 ) { if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; } else { request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; } osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",301,-10.259621865281039,-0.03408512247601674
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) {
 if ( request == NULL || blockSize < 16 || blockSize > 512 || blockSize % 16 != 0 ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; 
 if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; 
if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",314,-18.237245302927178,-0.05808039905390821
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:"," 

error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) {
     // Check for valid parameters
     if ( request == NULL ) {
          return ERROR_INVALID_PARAMETER ;
     }
     // Acquire mutex
     osAcquireMutex ( & request -> context -> mutex ) ;
     // Validate block size
     if ( blockSize > 0 && blockSize <= 512 ) {
          if ( blockSize == 16 ) {
               request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ;
          } else if ( blockSize == 32 ) {
               request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ;
          } else if ( blockSize == 64 ) {
               request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ;
          } else if ( blockSize == 128 ) {
               request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ;
          } else if ( blockSize == 256 ) {
               request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ;
          } else if ( blockSize == 512 ) {
               request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ;
          }
     } else {
          request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ;
     }
     // Check if the block size is greater than the maximum size
     if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) {
          request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ;
     }
     // Release the mutex
     osReleaseMutex ( & request -> context -> mutex ) ;
     
     return NO_ERROR ;
}",423,-53.56230012125354,-0.12662482298168687
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) {
    if ( request == NULL ) return ERROR_INVALID_PARAMETER ; 
    osAcquireMutex ( & request -> context -> mutex ) ;
    if (blockSize >= 16 && blockSize <= 512) {
        switch (blockSize) {
            case 16:
                request->rxBlockSzx = COAP_BLOCK_SIZE_16;
                break;
            case 32:
                request->rxBlockSzx = COAP_BLOCK_SIZE_32;
                break;
            case 64:
                request->rxBlockSzx = COAP_BLOCK_SIZE_64;
                break;
            case 128:
                request->rxBlockSzx = COAP_BLOCK_SIZE_128;
                break;
            case 256:
                request->rxBlockSzx = COAP_BLOCK_SIZE_256;
                break;
            case 512:
                request->rxBlockSzx = COAP_BLOCK_SIZE_512;
                break;
            default:
                request->rxBlockSzx = COAP_BLOCK_SIZE_1024;
        }
    } else {
        request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ;
    }
    if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) )
        request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; 
    osReleaseMutex ( & request -> context -> mutex ) ;
    return NO_ERROR ;
}",378,-31.92857672150172,-0.08446713418386699
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize >= 16 && blockSize <= 512 ) { request -> rxBlockSzx = blockSize ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ;  } else { request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ;  } osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",166,-16.020788168950826,-0.09651077210211341
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize >= 16 && blockSize <= 1024 && blockSize % 16 == 0 ) { request -> rxBlockSzx = blockSize ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; } else { request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; } osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",171,-6.706853853983953,-0.03922136756715762
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL || blockSize == 0 || blockSize > 512 ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",276,-8.191031515495897,-0.029677650418463396
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL || blockSize == 0 ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else if ( blockSize == 1024 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; else return ERROR_INVALID_PARAMETER ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",317,-5.622368274602754,-0.017736177522406162
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize >= 16 && blockSize <= 1024 && blockSize % 16 == 0 ){ request -> rxBlockSzx = blockSize ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; } else { request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; } osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",171,-9.691052642333654,-0.05667282246978745
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) {
 if ( request == NULL ) return ERROR_INVALID_PARAMETER ;
 if ( blockSize != 16 && blockSize != 32 && blockSize != 64 && blockSize != 128 &&
     blockSize != 256 && blockSize != 512 && blockSize != 1024) {
      return ERROR_INVALID_PARAMETER; 
 }
 osAcquireMutex ( & request -> context -> mutex ) ;
 if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ;
 else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ;
 else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ;
 else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ;
 else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ;
 else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ;
 else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ;
 if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ;
 osReleaseMutex ( & request -> context -> mutex ) ;
 return NO_ERROR ; 
}",364,-25.38880307995687,-0.06974945901087051
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) {
if ( request == NULL || blockSize > 512 ){
return ERROR_INVALID_PARAMETER ;
}
osAcquireMutex ( & request -> context -> mutex ) ;
switch (blockSize) {
case 16:
request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ;
break;
case 32:
request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ;
break;
case 64:
request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ;
break;
case 128:
request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ;
break;
case 256:
request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ;
break;
case 512:
request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ;
break;
default:
request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ;
break;
}
if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) {
request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ;
}
osReleaseMutex ( & request -> context -> mutex ) ;
return NO_ERROR ;
}",327,-23.948172307577995,-0.07323600094060549
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:"," 
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) {
    if ( request == NULL || blockSize > 512 ) return ERROR_INVALID_PARAMETER ;
    
    osAcquireMutex ( & request -> context -> mutex ) ;
    if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ;
    else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ;
    else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ;
    else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ;
    else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ;
    else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ;
    else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ;
    if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ;
    osReleaseMutex ( & request -> context -> mutex ) ;
    return NO_ERROR ;
}",325,-15.343674163757559,-0.047211305119254025
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { 
if ( request == NULL ) return ERROR_INVALID_PARAMETER ; 
osAcquireMutex ( & request -> context -> mutex ) ; 
if ( blockSize == 16 || blockSize == 32 || blockSize == 64 || blockSize == 128 || blockSize == 256 || blockSize == 512 ) {
  request -> rxBlockSzx = blockSize;
} else {
  request -> rxBlockSzx = COAP_BLOCK_SIZE_1024;
}
if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; 
osReleaseMutex ( & request -> context -> mutex ) ; 
return NO_ERROR ; 
}",203,-14.679460750614506,-0.07231261453504682
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize >= 16 && blockSize <= 1024 && blockSize % 16 == 0) { // check that the block size is within the valid range request -> rxBlockSzx = blockSize ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; } else { // set the block size to the default request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; } osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",190,-28.516091558358077,-0.15008469241241093
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { 
    if ( request == NULL ) return ERROR_INVALID_PARAMETER ;

    if ( blockSize < 16 || blockSize > 512) {
        return ERROR_INVALID_PARAMETER;
    }

    osAcquireMutex ( & request -> context -> mutex ) ; 
    if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; 
    else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; 
    else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; 
    else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; 
    else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; 
    else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; 
    else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; 
    if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; 
    osReleaseMutex ( & request -> context -> mutex ) ; 
    return NO_ERROR ; 
}",361,-18.943849595327535,-0.052476037660187075
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { 
 if ( request == NULL || blockSize < 16 || blockSize > 512 || blockSize % 16 != 0 ) 
 return ERROR_INVALID_PARAMETER ; 
 osAcquireMutex ( & request -> context -> mutex ) ; 
 if ( blockSize == 16 ) 
 request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; 
 else if ( blockSize == 32 ) 
 request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; 
 else if ( blockSize == 64 ) 
 request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; 
 else if ( blockSize == 128 ) 
 request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; 
 else if ( blockSize == 256 ) 
 request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; 
 else if ( blockSize == 512 ) 
 request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; 
 else 
 request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; 
 if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) 
 request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; 
 osReleaseMutex ( & request -> context -> mutex ) ; 
 return NO_ERROR ; 
}",353,-14.850091442980446,-0.04206824771382563
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) {
    if ( request == NULL || (blockSize != 16 && blockSize != 32 && blockSize != 64 && blockSize != 128 && blockSize != 256 && blockSize != 512) )
        return ERROR_INVALID_PARAMETER;
    osAcquireMutex ( & request -> context -> mutex ) ;
    if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ;
    else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ;
    else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ;
    else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ;
    else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ;
    else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ;
    else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ;
    if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) )
        request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ;
    osReleaseMutex ( & request -> context -> mutex ) ;
    return NO_ERROR ;
}",353,-17.891405731599797,-0.05068386892804475
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize >= 16 && blockSize <= 1024 ) { if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; } else { return ERROR_INVALID_PARAMETER ; } osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",321,-9.206743611319284,-0.028681444272022693
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL || blockSize < 16 || blockSize > 512 ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; switch(blockSize) { case 16: request -> rxBlockSzx = COAP_BLOCK_SIZE_16; break; case 32: request -> rxBlockSzx = COAP_BLOCK_SIZE_32; break; case 64: request -> rxBlockSzx = COAP_BLOCK_SIZE_64; break; case 128: request -> rxBlockSzx = COAP_BLOCK_SIZE_128; break; case 256: request -> rxBlockSzx = COAP_BLOCK_SIZE_256; break; case 512: request -> rxBlockSzx = COAP_BLOCK_SIZE_512; break; default: request -> rxBlockSzx = COAP_BLOCK_SIZE_1024; break; } if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",295,-10.8901049139411,-0.03691560987776644
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; 
if ( blockSize < 16 || blockSize > 512 || blockSize % 16 != 0) { return ERROR_INVALID_PARAMETER;}
osAcquireMutex ( & request -> context -> mutex ) ; 
if (blockSize == 16) request -> rxBlockSzx = COAP_BLOCK_SIZE_16;
else if (blockSize == 32) request -> rxBlockSzx = COAP_BLOCK_SIZE_32;
else if (blockSize == 64) request -> rxBlockSzx = COAP_BLOCK_SIZE_64;
else if (blockSize == 128) request -> rxBlockSzx = COAP_BLOCK_SIZE_128;
else if (blockSize == 256) request -> rxBlockSzx = COAP_BLOCK_SIZE_256;
else if (blockSize == 512) request -> rxBlockSzx = COAP_BLOCK_SIZE_512;
else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024;
if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; 
}",338,-32.42102458187486,-0.09592019107063568
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; 
osAcquireMutex ( & request -> context -> mutex ) ; 
if ( blockSize >= 16 && blockSize <= 512 ) { 
switch ( blockSize ) { 
case 16: 
request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; 
break ; 
case 32: 
request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; 
break ; 
case 64: 
request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; 
break ; 
case 128: 
request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; 
break ; 
case 256: 
request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; 
break ; 
case 512: 
request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; 
break ; 
default: 
request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; 
break ; 
} 
if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; } 
osReleaseMutex ( & request -> context -> mutex ) ; 
return NO_ERROR ; }",355,-23.03390405573586,-0.06488423677672073
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; if ( blockSize != 16 && blockSize != 32 && blockSize != 64 && blockSize != 128 && blockSize != 256 && blockSize != 512 ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",336,-5.6762775984609215,-0.016893683328752743
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; 

if ( blockSize != 16 && blockSize != 32 && blockSize != 64 && blockSize != 128 && blockSize != 256 && blockSize != 512) 
    return ERROR_INVALID_PARAMETER ; 

osAcquireMutex ( & request -> context -> mutex ) ;
if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ;
else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ;
else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ;
else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ;
else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ;
else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ;
else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ;
if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; 

osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",356,-27.8808287388464,-0.0783169346596809
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL || blockSize > 512 ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",297,-3.943440806194251,-0.013277578472034516
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL || blockSize < 16 || blockSize > 512) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",302,-6.109042358961099,-0.020228617082652646
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; switch ( blockSize ) { case 16 : request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; break ; case 32 : request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; break ; case 64 : request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; break ; case 128 : request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; break ; case 256 : request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; break ; case 512 : request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; break ; default : request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; break ; } if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",285,-5.917674612432934,-0.020763770569940117
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL || blockSize > 1024 ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; switch ( blockSize ) { case 16 : request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; break ; case 32 : request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; break ; case 64 : request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; break ; case 128 : request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; break ; case 256 : request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; break ; case 512 : request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; break ; default : request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; break ; } if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",290,-8.89542168156426,-0.030673867867462967
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","

error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) {  
    if ( request == NULL || blockSize < 16 || blockSize > 512 ) return ERROR_INVALID_PARAMETER ; 
    osAcquireMutex ( & request -> context -> mutex ) ; 
    if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; 
    else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; 
    else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; 
    else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; 
    else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; 
    else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; 
    else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; 
    if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; 
    osReleaseMutex ( & request -> context -> mutex ) ; 
    return NO_ERROR ; 
}",341,-18.060581023265904,-0.052963580713389746
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL || blockSize < 16 || blockSize > 1024 || !isDivisibleBy16(blockSize) ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }

bool isDivisibleBy16(uint_t blockSize) {
    return ((blockSize % 16) == 0);
}",343,-25.036933129073443,-0.07299397413724036
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL || blockSize > 1024 || blockSize % 16 != 0) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",304,-9.232836155072663,-0.030371171562739024
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { 
  if ( request == NULL || blockSize > 512 ) {
    return ERROR_INVALID_PARAMETER;
  }
  osAcquireMutex ( & request -> context -> mutex ) ; 
  if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; 
  else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; 
  else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; 
  else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; 
  else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; 
  else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; 
  if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; 
  osReleaseMutex ( & request -> context -> mutex ) ; 
  return NO_ERROR ; 
}",318,-16.434720785686526,-0.05168151190467461
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { 
	if ( request == NULL || blockSize < 16 || blockSize > 512) return ERROR_INVALID_PARAMETER ; 
	osAcquireMutex ( & request -> context -> mutex ) ; 
	if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; 
	else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; 
	else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; 
	else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; 
	else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; 
	else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; 
	else return ERROR_INVALID_PARAMETER ; 
	if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; 
	osReleaseMutex ( & request -> context -> mutex ) ; 
	return NO_ERROR ; 
}",334,-14.624416124806157,-0.043785677020377715
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize >= 16 && blockSize <= 512 ) { request -> rxBlockSzx = (int)pow(2, blockSize) ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; } else { request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; } osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",173,-18.244727844455152,-0.10546085459222632
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize >= 16 && blockSize <= 512 ) { if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; } else { return ERROR_INVALID_PARAMETER ; } osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }",321,-9.597207630936753,-0.029897843087030383
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { 
if ( request == NULL || (blockSize != 16 && blockSize != 32 && blockSize != 64 && blockSize != 128 && blockSize != 256 && blockSize != 512)) return ERROR_INVALID_PARAMETER ; 
osAcquireMutex ( & request -> context -> mutex ) ; 
if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; 
else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; 
else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; 
else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; 
else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; 
else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; 
else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; 
if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; 
osReleaseMutex ( & request -> context -> mutex ) ; 
return NO_ERROR ; 
}",349,-8.531831894851672,-0.024446509727368688
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) { if ( request == NULL ) return ERROR_INVALID_PARAMETER ; osAcquireMutex ( & request -> context -> mutex ) ; if ( blockSize == 16 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ; else if ( blockSize == 32 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ; else if ( blockSize == 64 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ; else if ( blockSize == 128 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ; else if ( blockSize == 256 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ; else if ( blockSize == 512 ) request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ; else request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ; if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ; osReleaseMutex ( & request -> context -> mutex ) ; return NO_ERROR ; }
Fixed code:","
error_t coapClientSetRxBlockSize ( CoapClientRequest * request , uint_t blockSize ) {
    
    // Check for invalid parameters 
    if ( request == NULL || blockSize < 0 || blockSize > 512)
        return ERROR_INVALID_PARAMETER;

    osAcquireMutex ( & request -> context -> mutex ) ;

    // Set rxBlockSzx based on valid blockSize
    if ( blockSize == 16 )
        request -> rxBlockSzx = COAP_BLOCK_SIZE_16 ;
    else if ( blockSize == 32 )
        request -> rxBlockSzx = COAP_BLOCK_SIZE_32 ;
    else if ( blockSize == 64 )
        request -> rxBlockSzx = COAP_BLOCK_SIZE_64 ;
    else if ( blockSize == 128 )
        request -> rxBlockSzx = COAP_BLOCK_SIZE_128 ;
    else if ( blockSize == 256 )
        request -> rxBlockSzx = COAP_BLOCK_SIZE_256 ;
    else if ( blockSize == 512 )
        request -> rxBlockSzx = COAP_BLOCK_SIZE_512 ;
    else
        request -> rxBlockSzx = COAP_BLOCK_SIZE_1024 ;

    // Check if blockSize is within maxBlockSize
    if ( request -> rxBlockSzx > coapClientGetMaxBlockSize ( ) ) {
        request -> rxBlockSzx = coapClientGetMaxBlockSize ( ) ;
    }

    osReleaseMutex ( & request -> context -> mutex ) ;
    return NO_ERROR ;
}",385,-59.23397841094623,-0.1538544893790811
