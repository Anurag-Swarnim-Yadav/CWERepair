Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
 
 // Validate input
 if (address < 0 || address > REG_ADDR_MASK || data < 0 || data > 0xFFFF) {
  return;
 }
 
 enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }",200,-19.95437287956872,-0.0997718643978436
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
    if(address & REG_ADDR_MASK > REG_ADDR_LIMIT){
        return;
    }
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }",189,-18.436285340144412,-0.09754648328118737
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:"," 
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
    // Validate address
    if (address > REG_ADDR_MASK) {
        return;
    }
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }",188,-13.840986463720638,-0.07362226842404594
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
  if (address <= 0xFF) {
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
    while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
  }
}",184,-11.699466592358762,-0.06358405756716719
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
  // Validate address
  if (address > 0x1F) {
    return;
  }
  enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
  enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ;
  enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
  while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { }
}",192,-16.812152591789815,-0.08756329474890528
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { //Validate address before writing if ( address <= REG_ADDR_MASK ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } } }",176,-15.216713316084682,-0.08645859838684479
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
  if(address > 0x1f){
    return;
  }
  enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
  enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
  enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
  while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
}",188,-12.160718476011894,-0.06468467274474411
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
  if ( address > 0x1F ) {
    return;
  }
  
  enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
  enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
  enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
  
  while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
}",193,-15.677439763908943,-0.08123025784408779
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
    // Validate the address 
    if (address >= 0 && address <= 0x1f) {
        enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
        enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
        enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
        while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
    }
}",197,-18.133528665680995,-0.09204836886132485
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
  //Add a validation to check for valid address range 
  if(address < 0 || address > 0x1F)
  {
    return;
  }
  
  enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ;
  enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
  enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ;
  while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
}",208,-40.49430516057041,-0.1946841594258193
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:"," 
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
  if (address > 0x1F) { // Check for a valid address
    return;
  }
  enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ;
  enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ;
  enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ;
  while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) {
  }
}",193,-25.09206295908043,-0.13001068890715248
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
    //Check address and data values
    if(address > REG_ADDR_MASK) {
        return; //Invalid address
    }
    if(data > 0xFFFF) {
        return; //Invalid data
    }
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
    while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
}",224,-31.14923972262951,-0.13905910590459603
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
if (address < MAX_REG_ADDR) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
} else {
// Handle error
}
}",182,-23.310073470837057,-0.12807732676284098
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
if (address > REG_ADDR_MASK) //Check for valid address 
    return;

enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }",188,-22.644343302027483,-0.12044863458525257
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
  if (address <= 0x1F) {
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
    while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
  }
}",185,-9.598786465069663,-0.051885332243619804
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
   //Check that the address is within the bounds of the PHY address
   if(address < 0x20 || address > 0xFF)
      return; 
   
   enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
   enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
   enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
   while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
}",208,-36.816433737444584,-0.1770020852761759
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
if ( address <= REG_ADDR_MASK ) {
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
} else {
    printf(""Error: Invalid address.\n"");
}

}",194,-25.167768332363146,-0.12973076459981003
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
  if (address & REG_ADDR_MASK < 0x1F) {
      enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
      enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
      enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
      while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
   }
}",192,-19.585045424148902,-0.10200544491744219
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
  if (address > REG_ADDR_MASK) {
    return;
  }
  enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
  enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
  enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
  while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
}",192,-8.82336636149329,-0.04595503313277755
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
//Validate the inputs
if(address > 0 && data > 0) {
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
    while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { }
}
}",189,-20.1003057969284,-0.10635082432237249
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
if (address <= 0x1F && address > 0) { 
enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
} else {
printf(""Address out of range"");
}
}",196,-25.46230935222211,-0.12990974159296995
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
  if ( address > 0x1F )
    return;
    
  enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }",175,-13.522223602129156,-0.07726984915502375
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
    if(address <= 0x1F) {
        enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ;
        enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ;
        enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ;
        while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) {
        }
    }
}",182,-12.63614973749921,-0.06942939416208357
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
    // Check for valid address and data
    if (address > REG_ADDR_MASK || data > UINT16_MAX) {
        return;
    }
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ;
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
    while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
}",207,-21.053007631604544,-0.10170535087731664
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
  // Validate the address value
  if(address & REG_ADDR_MASK > 0x1f)
  {
    printf(""Error: Invalid PHY register address"");
    return;
  }
  
  enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
}",211,-37.7916496504315,-0.17910734431484124
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
	//Check for valid address
	if(address > REG_ADDR_MASK){
		return;
	}
	enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }",188,-15.264212841951727,-0.08119262149974323
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
  // Validate inputs
  if (address > REG_ADDR_MASK) {
    return;
  }
  enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }",186,-11.707496939093383,-0.06294353193060959
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
	if (address & REG_ADDR_MASK) {
		enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
		enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
		enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
		while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { }
	}
 
 }",193,-18.6528386232448,-0.09664683224479172
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
	if (address > 0x1F) return;
	enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
	enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
	enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
	while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
}",183,-11.402717476217555,-0.062309931564030356
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
  if(address & REG_ADDR_MASK) {
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ;
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ;
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ;
    while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { }
  } else {
    // handle invalid address
  }
}",194,-17.009679494176233,-0.08767876027925893
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
    //Validate input
    if(address < 0 || address > 32) {
        return;
    }
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
    while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
}",196,-16.01813834509045,-0.08172519563821658
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
  // Validate input
  if (address & REG_ADDR_MASK) {
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ;
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ;
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ;
    while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { }
  }
}",189,-11.18941757444141,-0.05920326758963709
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
    //Verify address is valid
    if (address > 0x1F){
        return;
    }
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }",185,-17.546624887526153,-0.09484662101365489
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
   // Validate inputs
   if (address > 0x1F || (data > 0xFFFF) {
      return;
   }
   enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ;
   enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ;
   enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ;
   while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) {
   }
}",199,-25.904716620270005,-0.13017445537824124
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
if(address >= 0 && address <= 0x1F) {
  enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
  enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
  enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
  while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { }
}
}",186,-14.881481106425252,-0.08000796293777017
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
//check for valid address
if(address >= 0 && address <= 0x1F){
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ;
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ;
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ;
    while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
} else {
   //handle invalid address
   printf(""Invalid address\n"");
}
}",208,-35.98933114384625,-0.1730256304992608
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
  
  if (address & REG_ADDR_MASK){
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ;
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ;
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ;
    while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { }
  }
}",184,-13.62544795775445,-0.07405134759649157
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:"," 
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
  //Verify address is within range
  if (address > 0x1F) {
    return;
  } 
  enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
}",191,-24.758417926576673,-0.12962522474647473
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { if (address & REG_ADDR_MASK > 0x1f) { return; } enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }",177,-10.226606055724533,-0.05777743534307646
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
    //Check for valid address
    if (address & REG_ADDR_MASK) { 
        enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
        enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
        enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
        while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { 
            // if busy wait until transfer is complete
        } 
    }
}",209,-39.230911975880446,-0.1877077128032557
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
    // Verify address validity
    if(address > 0x1F) {
        return;
    }

    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
    while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
}",195,-19.101346957297086,-0.09795562542203634
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { if (address & REG_ADDR_MASK)  { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } } else { // Throw error or do nothing } }",180,-19.213168234897097,-0.1067398235272061
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
  if ( address > REG_ADDR_MASK ) {
    return;
  }
  else {
    enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
    enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
    while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { 
    } 
  }
}",202,-17.782791620350917,-0.08803362188292534
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
   // Validate input
   if (address > REG_ADDR_MASK) {
      return;
   }
   enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
   enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
   enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
   while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
}",198,-12.262020099826698,-0.06192939444356918
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
  if (address & REG_ADDR_MASK > 0x1F) {
    return;
  } 
  enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }",187,-13.863062064972342,-0.07413402173782001
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
   // Check if address is valid
   if(address & REG_ADDR_MASK) {
      enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
      enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
      enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
      while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
   }
}",196,-15.262862407765338,-0.07787174697839458
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:"," 
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
 if (address > 0x1F) {
   return;
 }
 enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; 
 enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; 
 enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; 
 while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } 
}",184,-16.796301450611967,-0.09128424701419548
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
 if (address > 0x1F) { 
   return; 
 } 
 enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }",178,-12.9623946604199,-0.07282244191247135
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) {
if(address > REG_ADDR_MASK) {
 return;
}
 enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }",176,-12.998728768729384,-0.07385641345868968
"The Original Code is vulnerable to CWE-20: Improper Input Validation. Fix the vulnerability.
Original Code:
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }
Fixed code:","
void enc28j60WritePhyReg ( NetInterface * interface , uint16_t address , uint16_t data ) { 
// Validate input
if (address > 0x1f) {
    return;
}

enc28j60WriteReg ( interface , ENC28J60_REG_MIREGADR , address & REG_ADDR_MASK ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRL , LSB ( data ) ) ; enc28j60WriteReg ( interface , ENC28J60_REG_MIWRH , MSB ( data ) ) ; while ( ( enc28j60ReadReg ( interface , ENC28J60_REG_MISTAT ) & MISTAT_BUSY ) != 0 ) { } }",181,-14.502024178135642,-0.08012168054218587
