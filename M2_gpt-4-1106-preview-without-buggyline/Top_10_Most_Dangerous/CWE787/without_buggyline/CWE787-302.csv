Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; if (len > 0) { * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else { return False; } } else * length = len ; return s_check ( s ) ; }",182,-7.3990822742506985,-0.04065429821016867
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; int limit = s_remaining(s); if ( len > limit) { logger(Core, Error, ""ber_parse_header(), invalid length (%d) exceeds limit (%d)"", len, limit); return False; } * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",216,-31.936653419152595,-0.14785487694052127
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if (s.end - s.p < len) {return False;} next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",186,-18.386747479016694,-0.09885348106998224
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { 
    int tag , len ; 
    if ( tagval > 0xff ) { 
        in_uint16_be ( s , tag ) ; 
    } else { 
        in_uint8 ( s , tag ) ; 
    } 
    if ( tag != tagval ) { 
        logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; 
        return False ; 
    } 
    in_uint8 ( s , len ) ; 
    if ( len & 0x80 ) {
        int tmp;
        len &= ~ 0x80 ; 
        * length = 0 ; 
        while ( len -- ) {
            next_be ( s , tmp ) ;
            if ( tmp < 0 ) {
                logger ( Core , Error , ""ber_parse_header(), Out-of-Bounds Write detected"" ) ;
                return False ;
            }
            *length = (*length << 8) | tmp;
        } 
    } else {
        if (len < 0) {
            logger ( Core , Error , ""ber_parse_header(), Out-of-Bounds Write detected"" ) ;
            return False ;
        }
        * length = len ;
    } 
    return s_check ( s ) ; 
}",335,-44.2492381491755,-0.1320872780572403
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- && len < MAXLENGTH) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",174,-13.850534294296992,-0.07960077180630455
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; if (len > 4) { return False; } * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else if (len > 4) { return False; } else { * length = len ; } return s_check ( s ) ; }",193,-13.605185059082597,-0.07049318683462485
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len-- ) { if (len + 1 > 0) { next_be ( s , * length ) ; } else { return False; } } } else * length = len ; return s_check ( s ) ; }",186,-13.374205616903698,-0.07190433127367579
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if (len > (MAX_STREAM_SIZE - s->p)) { logger ( Core , Error , ""ber_parse_header(), length exceeds max stream size"" ); return False ; } while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",209,-24.404466895109604,-0.11676778418712729
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len-- ) { 
    if (s_check (s)) {
        next_be ( s , * length ) ;
    } else {
        return False;
    }
}
} else * length = len ; return s_check ( s ) ; }",199,-20.71994008720371,-0.10412030194574728
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if(len < 0) { logger ( Core , Error , ""ber_parse_header(), length is out of bounds"" ); return False; } next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",201,-15.014381782630107,-0.0746984168290055
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; if (tag > UINT16_MAX) { return False; } } else { in_uint8 ( s , tag ) ; if (tag > UINT8_MAX) { return False; } } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) if (s_check (s)) { next_be ( s , * length ) ; } else { return False; } } else * length = len ; return s_check ( s ) ; }",214,-20.527843429617292,-0.09592450200755744
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if (len > 0) { next_be ( s , * length ) ; } else { break; } } } else * length = len ; return s_check ( s ) ; }",183,-6.3156126606126,-0.034511544593511474
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len-- && len <= *length) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",173,-9.514174521769709,-0.05499522844953589
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; if (len > 4) { logger ( Core , Error , ""ber_parse_header(), length is too long %d"" , len) ; return False ; } else { * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",206,-18.16384670812059,-0.08817401314621647
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len-- ) { if ( len >= 0 ) { next_be ( s , * length ) ; } else { break ; } } } else * length = len ; return s_check ( s ) ; }",183,-12.6692049006062,-0.06923062787216502
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","

RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len-- && len < s->size ) next_be ( s , * length ) ; } else if (len < s->size) * length = len ; return s_check ( s ) ; }",183,-18.4972195612198,-0.10107770252032677
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len , byte_count; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; byte_count = 0 ; while ( len-- && byte_count < 4) { // check for overflow due to large length // CWE-787: Out-of-Bounds Write next_be ( s , * length ) ; byte_count++; } } else * length = len ; return s_check ( s ) ; }",206,-52.687237227724694,-0.2557632875132267
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; if(len > sizeof(int)) { logger ( Core , Error , ""ber_parse_header(), length too large"" , tagval , tag ) ; return False ; } * length = 0 ; while ( len-- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",205,-18.1995600244179,-0.08877834158252633
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len-- > 0 ) { next_be ( s , * length ) ; if ( len > 0 && *length > 0x7f ) { logger ( Core , Error , ""ber_parse_header(), length exceeds upperbound"" ) ; return False ; } } } else * length = len ; return s_check ( s ) ; }",211,-27.220708299658902,-0.12900809620691422
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len-- ) { if (len >= 0) { next_be ( s , * length ) ; } else { return False; } }  } else * length = len ; return s_check ( s ) ; }",185,-13.024895250050202,-0.07040483918946056
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len-- > 0 && len < *length) { next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",177,-10.213453938806897,-0.057703129597779075
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len-- ) { if (s.p >= s.end) { logger( Core, Error, ""ber_parse_header: out of bounds read"" ); return False; } next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",204,-32.016259820283686,-0.15694245009942984
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len , maxLength ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; maxLength = 0xffff; } else { in_uint8 ( s , tag ) ; maxLength = 0xff; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if (* length > maxLength) { logger ( Core , Error , ""ber_parse_header(), received invalid length value %d"" , len ) ; return False; } next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",222,-32.29916403759808,-0.14549172989909046
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- && len <= *length) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",173,-9.2977786456062,-0.053744385234717924
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if (len > 0){ while ( len -- ) { next_be ( s , * length ) ; } } else { *length = 0; } } else * length = len ; return s_check ( s ) ; }",185,-13.4803428679579,-0.07286671820517783
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; if (len < 0) { logger (Core, Error, ""ber_parse_header(), invalid length field""); return False; } * length = 0 ; while ( len -- ) { if (len < 0) { logger (Core, Error, ""ber_parse_header(), invalid length field""); return False; } next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",226,-22.0799250826912,-0.09769878355173098
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
 RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if (len > 0) { while ( len -- ){ if (len > 0) { next_be ( s , * length ) ; } } } } else * length = len ; return s_check ( s ) ; }",186,-18.207686002813592,-0.0978907849613634
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if (len > 0) //Added code to check len is greater than 0 before looping  { while ( len -- )  { if (len > s->size) //Added code to check len is not greater than the size of the stream return False; next_be ( s , * length ) ;  } } else * length = len ; return s_check ( s ) ; }",219,-50.74292629420519,-0.23170285979089128
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if (len > 0) { next_be ( s , * length ) ; } else { break; } } } else * length = len ; return s_check ( s ) ; }",183,-6.709968823765201,-0.036666496304727875
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len > 0 && len-- ) { next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",174,-6.101239399404201,-0.03506459424944943
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if (len < 0) { logger ( Core , Error , ""ber_parse_header(), invalid length value %d"" , len ) ; return False ; } next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",204,-14.298140453705905,-0.070088923792676
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len-- ) { next_be ( s , * length ) ; if ( * length >= UINT_MAX ) { logger ( Core , Error , ""ber_parse_header(), length of data exceeded"" ) ; return False ; } } } else { * length = len ; if ( * length >= UINT_MAX ) { logger ( Core , Error , ""ber_parse_header(), length of data exceeded"" ) ; return False ; } } return s_check ( s ) ; }",242,-33.10974061847571,-0.13681710999370128
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len-- && len >= 0 ) { // check if len is out of bounds next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",182,-16.9697872277776,-0.09324058916361319
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if (len < 0) { return False; } next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",181,-7.6245041516236,-0.04212433232941215
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len-- > 0 && *length+1 < MAX_LENGTH) { next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",182,-18.2019879387816,-0.10001092274055824
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; if (len > 0) { * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else { *length = 0; } } else * length = len ; return s_check ( s ) ; }",184,-8.0508785420262,-0.043754774684925
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; if ( len > 4 ) { logger ( Core , Error , ""ber_parse_header(), expected len <= 4, got %d"" , len ) ; return False ; } * length = 0 ; while ( len -- ) { if (len <= 0) {  logger ( Core , Error , ""ber_parse_header(), out of bounds write detected"" ) ; return False ; } next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",240,-33.4521255385906,-0.13938385641079418
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:"," 
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len-- && (s->p + *length < s->end) ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",182,-17.370828435028645,-0.09544411228037718
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if (len > 4){ logger ( Core , Error , ""ber_parse_header(), length is too long %d"" , len) ; return False ; } while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",202,-17.382433500650293,-0.08605165099331828
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if (len > sizeof(int)) { logger ( Core , Error , ""ber_parse_header(), length is out of bounds"" , 0) ; return False ; } next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",206,-22.911029975494905,-0.11121859211405294
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if (len >= 4) { next_be (s, *length); } else { return False; } } } else * length = len ; return s_check ( s ) ; }",183,-16.353233696604594,-0.08936193276833111
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:"," 
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag = 0, len = 0; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if (len > 0) { while ( len -- ) { next_be ( s , * length ) ; if (len == 0) { break; } } } } else * length = len ; return s_check ( s ) ; }",193,-19.24939650359654,-0.09973780571811679
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { //Added check to make sure length does not exceed stream size if (len > s->end - s->p) return False; next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",197,-23.1403294027886,-0.11746360102938375
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if (len < 0) { logger ( Core , Error , ""ber_parse_header(), Out-of-Bounds Write detected"" ) ; return False ; } next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",204,-17.3896487139104,-0.0852433760485804
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; if (len > MAX_SIZE) { return False; } * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else if (len > MAX_SIZE) { return False; } else * length = len ; return s_check ( s ) ; }",195,-12.366598561485594,-0.06341845416146458
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if (len > 0) { while ( len -- ) { next_be ( s , * length ) ; } } else { return False; } } else * length = len ; return s_check ( s ) ; }",184,-9.0105069064379,-0.04897014623064076
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len-- && len >= 0 ) { next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",174,-6.9390608441116,-0.03987966002362988
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; if (len > sizeof(*length)) { logger ( Core , Error , ""ber_parse_header(), length out of range %d"" , len ) ; return False ; } while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }",205,-16.52778144864489,-0.08062332413973118
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len > 0 && len-- ) { next_be ( s , * length ) ; } } else * length = len ; return s_check ( s ) ; }",174,-6.6823851347586,-0.038404512268727584
"The Original Code is vulnerable to CWE-787: Out-of-Bounds Write. Fix the vulnerability.
Original Code:
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) next_be ( s , * length ) ; } else * length = len ; return s_check ( s ) ; }
Fixed code:","
RD_BOOL ber_parse_header ( STREAM s , int tagval , int * length ) { int tag , len ; if ( tagval > 0xff ) { in_uint16_be ( s , tag ) ; } else { in_uint8 ( s , tag ) ; } if ( tag != tagval ) { logger ( Core , Error , ""ber_parse_header(), expected tag %d, got %d"" , tagval , tag ) ; return False ; } in_uint8 ( s , len ) ; if ( len & 0x80 ) { len &= ~ 0x80 ; * length = 0 ; while ( len -- ) { if (len > 0) { next_be ( s , * length ) ; } else { break; } } } else * length = len ; return s_check ( s ) ; }",183,-6.322409745070601,-0.03454868713153334
