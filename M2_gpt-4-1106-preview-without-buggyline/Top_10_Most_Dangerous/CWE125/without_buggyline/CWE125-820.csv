Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) { PyErr_Clear ( ) ; return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; } else { return NULL ; } } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",184,-4.355652879962402,-0.023672026521534793
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else { Py_XDECREF(dict); return NULL ; } } 
if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_XDECREF(dict); return res ; } 
return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",175,-15.243785299376947,-0.08710734456786827
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ;  else return NULL ; } if ( dict ) { if(PyDict_Check(dict)){ res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } else{ Py_DECREF ( dict ) ; return NULL; } } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",188,-20.39299105482765,-0.10847335667461516
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; 
if ( dict == NULL && ! PyErr_ExceptionMatches ( PyExc_AttributeError ) ) { return NULL ; } 
  
if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } 
return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",159,-20.300894228340294,-0.12767858005245467
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { if ( PyDict_Check ( dict ) ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } Py_DECREF ( dict ) ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }

The fixed code is now no longer vulnerable to CWE-125: Out-of-bounds Read. The code now checks if the object retrieved from _PyObject_GetAttrId is a dictionary before building the value and returning it.",234,-30.547756742720246,-0.13054596898598395
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { if ( PyDict_Check(dict) ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } PyErr_SetString(PyExc_IndexError, ""dict is not a dictionary""); Py_DECREF(dict); return NULL; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",204,-14.822722513476144,-0.07266040447782424
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } else if ( Py_TYPE ( self ) != NULL { return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; } else { PyErr_SetString ( PyExc_IndexError , ""Out of bounds read detected"" ) ; return NULL ; } }",202,-21.16159125917205,-0.10476035276817845
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; //ADDED CHECK TO ENSURE THAT DICT IS NOT NULL if ( dict != NULL ) {  if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } } else { //IF DICT IS NULL, CLEAR ATTRIBUTE ERROR AND RETURN PyErr_Clear ( ) ; return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }  }",177,-43.52793114494758,-0.24592051494320666
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","

static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict != NULL ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",164,-5.312584655311695,-0.0323938088738518
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_XDECREF ( dict ) ; return res ; } PyObject * empty_dict = PyDict_New(); return Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , empty_dict ) ; }",180,-11.016097463386151,-0.061200541463256396
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { if(PyDict_Check(dict)){ res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } PyErr_SetString(PyExc_TypeError, ""__dict__ must be a dictionary""); return NULL; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",198,-16.09116927267604,-0.08126853168018203
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:"," 

static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } else { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } 
return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",162,-13.603657486820898,-0.08397319436309196
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict && PyDict_Check(dict)) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",169,-4.102197301109654,-0.024273356811299728
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict && PyDict_Check(dict)) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",169,-4.105028118131051,-0.024290107207876038
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","

static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { if ( PyDict_Size ( dict ) > 0 ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } Py_DECREF ( dict ) ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",185,-9.571279268499099,-0.051736644694589724
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict && PyDict_Check(dict)) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",169,-4.105028118131051,-0.024290107207876038
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O(O)"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O(N)"" , Py_TYPE ( self ) ) ; }",162,-8.867586888337648,-0.054738190668750915
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","

static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; } else { res = Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; } return res ; }",166,-6.4876909683449995,-0.039082475712921685
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { if ( PyDict_Size ( dict ) == 0 ) { res = Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; Py_DECREF ( dict ) ; return res ; } res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }

The fixed code checks the size of the dictionary before using it to construct the result. This will prevent any out of bounds reads.",235,-38.34970806574094,-0.16319024708825933
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; } else { res = Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; } return res ; }",165,-5.318558571917752,-0.03223368831465304
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { Py_ssize_t size = PyDict_Size(dict); if (size > 0) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",185,-8.282156445723892,-0.044768413220129144
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) { PyErr_Clear ( ) ; return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; } else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",182,-5.754610843423,-0.03161874089792857
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","

static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_XDECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",163,-5.4545445795170995,-0.033463463678019015
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( PyDict_Check(dict) ) {  res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",169,-13.492638894661054,-0.0798380999684086
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O(O)"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",161,-6.589051549616648,-0.04092578602246365
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict && PyDict_Check(dict) ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",170,-4.940904332284453,-0.02906414313108502
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","

static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } // Added check to avoid out-of-bounds read if ( Py_TYPE ( self ) != NULL ) { return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; } else { return NULL; } }",193,-20.279057050504086,-0.1050728344585704
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_SafeGetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",162,-3.8601134813966995,-0.023827860996275922
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","

static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_XDECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",163,-5.4545445795170995,-0.033463463678019015
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_XDECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",162,-3.7966142923771504,-0.023435890693686113
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict != NULL ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",163,-4.006270529667351,-0.024578346807775157
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; PyObject * dict = NULL ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } if (dict == NULL){ return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; } else{ return NULL; } }",181,-20.481979228799418,-0.11316010623646088
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } 
if ( dict ) { if(PyDict_Check(dict)) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } else { PyErr_SetString (PyExc_IndexError, ""dict is not a valid dict.""); Py_DECREF(dict); return NULL; } } 
return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",212,-27.961324455962455,-0.13189303988661535
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) { PyErr_Clear ( ) ; return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; } else { return NULL ; } } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",184,-4.355652879962402,-0.023672026521534793
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict != NULL ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",163,-4.006270529667351,-0.024578346807775157
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","

static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) { PyErr_Clear ( ) ; return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }  else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",184,-11.395539034377498,-0.061932277360747266
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict && PyDict_Check(dict) ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",170,-4.945184131885449,-0.02908931842285558
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_XDECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",162,-3.7966142923771504,-0.023435890693686113
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) { PyErr_Clear ( ) ; return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; } else { return NULL ; } } else { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } }",162,-4.3425293288898,-0.026805736598085182
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { if ( Py_TYPE ( self ) != NULL ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",174,-10.705220281259146,-0.061524254489995094
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict && PyDict_Check ( dict ) ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",170,-5.444840088196247,-0.03202847110703674
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { //Check if the size of dict is greater than zero before attempting to access it if(PyDict_Size(dict) > 0) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; } else { return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; } Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",214,-31.602694682700854,-0.1476761433771068
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } else { return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; } }",164,-5.244739961755049,-0.03198012171801859
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { Py_ssize_t dict_size = PyDict_Size(dict); if (dict_size < 0) { PyErr_SetString(PyExc_IndexError, ""Out-of-bounds read detected""); return NULL; } res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",215,-16.79520200647833,-0.07811721863478294
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","

static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { Py_ssize_t size = PyDict_Size(dict); if (size >= 0) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } else { return NULL; } } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",192,-12.396817949652156,-0.06456676015443831
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_XDECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",162,-3.7966142923771504,-0.023435890693686113
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","

static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else { PyErr_SetString (PyExc_IndexError, ""Index out of bounds""); return NULL ; } } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",183,-11.3033982134301,-0.06176720335207705
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { if ( PyDict_Check ( dict ) ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; } else { return NULL ; } Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",180,-12.016152896131048,-0.06675640497850582
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","

static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if(dict != NULL){ 
    res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; 
    }else if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ){
        PyErr_Clear ( ) ; 
        return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ;
    }else 
        return NULL;
}",175,-40.5397446419221,-0.23165568366812628
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_DECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }
Fixed code:","

static PyObject * ast_type_reduce ( PyObject * self , PyObject * unused ) { PyObject * res ; _Py_IDENTIFIER ( __dict__ ) ; PyObject * dict = _PyObject_GetAttrId ( self , & PyId___dict__ ) ; if ( dict == NULL ) { if ( PyErr_ExceptionMatches ( PyExc_AttributeError ) ) PyErr_Clear ( ) ; else return NULL ; } if ( dict ) { res = Py_BuildValue ( ""O()O"" , Py_TYPE ( self ) , dict ) ; Py_XDECREF ( dict ) ; return res ; } return Py_BuildValue ( ""O()"" , Py_TYPE ( self ) ) ; }",163,-5.073876373681542,-0.0311280759121567
