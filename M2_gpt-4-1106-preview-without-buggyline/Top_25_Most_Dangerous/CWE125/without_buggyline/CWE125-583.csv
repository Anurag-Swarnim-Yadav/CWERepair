Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 && i < * length; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",197,-3.644578111036997,-0.018500396502725874
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 || * length > 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",197,-4.283973666805928,-0.021746059222365118
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; //Added this line to check if the length is valid if (*length > 4) return (-1); for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",213,-20.593425096097608,-0.09668274693003572
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { if(i >= *length) { return -1; } c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",205,-7.602191667055334,-0.037083861790513824
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; 

//added error checking
if (*length > 4) return (-1);

for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } 

//added error checking
if (buffer[0] > 127) return (-1);

value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",235,-29.268039040126883,-0.12454484697926334
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { 
	union { 
		unsigned int unsigned_value ; 
		signed int signed_value ; 
	} quantum ; 
	int c ; 
	register ssize_t i ; 
	unsigned char buffer [ 4 ] ; 
	size_t value ; 
	if ( * length < 4 ) return ( - 1 ) ; 
	
	if (*length > 4){
		*length = 4;
	}
	
	for ( i = 0 ; i < 4 ; i ++ ) { 
		c = ( int ) ( * ( * p ) ++ ) ; 
		( * length ) -- ; 
		buffer [ i ] = ( unsigned char ) c ; 
	} 
	value = ( size_t ) ( buffer [ 0 ] << 24 ) ; 
	value |= buffer [ 1 ] << 16 ; 
	value |= buffer [ 2 ] << 8 ; 
	value |= buffer [ 3 ] ; 
	quantum . unsigned_value = ( value & 0xffffffff ) ; 
	return ( quantum . signed_value ) ; 
}",283,-18.576484240409215,-0.0656412870685838
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( 0 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; if ( * p > buffer + 4 ) return ( 0 ) ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",205,-16.82499187403672,-0.08207313109286204
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 || *length > 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",197,-5.0295619122536275,-0.025530771128191004
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; if (*length > 4) { for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; } else { return (-1); } }",207,-9.475696274995702,-0.045776310507225616
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; // Check the length to ensure it is 4 bytes if not return -1. 
for ( i = 0 ; i < 4 && *length >= 4; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } // Ensure that each loop has 4 bytes before reading. 
value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",228,-56.00478117595024,-0.2456350051576765
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; else if ( * length > 4 ) * length = 4; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",205,-8.255730202951845,-0.04027185464854559
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","

static inline signed int ReadPropertyMSBLong(const unsigned char** p, size_t* length) {
    union {
        unsigned int unsigned_value;
        signed int signed_value;
    } quantum;
    int c;
    register ssize_t i;
    unsigned char buffer[4];
    size_t value;

    if (*length < 4) return (-1);
    if (*length >= 4) {
        for (i = 0; i < 4; i++) {
            c = (int)(*(*p)++);
            (*length)--;
            buffer[i] = (unsigned char)c;
        }
        value = (size_t)(buffer[0] << 24);
        value |= buffer[1] << 16;
        value |= buffer[2] << 8;
        value |= buffer[3];
        quantum.unsigned_value = (value & 0xffffffff);
        return (quantum.signed_value);
    } 
    else {
        return (-1);
    }
}",245,-22.11125617383024,-0.0902500251993071
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 || *p == NULL ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { if(i >= *length) return (-1); c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",208,-11.579725252748554,-0.05567175602282959
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; if (*length > 4) { for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; } else { return ( - 1 ) ; } }",209,-9.139900394486451,-0.04373158083486341
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 && ( * length ) > 0 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",199,-7.268947033388803,-0.03652737202707941
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i <= 3 ; i ++ ) { if ( * length >= ( 4 - i ) ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } else { buffer [ i ] = 0 ; } } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",215,-18.970347577982718,-0.08823417478131497
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) 
{ 
  union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; 
  int c ; 
  register ssize_t i ; 
  unsigned char buffer [ 4 ] ; 
  size_t value ; 
  if ( * length < 4 ) 
    return ( - 1 ) ; 
  if (*length > 4)
    *length = 4;
  for ( i = 0 ; i < 4 ; i ++ ) { 
    c = ( int ) ( * ( * p ) ++ ) ; 
    ( * length ) -- ; 
    buffer [ i ] = ( unsigned char ) c ; 
  }
  value = ( size_t ) ( buffer [ 0 ] << 24 ) ; 
  value |= buffer [ 1 ] << 16 ; 
  value |= buffer [ 2 ] << 8 ; 
  value |= buffer [ 3 ] ; 
  quantum . unsigned_value = ( value & 0xffffffff ) ; 
  return ( quantum . signed_value ) ; 
}",264,-21.841560545897302,-0.08273318388597463
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { if ( i < *length ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } else { buffer[i] = 0; } } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
The fixed code adds a check to the for loop to ensure that the index of i is not greater than length, and if it is, the buffer is zeroed out. This prevents an out-of-bounds read, thereby fixing the vulnerability.",263,-49.22116493319131,-0.18715271837715328
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; // check for enough length to read 4 bytes i = 0; // Initialize loop variable while (i < 4 && *length > 0) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ++ ] = ( unsigned char ) c ; } if (*length < 4) // Check if we read all 4 bytes, return -1 if not return -1; value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",233,-61.45970295388049,-0.2637755491582853
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 && i < * length; i ++ ) { //Added an extra condition, that limits the iteration to the length of the buffer c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } //Put an extra condition to check the length of the buffer  if(*length >= 4) { value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; } else { //Return an error if the buffer length is not 4 return -1; } }",252,-69.72915479759847,-0.27670299522856534
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 5 ] = { 0 }; // Added one extra byte at the end size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0; i < 4; i ++ ) { if(i >= *length) // Added condition to check valid index { break; } c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",221,-43.957797673180416,-0.19890406186959464
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; if(*length < 0) { return ( - 1 ) ; } buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",206,-12.966171405212227,-0.06294257963695256
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; if ( * length > 4 ) { * length = 4; } for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",206,-6.8523196895315035,-0.033263687813259724
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { 
 union { 
     unsigned int unsigned_value ; 
     signed int signed_value ; 
 } quantum ; 
 int c ; 
 register ssize_t i ; 
 unsigned char buffer [ 4 ] ; 
 size_t value ; 
 
 if ( * length < 4 ) return ( - 1 ) ; 
 
 for ( i = 0 ; i < 4 && i < *length; i ++ ) { 
     c = ( int ) ( * ( * p ) ++ ) ; 
     ( * length ) -- ; 
     buffer [ i ] = ( unsigned char ) c ; 
 } 
 
 value = ( size_t ) ( buffer [ 0 ] << 24 ) ; 
 value |= buffer [ 1 ] << 16 ; 
 value |= buffer [ 2 ] << 8 ; 
 value |= buffer [ 3 ] ; 
 quantum . unsigned_value = ( value & 0xffffffff ) ; 
 return ( quantum . signed_value ) ; 
}",250,-17.140691105881203,-0.06856276442352481
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( 0 ) ; if(*length >= 4) { for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; } else { return 0; } }",205,-12.547703660982993,-0.061208310541380456
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:"," 
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] = {0}; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; if(*length > 0) //Check for out of bound read { buffer [ i ] = ( unsigned char ) c ; } } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",211,-26.669137976250695,-0.12639401884479
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","

static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0; i < 4; i++ ) { if (i >= *length) { return 0; } c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",205,-14.213534468892256,-0.06933431448240125
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 && i < * length; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",197,-3.6482858434801493,-0.018519217479594667
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( 0 ) ; for ( i = 0 ; i < 4 ; i ++ ) { if ( * length < i ) return ( 0 ); c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",202,-12.449297286235067,-0.061630184585322115
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 && (i < *length); i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",198,-7.5399305264679475,-0.03808045720438357
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 && i < *length; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",197,-3.0102170607135497,-0.01528028964829213
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 && i < * length; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",197,-3.6482858434801493,-0.018519217479594667
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( 0 ) ; for ( i = 0 ; i < 4 ; i ++ ) { 
  if (*length > 0) {
    c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ;
  }
  else {
    return 0;
  }
}
value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",220,-19.932976328873302,-0.090604437858515
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { 
//Check for out-of-bounds access
if(i >= *length) {
return -1;
}
c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",221,-23.01412888015678,-0.10413632977446506
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; if ( * length > 4 ) { * length = 4; } for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",206,-6.829524904794305,-0.03315303351841896
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0; i < 4; i ++ ) { if ( i < *length ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } else { buffer[i] = 0; } } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",211,-12.90872810912474,-0.06117880620438265
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { 
  if (*length < i+1) return(-1);
  c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; 
}
value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",212,-22.65119249480432,-0.10684524761700151
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; if ( * length > 4 ) *length = 4; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }

The vulnerability has been fixed by adding an if statement that checks whether the length is greater than 4. If it is, the length is set to 4. This ensures that there is no out-of-bounds read.",251,-30.561891896064846,-0.12176052548233006
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 && i < *length; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",197,-3.002217235071748,-0.01523968139630329
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { if ( i >= * length ) { return ( - 1 ) ; } c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",207,-7.777386893054105,-0.0375719173577493
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; if ( * length > 4 ){ * length = 4; } for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",206,-8.87074963238941,-0.04306189141936607
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong(const unsigned char** p, size_t* length) {
  union {
    unsigned int unsigned_value;
    signed int signed_value;
  } quantum;
  int c;
  register ssize_t i;
  unsigned char buffer[4];
  size_t value;
  if(*length < 4) {
    return 0;
  }
  for (i = 0; i < 4; i++) {
    c = (int)(*(*p)++);
    (*length)--;
    buffer[i] = (unsigned char)c;
  }
  value = (size_t)(buffer[0] << 24);
  value |= buffer[1] << 16;
  value |= buffer[2] << 8;
  value |= buffer[3];
  quantum.unsigned_value = (value & 0xffffffff);
  return (quantum.signed_value);
}",223,-15.519786724827512,-0.06959545616514579
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 && i < *length; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",197,-3.002217235071748,-0.01523968139630329
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 && i < *length; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",196,-6.981456200914025,-0.03561967449445931
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","

static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { 
 union { 
   unsigned int unsigned_value ; 
   signed int signed_value ; 
 } quantum ; 
 int c ; 
 register ssize_t i ; 
 unsigned char buffer [ 4 ] ; 
 size_t value ; 
 if ( * length < 4 ) { 
    return ( - 1 ) ; 
 } else if ( * length > 4 ) { 
    * length = 4; 
 } 
 for ( i = 0 ; i < 4 ; i ++ ) { 
    c = ( int ) ( * ( * p ) ++ ) ; 
    ( * length ) -- ; 
    buffer [ i ] = ( unsigned char ) c ; 
 } 
 value = ( size_t ) ( buffer [ 0 ] << 24 ) ; 
 value |= buffer [ 1 ] << 16 ; 
 value |= buffer [ 2 ] << 8 ; 
 value |= buffer [ 3 ] ; 
 quantum . unsigned_value = ( value & 0xffffffff ) ; 
 return ( quantum . signed_value ) ; 
}",267,-23.358350842018623,-0.08748446008246676
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","

static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { if(i < *length) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } else { break; } } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",207,-12.83459559728204,-0.06200287728155574
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 && i < *length ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",197,-4.718983750656301,-0.023954232236834017
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 && i < *length; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } if (i < 4) return -1; value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",207,-9.805177723268196,-0.04736800832496713
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 || *length > 4) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",197,-4.8804225402305965,-0.0247737184783279
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }
Fixed code:","
static inline signed int ReadPropertyMSBLong ( const unsigned char * * p , size_t * length ) { union { unsigned int unsigned_value ; signed int signed_value ; } quantum ; int c ; register ssize_t i ; unsigned char buffer [ 4 ] ; size_t value ; if ( * length == 0 || * length < 4 ) return ( - 1 ) ; for ( i = 0 ; i < 4 ; i ++ ) { c = ( int ) ( * ( * p ) ++ ) ; ( * length ) -- ; buffer [ i ] = ( unsigned char ) c ; } value = ( size_t ) ( buffer [ 0 ] << 24 ) ; value |= buffer [ 1 ] << 16 ; value |= buffer [ 2 ] << 8 ; value |= buffer [ 3 ] ; quantum . unsigned_value = ( value & 0xffffffff ) ; return ( quantum . signed_value ) ; }",197,-8.1325521755923,-0.04128199073904721
