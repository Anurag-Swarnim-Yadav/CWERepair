Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset < 0 || offset > tlen ) { //Check for bounds return ; } if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",161,-19.173349202327262,-0.11908912548029356
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && skb_transport_header ( skb ) + tlen >= skb_headlen ( skb ) ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",167,-8.738774545751207,-0.0523279912919234
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && skb_transport_header(skb) + tlen < skb_tail_pointer(skb)) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",167,-10.148796952920529,-0.06077123923904509
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) { if (tlen >= offset) { csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; } } }",153,-12.15003198813135,-0.07941197377863628
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","

static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) {
  if (offset > skb->len) {
    return;
  }
  csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; 
}
put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",169,-15.247670209545838,-0.09022290064820022
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && (offset + tlen) <= skb_transport_header_len(skb) ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",163,-9.555011430996904,-0.058619702030655856
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { 
	if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ;

	__wsum csum = skb -> csum ; 
	if ( offset != 0 && skb_transport_header(skb)) { 
		if ((skb_transport_header(skb) + tlen) < skb_transport_header(skb)) { 
			return;
		}
		csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; 
	} 
	put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; 
}",219,-37.06947396401535,-0.16926700440189657
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) { int trans_header_size = skb_transport_header_len(skb); if (offset < trans_header_size) { csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ); } } put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",175,-19.005910050873428,-0.1086052002907053
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && offset < skb_transport_header_len(skb) ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",158,-7.049678148574741,-0.04461821613021988
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && offset <= skb->len ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",149,-5.701811600957201,-0.03826719195273289
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( skb_transport_header ( skb ) + tlen + offset > skb_tail_pointer ( skb ) ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",174,-9.489080274637182,-0.05453494410711024
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && offset < skb_transport_header_len(skb) ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; else return;  put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",162,-13.400970223749805,-0.08272203841820867
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && (offset + tlen) <= skb->len ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",154,-7.581226043554386,-0.04922874054256095
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && offset <= skb->len ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",149,-5.701811600957201,-0.03826719195273289
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && tlen+offset <= skb->len) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",152,-8.371357631477732,-0.055074721259721925
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && tlen + offset <= skb_headlen(skb)) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",156,-7.942529197914142,-0.05091364870457783
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && offset <= skb->len) { csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; }  put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",152,-11.61524314927615,-0.07641607335050099
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && (tlen + offset) < skb_transport_header(skb)) { csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; } put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",162,-10.806071567169187,-0.066704145476353
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && skb_transport_header(skb) + tlen > skb->len) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",162,-9.477545622692332,-0.05850336804131069
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset > 0 && offset <= tlen ) { csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; } }",149,-7.1947499686673035,-0.0482869125413913
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { 
    __wsum csum = skb -> csum ; 
    if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; 
    if ( offset != 0 && (offset+tlen) <= skb_transport_header_len(skb) ){
        csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ;  
    }
    put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; 
}",183,-25.6496925841535,-0.14016225455821585
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) { if (offset + tlen <= skb_transport_header(skb)) { csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; } } put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",164,-8.180644624802001,-0.0498819794195244
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && tlen + offset <= skb_transport_header(skb) ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",159,-6.782255663336042,-0.04265569599582417
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) { 
 if ( offset > skb_transport_header(skb) + tlen ) return;
 csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ;
 }
 put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",170,-19.551587743343397,-0.11500933966672587
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && (tlen + offset) <= skb->len) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",154,-7.939047295536132,-0.05155225516581904
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset > 0 && offset < skb_transport_header(skb)) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; else return; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",158,-11.24960745355645,-0.07120004717440791
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && skb_transport_header_len(skb) - tlen >= offset) { csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; } }",163,-11.39296781544845,-0.0698955080702359
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; 
    if ( offset != 0 && offset < skb -> len ) { //Added check to ensure offset is within bounds
        csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; 
    }
    put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; 
}",172,-25.36863724233598,-0.14749207699032546
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","

static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) { if (offset + tlen <= skb_transport_header(skb)) { csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; } else { return; } } put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",170,-11.154302982372275,-0.06561354695513104
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","

static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && (skb_transport_header(skb) + tlen) < skb->len ) { csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; } else { return; } put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",172,-14.510764075997633,-0.08436490741859089
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && offset + tlen <= skb_transport_header_len(skb)) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",160,-8.130974927947431,-0.05081859329967144
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) { if (offset <= skb_transport_header(skb) + tlen) { csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; } else { return; } } put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",170,-8.846812945445402,-0.052040076149678836
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) { 
  if ( skb_transport_header_len ( skb ) > tlen + offset ) {
    csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; 
  }
  else {
    return;
  }
}
put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",188,-22.543597919738687,-0.11991275489222705
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset > 0 && offset <= skb_transport_header ( skb ) + tlen ) { csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; } put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",161,-9.489784836814433,-0.05894276296158033
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset > 0 && offset <= tlen ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",147,-6.135652889828135,-0.0417391353049533
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) 
  if (tlen + offset > skb_transport_header(skb)) return; 
  csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",168,-17.919123037463585,-0.10666144665156896
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; int len = skb_transport_headerlen(skb); if ( offset != 0 && (tlen + offset) <= len ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",166,-18.315552236757583,-0.11033465202866014
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && skb_transport_header ( skb ) + tlen - offset >= 0 ) { // Added condition to check bound csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; } put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",169,-24.4188494574674,-0.14449023347613846
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && ( tlen + offset ) <= skb -> len ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",154,-9.13362842034544,-0.059309275456788574
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && (tlen + offset) <= skb_transport_header(skb) ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",161,-8.070514217266199,-0.05012741749854782
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","

static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && skb_transport_header(skb) + tlen >= skb_headlen(skb) ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",168,-12.354569171229976,-0.07353910220970224
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && (tlen + offset) < skb_transport_header(skb)) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",160,-8.713798351912855,-0.05446123969945534
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) { if (offset + tlen <= skb_transport_header(skb)) { csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; } } put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",164,-8.1972026714332,-0.04998294311849512
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset > 0 && offset + tlen <= skb -> len ) { csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; } }",154,-9.878966966208504,-0.06414913614421106
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { 
    __wsum csum = skb -> csum ; 
    __wsum csum_offset = 0;
    if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; 
    if ( offset != 0 ) {
        if (offset + skb_transport_header_len(skb) > skb->len)
            return;
        csum_offset = csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 )
        csum = csum_sub ( csum , csum_offset ) ; 
    }
    put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; 
}",214,-32.18255197635854,-0.15038575689887168
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && offset < tlen ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",147,-5.666547568596001,-0.03854794264351021
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && (skb_transport_header(skb) + tlen) >= skb_tail_pointer(skb) ) { csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; } }",172,-14.283655906104954,-0.08304451108200554
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && (offset+tlen) <= skb_transport_header(skb)) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",160,-9.788463932797871,-0.06117789957998669
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset > 0 && offset < skb_transport_header ( skb ) + tlen) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",159,-9.692391539707435,-0.06095843735665053
"The Original Code is vulnerable to CWE-125: Out-of-bounds Read. Fix the vulnerability.
Original Code:
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 ) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }
Fixed code:","
static void ip_cmsg_recv_checksum ( struct msghdr * msg , struct sk_buff * skb , int tlen , int offset ) { __wsum csum = skb -> csum ; if ( skb -> ip_summed != CHECKSUM_COMPLETE ) return ; if ( offset != 0 && (offset + tlen) <= skb_transport_header ( skb )) csum = csum_sub ( csum , csum_partial ( skb_transport_header ( skb ) + tlen , offset , 0 ) ) ; put_cmsg ( msg , SOL_IP , IP_CHECKSUM , sizeof ( __wsum ) , & csum ) ; }",160,-11.815496559131098,-0.07384685349456936
