Original code,Plausible Program,Number of Bugs Present,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; }<EndBug> string += 2 ; alloc -= 2 ; } <StartBug> if ( alloc > 0 ) {<EndBug> ns [ strindex ++ ] = in ; string ++ ; <StartBug>}<EndBug> } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,314,-20.07706439254145,-0.06393969551764793
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> 
int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; 
char * ns = malloc ( alloc ) ; 
unsigned char in ; 
int strindex = 0 ; 
unsigned long hex ; 
CURLcode res ; 

if ( ! ns ) return NULL ; 

while ( -- alloc > 0 ) { 
in = * string ; 
if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { 
char hexstr [ 3 ] ; 
char * ptr ; 
hexstr [ 0 ] = string [ 1 ] ; 
hexstr [ 1 ] = string [ 2 ] ; 
hexstr [ 2 ] = 0 ; 
hex = strtoul ( hexstr , & ptr , 16 ) ; 
in = curlx_ultouc ( hex ) ; 

res = Curl_convert_from_network ( handle , & in , 1 ) ; 
if ( res ) {
  free ( ns ) ; 
  return NULL ; 
 } 

if ( ! isgraph ( in ) ) <StartBug> in = ' ' ; <EndBug>
string += 2 ; 
alloc -= 2 ; 
} 
ns [ strindex ++ ] = in ; 
string ++ ; 
} 
ns [ strindex ] = 0 ; 
if ( olen ) <StartBug> * olen = strindex ; <EndBug> 
return ns ; 
}",5,386,-54.123534729974125,-0.14021641121754955
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; <StartBug> hex = strtoul ( hexstr , & ptr , 10 ) ; <EndBug> in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,330,-9.100414586768512,-0.027577013899298522
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } else { ns [ strindex ++ ] = in ; string ++ ; } } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,285,-10.405703487896549,-0.036511240308408945
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 5 ] ; char * ptr ; hexstr [ 0 ] = '0' ; hexstr [ 1 ] = 'x' ; hexstr [ 2 ] = string [ 1 ] ; hexstr [ 3 ] = string [ 2 ] ; hexstr [ 4 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; 
if ( res ) {
 free ( ns ) ;
return NULL ;
}
string += 2 ;
alloc -= 2 ;
}
ns [ strindex ++ ] = in ;
string ++ ;
}
ns [ strindex ] = 0 ;
if ( olen )
* olen = strindex ;
return ns ; 
}",5,319,-23.233372446272057,-0.07283188854630739
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:"," 
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc ; <EndBug> if (length == 0) <StartBug> alloc = (int) strlen(string) + 1; <EndBug> else <StartBug> alloc = length + 1; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } else if (in == '\'') <StartBug> return NULL; <EndBug> ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,360,-25.84922582234024,-0.07180340506205622
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; <StartBug> hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , NULL , 16 ) ; <EndBug> in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,301,-16.49371247992009,-0.05479638697647871
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; int strindex = 0 ; unsigned long hex ; <StartBug> unsigned char in ; CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 4 ] ; hexstr [ 0 ] = '0' ; hexstr [ 1 ] = 'x' ; hexstr [ 2 ] = string [ 1 ] ; hexstr [ 3 ] = string [ 2 ] ; <StartBug> res = Curl_strntoumax ( hexstr , NULL , 16 , & hex ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,350,-29.153387569557804,-0.08329539305587944
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * out = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <EndBug> CURLcode res ; if ( ! out ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( out ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } out [ strindex ++ ] = in ; string ++ ; } out [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return out ; }",5,306,-17.829812540456555,-0.058267361243322074
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) ; <EndBug> char * ns = malloc ( alloc + 1 ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc >= 0 ) { in = * string ; <StartBug> if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } string += 3 ; alloc -= 3 ; } <EndBug> ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,314,-16.621164654225957,-0.05293364539562407
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> if ( ! handle -> escape_bypass ) { <EndBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } } <StartBug> else { <EndBug> in = *ptr ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,318,-29.156861454970127,-0.09168824356908845
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; <StartBug> if (res == 0 && curl_easy_unescape(handle, hexstr, 0, NULL) == NULL) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,311,-22.158183311512747,-0.0712481778505233
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc ; int strindex = 0 ; unsigned long hex ; CURLcode res ; <EndBug> if ( length ) alloc = length ; else alloc = ( int ) strlen ( string ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug> res = CURLE_OK ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 3 ; alloc -= 3 ; } else { string ++ ; alloc -- ; } ns [ strindex ++ ] = in ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,333,-17.53391676200305,-0.052654404690699846
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","

char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc ; char * ns ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <EndBug> CURLcode res ; 

if ( length ) {
  alloc = length + 1;
}
else {
  alloc = (int) strlen(string) + 1;
}

ns = malloc(alloc); 

if ( !ns ) {
  return NULL;
}

while ( --alloc > 0 ) {
  in = *string; 
  if ( ( '%' == in ) && ISXDIGIT (string[1]) && ISXDIGIT (string[2]) ) {
    char hexstr[3] ;
    char *ptr;
    hexstr[0] = string[1];
    hexstr[1] = string[2];
    hexstr[2] = 0; 
    hex = strtoul(hexstr, &ptr, 16);
    in = curlx_ultouc(hex); 
    <StartBug>
    res = Curl_convert_from_network(handle, &in, 1);
    if (res) {
      free(ns);
      return NULL;
    }
    <EndBug>
    string += 2;
    alloc -= 2;
  }
  ns[strindex++] = in;
  string++;
}

ns[strindex] = 0; 

if ( olen ) {
  * olen = strindex; 
}

return ns;
}",5,384,-61.45726898172537,-0.1600449713065765
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; <StartBug> unsigned long hex ; CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; <StartBug> if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; <EndBug> hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; <StartBug> if ( res ) { free ( ns ) ; curl_free ( hexstr ) ; <EndBug> return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; <StartBug> curl_free ( hexstr ) ; <EndBug> return ns ; }",5,334,-27.7238055820713,-0.08300540593434522
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:"," 
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 4 ] ; char * ptr ; hexstr [ 0 ] = '0' ; hexstr [ 1 ] = 'x' ; hexstr [ 2 ] = string [ 1 ] ; hexstr [ 3 ] = string [ 2 ] ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,295,-9.232943781715546,-0.03129811451428999
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","

char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; int strindex = 0 ; <EndBug> unsigned char in ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { <StartBug> char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; unsigned long hex = strtoul ( hexstr , & ptr , 16 ) ; <EndBug> in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; <StartBug> if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,321,-26.971554066517598,-0.08402353291750031
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = 0;
if (length) {
    alloc = length;
} else {
    alloc = (int)strlen(string) + 1;
}
<EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ;

//Sanitize input
string[1] = '\0';
string[2] = '\0';

<EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,370,-30.8029686276275,-0.0832512665611554
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = length + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns || alloc < 2 ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } if ( ! isalnum ( in ) ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,325,-30.378964394287706,-0.09347373659780833
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = 0; int len = strlen(string); <EndBug> if (length > 0 && len > length) len = length; alloc = len + 1; <StartBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <EndBug> CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,335,-29.06883991189071,-0.08677265645340511
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { <StartBug> char hexstr [ 4 ] ; <EndBug> char * ptr ; <StartBug> hexstr [ 0 ] = '0' ; <EndBug> hexstr [ 1 ] = 'x' ; hexstr [ 2 ] = string [ 1 ] ; hexstr [ 3 ] = string [ 2 ] ; hexstr [ 4 ] = 0 ; <StartBug> hex = strtoul ( hexstr , & ptr , 0 ) ; <EndBug> in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,334,-17.839886762730135,-0.0534128346189525
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char *ns = malloc(alloc); unsigned char in; int strindex = 0 ; unsigned long hex ; CURLcode res; <EndBug> if (!ns) return NULL; while (--alloc > 0 ) { in = *string; if (('%' == in ) && ISXDIGIT(string[1]) && ISXDIGIT(string[2])) { char hexstr[3]; char *ptr; hexstr[0] = string[1]; hexstr[1] = string[2]; hexstr[2] = 0; hex = strtoul(hexstr, &ptr, 16); in = curlx_ultouc(hex); <StartBug>res = Curl_convert_from_network(handle, &in, 1); if(res){ free(ns); return NULL; }</EndBug> string+=2; alloc-=2; }else if(!(iscntrl((int)in))){ <StartBug>res = Curl_convert_from_network(handle, &in, 1); if(res){ free(ns); return NULL; }</EndBug> } ns[strindex++] = in; string++; } ns[strindex] = 0; if (olen) <StartBug>*olen = strindex;<EndBug> return ns; }",5,345,-61.16797354455859,-0.1772984740421988
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } <StartBug> else if ( in == '\'' || in == '""' || in == ';' || in == '-' || in == '(' || in == ')' || in == '=' || in == '#' || in == '&' || in == '\\' ) { <EndBug> free ( ns ) ; return NULL ; } <StartBug> else {<EndBug> ns [ strindex ++ ] = in ; string ++ ; } } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,401,-38.52087737471417,-0.09606203834093309
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ptr = NULL ; int strindex = 0 ; unsigned long hex ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } else if ( '\'' == in || '\""' == in || ';' == in || '-' == in ) { free ( ns ) ; return NULL ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,360,-36.09514191021014,-0.10026428308391705
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc ; <EndBug> char * ns ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if (length == 0) alloc = (int) strlen(string)+1; else alloc = length+1; ns = malloc(alloc); if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { <StartBug> free ( ns ) ; return NULL ; <EndBug> } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,331,-27.85275759610438,-0.0841473039157232
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","

char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <EndBug> CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; int check = 0; while(hexstr[check] != '\0'){ if((hexstr[check] >= '0' && hexstr[check] <= '9') || (hexstr[check] >= 'a' && hexstr[check] <= 'f') || (hexstr[check] >= 'A' && hexstr[check] <= 'F')){ check++; } else { free(ns); return NULL; } } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,390,-37.77624333432759,-0.09686216239571177
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; 
<StartBug> ptr = NULL; res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; free(ptr); return NULL ; } <EndBug>
 string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,301,-23.96553671153161,-0.07961972329412495
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc ; char * ns ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( length ) { alloc = length ; } else { alloc = ( int ) strlen ( string ) + 1 ; } ns = malloc ( alloc ) ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,293,-10.758070772922107,-0.036716965095297295
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = 0;
if (length != 0) {
  alloc = length;
} else {
  alloc = (int)curl_escape_strlen(string) + 1;
}
<EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } else { <StartBug> if (in == '\'' || in == ';' || in == '-' || in == '|') { free (ns); return NULL; } <EndBug> } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,392,-41.65499197218391,-0.10626273462291813
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = 0 ; char * ns = NULL ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( length != 0 ) { alloc = length + 1 ; } else { alloc = ( int ) strlen ( string ) + 1 ; } <StartBug> ns = malloc ( alloc ) ; if ( ! ns ) return NULL ; <EndBug> while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; <StartBug> if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,317,-19.642080993521947,-0.06196240061047933
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc ; <EndBug> if ( length ) { alloc = length + 1 ; } else { alloc = ( int ) curl_escape_string_restricted ( string , 0 ); } char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,329,-22.52177476665857,-0.06845524245184975
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; <StartBug> if ( '%' == in && ISXDIGIT ( string [ 1 ]) && ISXDIGIT ( string [ 2 ])) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { <EndBug> free ( ns ) ; return NULL ; } <StartBug> string = sanitize_input(string); <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,316,-34.09711766281002,-0.10790227108484184
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> // Escape the string to prevent SQL Injection. 
res = Curl_convert_from_network ( handle , mysqli_real_escape_string ( hex ) , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,344,-28.939341675243533,-0.08412599324198701
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; <StartBug> if ( !res && ptr && *ptr ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,296,-13.355632878059549,-0.04512038134479577
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; <StartBug> if ( hex > 255 ) { <EndBug> free ( ns ) ; return NULL ; } in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,330,-19.45121415412926,-0.05894307319433109
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
 char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; int len = 0 ; res = Curl_convert_from_network ( handle , & in , 1 ) ; <StartBug> if ( res || len != 1 ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,299,-24.836634286231256,-0.08306566650913463
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; <StartBug> if ( ! validate_hex_string ( hexstr ) ) { <EndBug> hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } <StartBug> else { <EndBug> free ( ns ) ; return NULL ; } <StartBug> ns [ strindex ++ ] = in ; <EndBug> string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }

Added code: 
bool validate_hex_string ( char * hexstr ) { int i ; for ( i = 0 ; i < 2 ; i ++ ) { if ( ! isxdigit ( hexstr [ i ] ) ) { return false ; } } return true ; }",5,408,-43.53877171880392,-0.10671267578138216
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc ;
if (length) {
  alloc = length ;
} else {
  alloc = (int)strlen(string) + 1;
}
<EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } else { ns [ strindex ++ ] = in ; string ++ ; } } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,342,-30.89213677386368,-0.09032788530369497
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; 
char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; 
CURLcode res ; 
if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; 
in = ( unsigned char ) hex ; 
res = Curl_convert_from_network ( handle , & in , 1 ) ; 

if ( res ) { free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; 
} 

if ( ! ( isalnum ( in ) || in == '_' ) ) { 
free ( ns ) ; return NULL ; 
} 

ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,331,-35.0667632336991,-0.10594188288126616
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> ptr = NULL; res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { ptr = malloc(strlen(string)+1); strcpy(ptr,string); <EndBug> string += 2 ; alloc -= 2 ; } else { ns [ strindex ++ ] = in ; } <StartBug> if(ptr) { free(ptr); } <EndBug> string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,342,-30.44480330911198,-0.08901989271670169
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } else if ( '\'' == in || '""' == in || ';' == in || '\\' == in || '-' == in || '=' == in ) { free ( ns ) ; return NULL ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,328,-17.071127428334787,-0.052046120208337765
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; <EndBug> } if (!ISXDIGIT(in)) { free ( ns ) ; return NULL ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,326,-22.368037604643657,-0.068613612284183
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 5 ] ; char * ptr ; hexstr [ 0 ] = '0' ; hexstr [ 1 ] = 'x' ; hexstr [ 2 ] = string [ 1 ] ; hexstr [ 3 ] = string [ 2 ] ; hexstr [ 4 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; res = Curl_convert_from_network ( handle , & in , 1 ) ; <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,318,-8.816641023237949,-0.027725286236597323
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns ; unsigned char in ; int strindex = 0 ; unsigned long hex ;  CURLcode res ; <EndBug> ns = (char *) malloc ( alloc ) ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ;<StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } else if (('\'' == in) || ('\""' == in) || ('`' == in) || ('*' == in) || (';' == in) || ('-' == in)) { free ( ns ) ; return NULL ; } <StartBug> ns [ strindex ++ ] = in ; <EndBug> string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,373,-57.230467749138406,-0.15343288940787778
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; <StartBug> if ( ! olen ) { olen = &strindex ; } <EndBug> * olen = strindex ; return ns ; }",5,308,-24.261480415303353,-0.07877104030942647
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","

char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; 

if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; 

hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> if ( hex && ( in < 0x20 || in > 0x7e ) ) { free ( ns ) ; return NULL ; } <EndBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; 

if ( res ) { free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,329,-30.7939549411531,-0.09359864723754742
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; CURLcode res ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { free ( ns ) ; return NULL ; } <EndBug> string += 2 ; alloc -= 2 ; } <StartBug> if ( ! isalnum ( in ) && ! isblank ( in ) ) { free ( ns ) ; return NULL ; } <EndBug> ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) * olen = strindex ; return ns ; }",5,325,-14.975832502904344,-0.04607948462432106
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } else if (in == '\'' || in == ';' || in == '""' || in == '-' || in == '*' || in == '+' || in == '=' || in == '^' || in == '$' || in == '%' || in == '`' || in == '{' || in == '}' || in == '[' || in == ']' || in == '(' || in == ')' || in == '<' || in == '>' || in == '&' || in == '|' || in == '!' || in == '#') { // discard the special characters <StartBug> continue; <EndBug> } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,471,-66.83637850354754,-0.14190313907334934
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = 0 ; <EndBug> char * ns = NULL ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( length > 0 ) alloc = length + 1 ; else alloc = strlen ( string ) + 1 ; ns = malloc ( alloc ) ; if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,326,-17.993062743489386,-0.0551934439984337
"The Original Code is vulnerable to CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection'). Fix the code between <StartBug> and <EndBug> to fix the vulnerability.
Original Code:
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <EndBug> <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }
Fixed code:","
char * curl_easy_unescape ( CURL * handle , const char * string , int length , int * olen ) { <StartBug> int alloc = ( length ? length : ( int ) strlen ( string ) ) + 1 ; <EndBug> char * ns = malloc ( alloc ) ; unsigned char in ; int strindex = 0 ; unsigned long hex ; <StartBug> CURLcode res ; int escaped = 0 ; <EndBug> if ( ! ns ) return NULL ; while ( -- alloc > 0 ) { in = * string ; if ( ( '%' == in ) && ISXDIGIT ( string [ 1 ] ) && ISXDIGIT ( string [ 2 ] ) ) { char hexstr [ 3 ] ; char * ptr ; hexstr [ 0 ] = string [ 1 ] ; hexstr [ 1 ] = string [ 2 ] ; hexstr [ 2 ] = 0 ; hex = strtoul ( hexstr , & ptr , 16 ) ; in = curlx_ultouc ( hex ) ; <StartBug> escaped = 1 ; <EndBug> } <StartBug> if ( escaped ) { <EndBug> res = Curl_convert_from_network ( handle , & in , 1 ) ; <StartBug> if ( res ) { <EndBug> free ( ns ) ; return NULL ; } string += 2 ; alloc -= 2 ; } ns [ strindex ++ ] = in ; string ++ ; } ns [ strindex ] = 0 ; if ( olen ) <StartBug> * olen = strindex ; <EndBug> return ns ; }",5,345,-18.028531801318916,-0.05225661391686642
