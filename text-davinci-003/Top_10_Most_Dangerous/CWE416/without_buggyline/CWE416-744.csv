Original code,Plausible Program,Total Tokens,Sum Entropy,Mean Entropy
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9911569219900993,-0.010591260223351592
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL; } }",188,-2.737403371569701,-0.014560656231753727
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9848655752379012,-0.010557795612967559
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; if ( np -> pktoptions ) { skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; } if ( np -> rxpmtu ) { skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; } fl6_free_socklist ( sk ) ; if ( np -> opt ) { opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; } }",197,-3.9795650425065987,-0.020200837779221312
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9848655752379012,-0.010557795612967559
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock(struct sock *sk) {
 struct ipv6_pinfo *np = inet6_sk(sk);
 struct sk_buff *skb;
 struct ipv6_txoptions *opt;
opt = xchg(&np->opt, NULL);
if (opt) {
 skb = xchg(&np->pktoptions, NULL);
 if (skb)
  kfree_skb(skb);
skb = xchg(&np->rxpmtu, NULL);
 if (skb)
  kfree_skb(skb);
fl6_free_socklist(sk);
sock_kfree_s(sk, opt, opt->tot_len);
}
}",177,-24.588827779910396,-0.13891993095994573
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { skb->users = 0; kfree_skb ( skb ) ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { skb->users = 0; kfree_skb ( skb ) ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL; } }",192,-11.572401951166228,-0.06027292682899077
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; if ( np -> pktoptions ) { skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; } if ( np -> rxpmtu ) { skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; } fl6_free_socklist ( sk ) ; if ( np -> opt ) { opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; } }",197,-3.9795650425065987,-0.020200837779221312
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9848655752379012,-0.010557795612967559
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL; } }",188,-2.737403371569701,-0.014560656231753727
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb (skb) ; skb = NULL; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL; } }",188,-11.480899541354201,-0.06106861458167128
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; kfree ( opt ) ; } }",176,-4.82378110493734,-0.027407847187143976
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; kfree ( skb ) ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; kfree ( skb ) ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; kfree ( opt ) ; } }",194,-5.9094679732832,-0.030461175120016497
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; kfree ( opt ) ; } }",176,-4.82378110493734,-0.027407847187143976
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL; } }",188,-2.7276433121046013,-0.014508741021832985
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:"," 
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",189,-4.941440427890101,-0.026145187449153975
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL; } }",174,-5.40085192723734,-0.03103937889216862
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9913484627771008,-0.010592279057325004
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; kfree ( opt ) ; } }",176,-4.82378110493734,-0.027407847187143976
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","

void inet6_destroy_sock ( struct sock * sk ) { 
    struct ipv6_pinfo * np = inet6_sk ( sk ) ; 
    struct sk_buff * skb ; 
    struct ipv6_txoptions * opt ; 
    skb = xchg ( & np -> pktoptions , NULL ) ; 
    if ( skb ) {
        kfree_skb ( skb ) ;
        skb = NULL;
    }
    skb = xchg ( & np -> rxpmtu , NULL ) ; 
    if ( skb ) {
        kfree_skb ( skb ) ;
        skb = NULL;
    }
    fl6_free_socklist ( sk ) ; 
    opt = xchg ( & np -> opt , NULL ) ; 
    if ( opt ) {
        sock_kfree_s ( sk , opt , opt -> tot_len ) ; 
        opt = NULL;
    }
}",237,-13.872684125640996,-0.058534532175700406
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9911569219900993,-0.010591260223351592
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { memset ( opt , 0 , opt -> tot_len ) ; sock_kfree_s ( sk , opt , opt -> tot_len ) ; } }",184,-6.115200984264644,-0.03323478795796002
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; 

spin_lock_bh(&sk->sk_lock);
skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; spin_unlock_bh(&sk->sk_lock);

fl6_free_socklist ( sk ) ; 
spin_lock_bh(&sk->sk_lock);
opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; 
spin_unlock_bh(&sk->sk_lock);
}",230,-20.330074712235717,-0.08839162918363355
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:"," 
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; if ( np -> pktoptions ) { skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; } if ( np -> rxpmtu ) { skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; } fl6_free_socklist ( sk ) ; if ( np -> opt ) { opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; } }",198,-6.699786324589499,-0.033837304669643936
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL; } }",188,-2.737403371569701,-0.014560656231753727
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9913484627771008,-0.010592279057325004
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; 
//Added:
if (np != NULL) {
 skb = xchg ( & np -> pktoptions , NULL ) ; 
 if ( skb ) kfree_skb ( skb ) ; 
 skb = xchg ( & np -> rxpmtu , NULL ) ; 
 if ( skb ) kfree_skb ( skb ) ; 
 fl6_free_socklist ( sk ) ; 
 opt = xchg ( & np -> opt , NULL ) ; 
 if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; 
}
//End added
}",202,-22.301808037015128,-0.1104049902822531
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9913484627771008,-0.010592279057325004
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { atomic_dec(&skb->users); } kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { atomic_dec(&skb->users); } kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }",190,-16.13195714398203,-0.08490503759990543
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9913484627771008,-0.010592279057325004
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; // Add a check to make sure that the pointer is not null first if ( np -> pktoptions ) { skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; } if ( np -> rxpmtu ) { skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; } fl6_free_socklist ( sk ) ; if ( np -> opt ) { opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; } }",211,-24.048982564320397,-0.11397622068398293
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; 
skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } 
skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } 
fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL; } }",194,-12.8803293649586,-0.06639345033483815
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9936815058586022,-0.010604688860950012
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { struct sk_buff * temp = skb ; skb = xchg ( & np -> rxpmtu , NULL ) ; kfree_skb ( temp ) ; if ( skb ) kfree_skb ( skb ) ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { struct ipv6_txoptions * temp = opt ; opt = xchg ( & np -> opt , NULL ) ; sock_kfree_s ( sk , temp , temp -> tot_len ) ; } }",207,-15.76127294708411,-0.07614141520330488
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9913189169407013,-0.010592121898620752
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","

void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",189,-5.018517839099803,-0.026553004439681498
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb_safe ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb_safe ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; kfree ( opt ) ; }",178,-8.9924281993389,-0.05051925954684775
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9936815058586022,-0.010604688860950012
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9913189169407013,-0.010592121898620752
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { memset ( opt , 0 , opt -> tot_len ) ; sock_kfree_s ( sk , opt , opt -> tot_len ) ; } }",184,-6.130861889994441,-0.03331990157605674
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9913189169407013,-0.010592121898620752
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL; ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL; ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL; ; } }",191,-14.0212672937592,-0.07340977640711623
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { 
#ifdef CONFIG_DEBUG_USE_AFTER_FREE 
synchronize_rcu(); 
#endif 
kfree_skb ( skb ) ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { 
#ifdef CONFIG_DEBUG_USE_AFTER_FREE 
synchronize_rcu(); 
#endif 
kfree_skb ( skb ) ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { 
#ifdef CONFIG_DEBUG_USE_AFTER_FREE 
synchronize_rcu(); 
#endif 
sock_kfree_s ( sk , opt , opt -> tot_len ) ; } }",265,-22.79700423757558,-0.08602643108519087
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; //Added line } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; //Added line } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; //Added line } }",197,-10.402919573589402,-0.052806698343093414
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9913189169407013,-0.010592121898620752
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",174,-5.610066611271439,-0.0322417621337439
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; kfree ( opt ) ; } }",176,-4.7377146532839385,-0.026918833257295105
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; if ( np != NULL ) { skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
}",177,-9.59934748577545,-0.05423360161455056
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; 
if(np->pktoptions != NULL){ skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ;} 
if ( np->rxpmtu != NULL){ skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; } fl6_free_socklist ( sk ) ; 
if ( np->opt != NULL ){ opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; } 
}",208,-28.653648314668725,-0.1377579245897535
"The Original Code is vulnerable to CWE-416: Use After Free. Fix the vulnerability.
Original Code:
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) kfree_skb ( skb ) ; skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) kfree_skb ( skb ) ; fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) sock_kfree_s ( sk , opt , opt -> tot_len ) ; }
Fixed code:","
void inet6_destroy_sock ( struct sock * sk ) { struct ipv6_pinfo * np = inet6_sk ( sk ) ; struct sk_buff * skb ; struct ipv6_txoptions * opt ; skb = xchg ( & np -> pktoptions , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } skb = xchg ( & np -> rxpmtu , NULL ) ; if ( skb ) { kfree_skb ( skb ) ; skb = NULL ; } fl6_free_socklist ( sk ) ; opt = xchg ( & np -> opt , NULL ) ; if ( opt ) { sock_kfree_s ( sk , opt , opt -> tot_len ) ; opt = NULL ; } }",188,-1.9913189169407013,-0.010592121898620752
